{
  "id": 5583,
  "name": "Ethan Heilman",
  "username": "EthanHeilman",
  "avatar_template": "/user_avatar/delvingbitcoin.org/ethanheilman/{size}/328_2.png",
  "created_at": "2025-07-28T18:12:08.172Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"sipa\" data-post=\"28\" data-topic=\"1811\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sipa/48/1100_2.png\" class=\"avatar\"> sipa:</div>\n<blockquote>\n<p>If a CRQC appears, I don\u2019t see how BTC can retain any value at all, if EC spending is not disabled.</p>\n</blockquote>\n</aside>\n<p>Lets say tomorrow we wake up and it turns out there has been a breakthrough either a classic algorithm to break EC or a breakthrough that enables quantum computers of the size needed to break EC.</p>\n<p><strong>Case 1 (long-exposure vuln, but no immediate short-exposure vuln):</strong> This breakthrough allows an extremely well resourced attacker to break a EC public after 1 week of computation, with attack time being halved every two months.</p>\n<p>Users can protect their P2TR coins by moving them to P2SH. The LN shuts down since P2SH is pre-tapscript and it will take months to move the protocol away from tapscript. Exchanges which moved to P2TR have to rapidly switch all their wallets to use P2SH. Fees spike as everyone rushes to more their coins away from vulnerable outputs like P2TR.</p>\n<p>A soft fork is proposed to disable P2PK, P2PKH, outputs whose public key is known and disable key-spend in P2TR. Maybe it succeeds, maybe it doesn\u2019t. If it succeeds, lots of people lose their money because they didn\u2019t manage move it from P2TR key spends. If the softfork fails, someone will propose a hardfork that freezes these outputs. The coins on the hardfork will likely be more valuable than Bitcoin because there will be much less than 21 million coins on the hardfork.</p>\n<p>P2QRH mitigates a some of the harm in case 1 since exchanges and whales will likely have transitioned away from P2TR due to the stronger security of not being vulnerable to long-exposure attacks on EC.</p>\n<p>P2QRH + PQ sig opcodes algorithms makes case 1 even easier to deal with since a large number of active users will have P2QRH and a PQ signatures in a tapleaf. Wallets, exchanges and LN will have built out support for it. The main question is to freeze coins or not. If the freeze softfork happens, the coins in P2QRH outputs are protected. If the freeze softfork doesn\u2019t happen and instead there is a hardfork, the coins in P2QRH outputs are protected in both forks.</p>\n<p><strong>Case 2 (long-exposure and short-range attacks):</strong> This breakthrough allows an extremely well resourced attacker to break a EC public after 1 second of computation.</p>\n<p>Total chaos as early Satoshi and modern P2TR coins are stolen. No one can tell between attacker theft and users spending their coins. There is no safe way to secure coins unless you do something like commit reveal but there is not wallet support for that. Bitcoin is no longer able to authenticate ownership of most coins, RIP.</p>\n<p>P2QRH does not help much here, but P2QRH + PQ sig opcodes does help. Even in this nightmare can still authenticate ownership of coins for those users that moved away from vulnerable outputs and uses PQ signature opcodes. This makes a freeze softfork or freeze hardfork worth doing since Bitcoin can be saved.</p>\n<p>Case 1 is much more likely than Case 2.</p>\n<blockquote>\n<p>However, this appears to not be at all what BIP360 is aiming to achieve, and thus, I fail to see the point.</p>\n</blockquote>\n<p>A PQ-only output is unlikely to get wallet and exchange support because very few people want to pay the much higher fees to spend using a PQ signature algorithm. An extra 32-bytes is fine, an extra 2,000-bytes is not.</p>\n<p>There are two ways to do this:</p>\n<ol>\n<li>\n<p>P2TR with PQ opcodes with the idea that we freeze all key-spends when EC is broken. This pretends a risk that the freeze doesn\u2019t happen.</p>\n</li>\n<li>\n<p>P2QRH with PQ opcodes which has no key-spends, so it is opt-in. We can start encouraging user\u2019s to move from P2TR to P2QRH.</p>\n</li>\n</ol>\n<p>The PQ opcodes are designed to be in tapscript and work with P2TR as well as P2QRH  such that if the community prefers to have core pinky promise they will disable P2TR key spends, then it works with P2TR as well. I just can\u2019t imagine core wants to commit to a controversial promise like that.</p>\n<blockquote>\n<p>For mixed EC-or-PQC spending conditions, P2TR is strictly better in functionality, privacy, and (typically) cost.</p>\n</blockquote>\n<p>If EC is not vulnerable then P2QRH is the NUMS point feature of P2TR in functionality and privacy, but slightly better in cost.</p>",
  "post_number": 29,
  "post_type": 1,
  "posts_count": 28,
  "updated_at": "2025-07-28T18:19:03.130Z",
  "reply_count": 0,
  "reply_to_post_number": 28,
  "quote_count": 1,
  "incoming_link_count": 2,
  "reads": 17,
  "readers_count": 16,
  "score": 7.8,
  "yours": false,
  "topic_id": 1811,
  "topic_slug": "changes-to-bip-360-pay-to-quantum-resistant-hash-p2qrh",
  "topic_title": "Changes to BIP-360 - Pay to Quantum Resistant Hash (P2QRH)",
  "topic_html_title": "Changes to BIP-360 - Pay to Quantum Resistant Hash (P2QRH)",
  "category_id": 7,
  "display_username": "Ethan Heilman",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"sipa, post:28, topic:1811\"]\nIf a CRQC appears, I don\u2019t see how BTC can retain any value at all, if EC spending is not disabled.\n[/quote]\n\nLets say tomorrow we wake up and it turns out there has been a breakthrough either a classic algorithm to break EC or a breakthrough that enables quantum computers of the size needed to break EC.\n\n**Case 1 (long-exposure vuln, but no immediate short-exposure vuln):** This breakthrough allows an extremely well resourced attacker to break a EC public after 1 week of computation, with attack time being halved every two months.\n\nUsers can protect their P2TR coins by moving them to P2SH. The LN shuts down since P2SH is pre-tapscript and it will take months to move the protocol away from tapscript. Exchanges which moved to P2TR have to rapidly switch all their wallets to use P2SH. Fees spike as everyone rushes to more their coins away from vulnerable outputs like P2TR.\n\nA soft fork is proposed to disable P2PK, P2PKH, outputs whose public key is known and disable key-spend in P2TR. Maybe it succeeds, maybe it doesn't. If it succeeds, lots of people lose their money because they didn't manage move it from P2TR key spends. If the softfork fails, someone will propose a hardfork that freezes these outputs. The coins on the hardfork will likely be more valuable than Bitcoin because there will be much less than 21 million coins on the hardfork.\n\nP2QRH mitigates a some of the harm in case 1 since exchanges and whales will likely have transitioned away from P2TR due to the stronger security of not being vulnerable to long-exposure attacks on EC.\n\nP2QRH + PQ sig opcodes algorithms makes case 1 even easier to deal with since a large number of active users will have P2QRH and a PQ signatures in a tapleaf. Wallets, exchanges and LN will have built out support for it. The main question is to freeze coins or not. If the freeze softfork happens, the coins in P2QRH outputs are protected. If the freeze softfork doesn't happen and instead there is a hardfork, the coins in P2QRH outputs are protected in both forks.\n\n**Case 2 (long-exposure and short-range attacks):** This breakthrough allows an extremely well resourced attacker to break a EC public after 1 second of computation.\n\nTotal chaos as early Satoshi and modern P2TR coins are stolen. No one can tell between attacker theft and users spending their coins. There is no safe way to secure coins unless you do something like commit reveal but there is not wallet support for that. Bitcoin is no longer able to authenticate ownership of most coins, RIP.\n\nP2QRH does not help much here, but P2QRH + PQ sig opcodes does help. Even in this nightmare can still authenticate ownership of coins for those users that moved away from vulnerable outputs and uses PQ signature opcodes. This makes a freeze softfork or freeze hardfork worth doing since Bitcoin can be saved.\n\nCase 1 is much more likely than Case 2.\n\n> However, this appears to not be at all what BIP360 is aiming to achieve, and thus, I fail to see the point.\n\nA PQ-only output is unlikely to get wallet and exchange support because very few people want to pay the much higher fees to spend using a PQ signature algorithm. An extra 32-bytes is fine, an extra 2,000-bytes is not.\n\nThere are two ways to do this:\n\n1. P2TR with PQ opcodes with the idea that we freeze all key-spends when EC is broken. This pretends a risk that the freeze doesn't happen.\n\n2. P2QRH with PQ opcodes which has no key-spends, so it is opt-in. We can start encouraging user's to move from P2TR to P2QRH.\n\nThe PQ opcodes are designed to be in tapscript and work with P2TR as well as P2QRH  such that if the community prefers to have core pinky promise they will disable P2TR key spends, then it works with P2TR as well. I just can't imagine core wants to commit to a controversial promise like that.\n\n> For mixed EC-or-PQC spending conditions, P2TR is strictly better in functionality, privacy, and (typically) cost. \n\nIf EC is not vulnerable then P2QRH is the NUMS point feature of P2TR in functionality and privacy, but slightly better in cost.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 267,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Lets say tomorrow we wake up and it turns out there has been a breakthrough either a classic algorithm to break EC or a breakthrough that enables quantum computers of the size needed to break EC. \nCase 1 (long-exposure vuln, but no immediate short-exposure vuln): This breakthrough allows an extreme&hellip;",
  "truncated": true,
  "post_url": "/t/changes-to-bip-360-pay-to-quantum-resistant-hash-p2qrh/1811/29",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}