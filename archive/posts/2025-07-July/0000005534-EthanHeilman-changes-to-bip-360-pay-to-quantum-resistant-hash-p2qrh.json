{
  "id": 5534,
  "name": "Ethan Heilman",
  "username": "EthanHeilman",
  "avatar_template": "/user_avatar/delvingbitcoin.org/ethanheilman/{size}/328_2.png",
  "created_at": "2025-07-21T15:21:36.411Z",
  "cooked": "<p>This is a cool idea, though I rather make as few changes in P2QRH as possible.</p>\n<aside class=\"quote no-group\" data-username=\"conduition\" data-post=\"19\" data-topic=\"1811\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/conduition/48/384_2.png\" class=\"avatar\"> conduition:</div>\n<blockquote>\n<p>If a quantum attacker learns our wallet descriptor, they cannot exploit EC pubkeys inside the endorsed script to steal money until the owner has published an OTS endorsement signature, even if the adversary knows and cracks the EC pubkey(s) inside the to-be-endorsed script.</p>\n</blockquote>\n</aside>\n<p>If I understand you correctly this would prevent long exposure attacks on reused public keys, but not solve short exposure attacks.</p>\n<p>You don\u2019t need to change P2QRH to get this. Simply require a preimage and a signature (H(x) == y AND VER(pk, sig, m) == 1) to spend and have a different preimage per leaf. This prevents long exposure attacks even if the public key is reused since the attacker doesn\u2019t know the preimage x. This seems like not reusing a public key but with extra steps.</p>\n<p>In P2SH you can do slightly better using the techniques from <a href=\"https://groups.google.com/g/bitcoindev/c/mR53go5gHIk\" rel=\"noopener nofollow ugc\">Signing a Bitcoin Transaction with Lamport Signatures (no changes needed)</a>. Though as pointed out by <a href=\"https://groups.google.com/g/bitcoindev/c/mR53go5gHIk/m/HdLvltBIAAAJ\" rel=\"noopener nofollow ugc\">Adam Borcany</a> this scheme functions more like a speed bump since due to the 201 opcode limit in pre-tapscript the key space is small enough to be vulnerable to bruteforce.</p>\n<aside class=\"quote no-group\" data-username=\"conduition\" data-post=\"19\" data-topic=\"1811\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/conduition/48/384_2.png\" class=\"avatar\"> conduition:</div>\n<blockquote>\n<p>It\u2019d mean fully defining an OTS scheme for script endorsement, so maybe that\u2019d be best as a new script leaf version, in a new BIP. What do you think?</p>\n</blockquote>\n</aside>\n<p>You should write this up more concretely. It is an interesting idea.</p>",
  "post_number": 23,
  "post_type": 1,
  "posts_count": 30,
  "updated_at": "2025-07-21T15:21:36.411Z",
  "reply_count": 1,
  "reply_to_post_number": 19,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 35,
  "readers_count": 34,
  "score": 12.0,
  "yours": false,
  "topic_id": 1811,
  "topic_slug": "changes-to-bip-360-pay-to-quantum-resistant-hash-p2qrh",
  "topic_title": "Changes to BIP-360 - Pay to Quantum Resistant Hash (P2QRH)",
  "topic_html_title": "Changes to BIP-360 - Pay to Quantum Resistant Hash (P2QRH)",
  "category_id": 7,
  "display_username": "Ethan Heilman",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "This is a cool idea, though I rather make as few changes in P2QRH as possible.\n\n[quote=\"conduition, post:19, topic:1811\"]\nIf a quantum attacker learns our wallet descriptor, they cannot exploit EC pubkeys inside the endorsed script to steal money until the owner has published an OTS endorsement signature, even if the adversary knows and cracks the EC pubkey(s) inside the to-be-endorsed script.\n[/quote]\n\nIf I understand you correctly this would prevent long exposure attacks on reused public keys, but not solve short exposure attacks.\n\nYou don't need to change P2QRH to get this. Simply require a preimage and a signature (H(x) == y AND VER(pk, sig, m) == 1) to spend and have a different preimage per leaf. This prevents long exposure attacks even if the public key is reused since the attacker doesn't know the preimage x. This seems like not reusing a public key but with extra steps.\n\nIn P2SH you can do slightly better using the techniques from [Signing a Bitcoin Transaction with Lamport Signatures (no changes needed)](https://groups.google.com/g/bitcoindev/c/mR53go5gHIk). Though as pointed out by [Adam Borcany](https://groups.google.com/g/bitcoindev/c/mR53go5gHIk/m/HdLvltBIAAAJ) this scheme functions more like a speed bump since due to the 201 opcode limit in pre-tapscript the key space is small enough to be vulnerable to bruteforce.\n\n[quote=\"conduition, post:19, topic:1811\"]\nIt\u2019d mean fully defining an OTS scheme for script endorsement, so maybe that\u2019d be best as a new script leaf version, in a new BIP. What do you think?\n[/quote]\n\nYou should write this up more concretely. It is an interesting idea.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 267,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "This is a cool idea, though I rather make as few changes in P2QRH as possible. \n\nIf I understand you correctly this would prevent long exposure attacks on reused public keys, but not solve short exposure attacks. \nYou don\u2019t need to change P2QRH to get this. Simply require a preimage and a signature &hellip;",
  "truncated": true,
  "post_url": "/t/changes-to-bip-360-pay-to-quantum-resistant-hash-p2qrh/1811/23",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}