{
  "id": 5409,
  "name": "Zawy",
  "username": "zawy",
  "avatar_template": "/user_avatar/delvingbitcoin.org/zawy/{size}/750_2.png",
  "created_at": "2025-07-06T22:32:55.756Z",
  "cooked": "<p>Large pools using Fibre for better connectivity is a weak form of selfish mining.  Fibre miners aren\u2019t withholding blocks intentionally to get an extra second of mining, but that\u2019s the net effect.  They get of 1/600 excess profit from the remaining 20% of the network (0.2 * 1/600 = 0.03% excess profit)</p>\n<p>I\u2019m curious if they\u2019re \u201caccidentally\u201d increasing the delay, or if Fibre miners are delaying their release of blocks to each other. This has no net effect relative to each other, but extracts rewards and fees from the non-Fibre miners. If a Fibre miner finds a block, then it\u2019s ~1 second before the hashrate-weighted non-Fibre miner sees it. Conversely, if a non-Fibre miner finds a blocks then it might be ~1 second before the Fibre network sees it.  So Fibre miners have 2 seconds before they need to release a block (even to to each other) to give them a head start on the non-Fibre miners.  And there\u2019s another second before the non-Fibre miners can mine on top of that cheat, a total of 3 seconds , so if non-Fibre is 20% of the hashrate, they could lose 0.2 * 3 / 600 = 0.1% of the rewards to Fibre miners.</p>\n<p>I can look at the stale block rate to determine if someone\u2019s cheating:</p>\n<p>stale_rate =~ 1 - e^(-Delay/600)</p>\n<p>Sale blocks are occurring <a href=\"https://fork.observer/\" rel=\"noopener nofollow ugc\">1 per 1784 blocks</a> (22 in past 39,240 blocks, 9 months). This is a minimum due to some not getting relayed enough to get seen. I found 3 more in the 1st half of that timespan <a href=\"https://github.com/bitcoin-data/stale-blocks/blob/abee96d45926707e77aeb03929125b519cad83a6/stale-blocks.csv\" rel=\"noopener nofollow ugc\">here</a> and it indicates my timespan needs to increase to 39,832. So let\u2019s guess the 2nd server would have found 3 more in the 2nd half and that those 2 servers are missing 10%, so there were about 31 stale blocks in 40,000 (0.0775%) or 1 per 1,290 blocks.</p>\n<p>Rearranging my equation above and using e^(-x) =~ 1-x for small x, the delay is about 600 * 31 / 40,000  = 465 ms. From an old paper, this value is between the median and mean, and not far from them.</p>\n<p>Grok tells me 80% of the hashrate is on Fibre and that Fibre\u2019s hashrate-weighted delay is 50 ms. It says the hashrate-weighted delay for the non-Fibre part is ~ 1 second.  To see if this matches with the observed delay from the stale rate.</p>\n<p>0.8 * 50 + 0.2 * 1,000 = 240 ms</p>\n<p>stale_rate = 0.240 / 600 = 1 per 2,500 blocks</p>\n<p>So from the data I have, we\u2019re seeing almost 2x the stale blocks we should be. Fibre miners could be delaying release of their block 200 ms to get a very minor profit ontop of the 0.03%.  If they were doing a real attack and delaying 2 seconds (when the parent block came from a Fibre miner), stale blocks would occur once every 333 blocks.</p>\n<p>But instead of claiming they are delaying 200 ms, I\u2019ll be generous to Fibre and assume it has a 100 ms delay and that the non-Fibre delay is 1.5 s (this latter delay being the main thing). At these extremes, we should have seen 1 stale block in 1,580.  Also, let\u2019s say there were only the 25 stale blocks we directly observed (instead of my \u201cstatistical\u201d estimate of 31) in the past 39,832 blocks. This give close agreement of 1 in 1,593.</p>",
  "post_number": 5,
  "post_type": 1,
  "posts_count": 7,
  "updated_at": "2025-07-06T22:40:48.497Z",
  "reply_count": 1,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 7,
  "readers_count": 6,
  "score": 6.2,
  "yours": false,
  "topic_id": 1757,
  "topic_slug": "where-does-the-33-33-threshold-for-selfish-mining-come-from",
  "topic_title": "Where does the 33.33% threshold for selfish mining come from?",
  "topic_html_title": "Where does the 33.33% threshold for selfish mining come from?",
  "category_id": 7,
  "display_username": "Zawy",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Large pools using Fibre for better connectivity is a weak form of selfish mining.  Fibre miners aren't withholding blocks intentionally to get an extra second of mining, but that's the net effect.  They get of 1/600 excess profit from the remaining 20% of the network (0.2 * 1/600 = 0.03% excess profit)\n\nI'm curious if they're \"accidentally\" increasing the delay, or if Fibre miners are delaying their release of blocks to each other. This has no net effect relative to each other, but extracts rewards and fees from the non-Fibre miners. If a Fibre miner finds a block, then it's ~1 second before the hashrate-weighted non-Fibre miner sees it. Conversely, if a non-Fibre miner finds a blocks then it might be ~1 second before the Fibre network sees it.  So Fibre miners have 2 seconds before they need to release a block (even to to each other) to give them a head start on the non-Fibre miners.  And there's another second before the non-Fibre miners can mine on top of that cheat, a total of 3 seconds , so if non-Fibre is 20% of the hashrate, they could lose 0.2 * 3 / 600 = 0.1% of the rewards to Fibre miners.\n\nI can look at the stale block rate to determine if someone's cheating:\n\nstale_rate =~ 1 - e^(-Delay/600) \n\nSale blocks are occurring [1 per 1784 blocks](https://fork.observer/) (22 in past 39,240 blocks, 9 months). This is a minimum due to some not getting relayed enough to get seen. I found 3 more in the 1st half of that timespan [here](https://github.com/bitcoin-data/stale-blocks/blob/abee96d45926707e77aeb03929125b519cad83a6/stale-blocks.csv) and it indicates my timespan needs to increase to 39,832. So let's guess the 2nd server would have found 3 more in the 2nd half and that those 2 servers are missing 10%, so there were about 31 stale blocks in 40,000 (0.0775%) or 1 per 1,290 blocks.\n\nRearranging my equation above and using e^(-x) =~ 1-x for small x, the delay is about 600 * 31 / 40,000  = 465 ms. From an old paper, this value is between the median and mean, and not far from them.\n\nGrok tells me 80% of the hashrate is on Fibre and that Fibre's hashrate-weighted delay is 50 ms. It says the hashrate-weighted delay for the non-Fibre part is ~ 1 second.  To see if this matches with the observed delay from the stale rate.\n\n0.8 * 50 + 0.2 * 1,000 = 240 ms  \n\nstale_rate = 0.240 / 600 = 1 per 2,500 blocks\n\nSo from the data I have, we're seeing almost 2x the stale blocks we should be. Fibre miners could be delaying release of their block 200 ms to get a very minor profit ontop of the 0.03%.  If they were doing a real attack and delaying 2 seconds (when the parent block came from a Fibre miner), stale blocks would occur once every 333 blocks.\n\nBut instead of claiming they are delaying 200 ms, I'll be generous to Fibre and assume it has a 100 ms delay and that the non-Fibre delay is 1.5 s (this latter delay being the main thing). At these extremes, we should have seen 1 stale block in 1,580.  Also, let's say there were only the 25 stale blocks we directly observed (instead of my \"statistical\" estimate of 31) in the past 39,832 blocks. This give close agreement of 1 in 1,593.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 502,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Large pools using Fibre for better connectivity is a weak form of selfish mining.  Fibre miners aren\u2019t withholding blocks intentionally to get an extra second of mining, but that\u2019s the net effect.  They get of 1/600 excess profit from the remaining 20% of the network (0.2 * 1/600 = 0.03% excess prof&hellip;",
  "truncated": true,
  "post_url": "/t/where-does-the-33-33-threshold-for-selfish-mining-come-from/1757/5",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}