{
  "id": 6099,
  "name": "Anthony Towns",
  "username": "ajtowns",
  "avatar_template": "/user_avatar/delvingbitcoin.org/ajtowns/{size}/417_2.png",
  "created_at": "2025-10-17T03:32:33.362Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"23\" data-topic=\"1906\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>I\u2019ve now done some very limited experimentation on mainnet with it, just between two peers running similar mempool policies. With that setup, I\u2019d expect very few out-of-mempool txs to appear in the templates being shared. The ones I am seeing seem to take the form:</p>\n<ul>\n<li>this tx was just RBFed, but the template was generated beforehand</li>\n<li>this tx was confirmed in the previous block, but a new template hasn\u2019t been created since that block came in</li>\n</ul>\n</blockquote>\n</aside>\n<p>With txs confirmed in the previous block excluded I\u2019m seeing about 2 txs per minute that get (re)considered. They seem to fall into these buckets:</p>\n<ul>\n<li>most of them are from slightly old templates where the RBF came through after the template was generated, but before I requested it</li>\n<li>a few are due to an RBF missing a block, but the template is from before the block was found but does include the RBF tx</li>\n<li>new transactions, that I had requested via INV/GETDATA but that hadn\u2019t come through (the 1 minute delay to retry from another peer, vs the ~2 minute delay to request a template presumably means that top of mempool txs that aren\u2019t getting a quick reply will often get requested via template sharing)</li>\n</ul>\n<p>One way to reduce the RBF hits might be to change it so that rather than sending the latest template immediately, you mark the peer as wanting a template, and send the next template as soon as you generate it. That will make it much rarer to send a template based on an old block, and also much rarer for an RBF to arrive in-between the template being generated by the sender and being processed by the receiver.</p>",
  "post_number": 24,
  "post_type": 1,
  "posts_count": 24,
  "updated_at": "2025-10-17T03:32:33.362Z",
  "reply_count": 0,
  "reply_to_post_number": 23,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 18,
  "readers_count": 17,
  "score": 33.0,
  "yours": false,
  "topic_id": 1906,
  "topic_slug": "sharing-block-templates",
  "topic_title": "Sharing block templates",
  "topic_html_title": "Sharing block templates",
  "category_id": 8,
  "display_username": "Anthony Towns",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"ajtowns, post:23, topic:1906\"]\nI\u2019ve now done some very limited experimentation on mainnet with it, just between two peers running similar mempool policies. With that setup, I\u2019d expect very few out-of-mempool txs to appear in the templates being shared. The ones I am seeing seem to take the form:\n\n* this tx was just RBFed, but the template was generated beforehand\n* this tx was confirmed in the previous block, but a new template hasn\u2019t been created since that block came in\n[/quote]\n\nWith txs confirmed in the previous block excluded I'm seeing about 2 txs per minute that get (re)considered. They seem to fall into these buckets:\n\n * most of them are from slightly old templates where the RBF came through after the template was generated, but before I requested it\n * a few are due to an RBF missing a block, but the template is from before the block was found but does include the RBF tx\n * new transactions, that I had requested via INV/GETDATA but that hadn't come through (the 1 minute delay to retry from another peer, vs the ~2 minute delay to request a template presumably means that top of mempool txs that aren't getting a quick reply will often get requested via template sharing)\n\nOne way to reduce the RBF hits might be to change it so that rather than sending the latest template immediately, you mark the peer as wanting a template, and send the next template as soon as you generate it. That will make it much rarer to send a template based on an old block, and also much rarer for an RBF to arrive in-between the template being generated by the sender and being processed by the receiver.",
  "actions_summary": [
    {
      "id": 2,
      "count": 3
    }
  ],
  "moderator": true,
  "admin": true,
  "staff": true,
  "user_id": 3,
  "hidden": false,
  "trust_level": 4,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "With txs confirmed in the previous block excluded I\u2019m seeing about 2 txs per minute that get (re)considered. They seem to fall into these buckets: \n\nmost of them are from slightly old templates where the RBF came through after the template was generated, but before I requested it\na few are due to a&hellip;",
  "truncated": true,
  "post_url": "/t/sharing-block-templates/1906/24",
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 3
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 3,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}