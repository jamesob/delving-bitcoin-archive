{
  "id": 5996,
  "name": "Sindura Saraswathi",
  "username": "sindurasaraswathi",
  "avatar_template": "/user_avatar/delvingbitcoin.org/sindurasaraswathi/{size}/1058_2.png",
  "created_at": "2025-10-02T03:47:45.341Z",
  "cooked": "<p>Threshold signatures are now common methods to secure funds in Bitcoin. An m-of-n signature scheme requires at least <span class=\"math\">m</span> signatures to unlock funds secured by <span class=\"math\">n</span> public keys. An open question, however, is the optimal design of such schemes. When should the threshold be high, when should it be low, and how should it change over time? This is where things get interesting. So, we study this problem in a security context, where a malicious attacker tries to steal a user\u2019s signatures.</p>\n<p>Imagine you are setting up your wallet. On one hand, a higher threshold keeps attackers at bay - they will need to compromise more keys before they can get your Bitcoin. On the other hand, the higher the threshold, the more likely you are to lock yourself out of your own funds. Self-lockout is a common problem, evidenced by the vast sums that users are willing to pay to recover lost bitcoin.</p>\n<p>So, the real challenge is balancing these costs and benefits, namely, the benefit of security against the cost of usability. The \u201coptimal\u201d threshold is the one that minimizes your expected loss. That loss has two parts:</p>\n<ul>\n<li>Attacker Loss: The risk of losing funds to an attacker.</li>\n<li>User Loss: The risk of losing access yourself.</li>\n</ul>\n<p>Think of it like this: putting your keys in a safe increases security, while engraving them on a titanium plate improves usability in case of fire. Both strategies give you more room to raise the threshold. At first glance, that might feel counterintuitive since, for example, placing signatures in a safe might induce the user to relax their threshold. But greater security decreases the probability of an attack, thereby making a high threshold relatively cheaper, so the user can afford to adopt a higher threshold than before. In other words, the better your security and usability setup, the more confidently you can raise your threshold and sleep well at night.</p>\n<p>To model the security of a threshold signature scheme, let\u2019s call <span class=\"math\">\\tau</span> the multi-signature threshold (fraction between 0 and 1). It is the number of required signatures divided by the total. For example, in a 2-of-3 setup, <span class=\"math\">\\tau = 2/3</span>. In a 3-of-5, <span class=\"math\">\\tau = 3/5</span>. These are common choices in practice.</p>\n<p>The value of <span class=\"math\">\\tau</span> captures the fundamental trade-off that higher thresholds mean stronger security (since attackers need more keys), but they also raise the chance of locking yourself out.</p>\n<p>Now, suppose we define two probabilities:</p>\n<ul>\n<li><span class=\"math\">p(\\tau)</span>: the probability that the user controls enough keys to meet the threshold.</li>\n<li><span class=\"math\">q(\\tau)</span>: the probability the attacker does.</li>\n</ul>\n<p>The specific identities of the signatures are irrelevant; what matters is whether the threshold is met. For instance, in a 3-of-5 scheme, it is irrelevant whether an attacker holds {1,2,4} or {3,4,5}; either set satisfies the threshold.</p>\n<p>Formally, we can describe the situation with a state space <span class=\"math\">\\theta = (\\theta_u, \\theta_a)</span>,  where <span class=\"math\">\\theta_u</span> = 1 if the user meets <span class=\"math\">\\tau</span> and <span class=\"math\">\\theta_a</span> = 1 if the attacker meets <span class=\"math\">\\tau</span>. That gives us four possible outcomes: {(0,0), (0,1), (1,0), (1,1)}. For simplicity, let\u2019s assume <span class=\"math\">p(\\tau)</span> and <span class=\"math\">q(\\tau)</span> are independent.</p>\n<p>The risk to the user depends on two things: the value of the funds (say V) and who manages to meet the threshold. If only the user meets it, there is no problem. If only the attacker does, the user loses everything. If neither side reaches the threshold, the funds are stuck - still a total loss. And if both do, the outcome is contested, with a 50% chance of losing the funds.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/7/76b7cd3aa14cff7c8487092b040ab119fe7b353b.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/76b7cd3aa14cff7c8487092b040ab119fe7b353b\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/7/76b7cd3aa14cff7c8487092b040ab119fe7b353b.png\" alt=\"image\" data-base62-sha1=\"gWe8m7BOk0G0uo1KBUHjl6oGxmP\" width=\"534\" height=\"256\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">534\u00d7256 13.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The user will therefore select the threshold to minimize the expected loss across all four states of the world.</p>\n<p>Assuming the probability functions <span class=\"math\">p(\\tau) = 1 - \\frac{a}{2}\\tau^{2}</span> and\n<span class=\"math\">q(\\tau) = 1 - \\frac{b}{2}\\tau^{2}</span>, we get the closed form solution for optimal threshold signature scheme as</p>\n<div class=\"math\">\n\\tau^{*} = \\sqrt{\\frac{b - a}{ab}}\n</div>\n<p>This establishes that the optimal threshold depends on the difference between parameters <span class=\"math\">b</span> and <span class=\"math\">a</span>, which govern the curvature of the attacker\u2019s and user\u2019s probability functions, respectively.  Intuitively, the user prefers an environment with:</p>\n<ul>\n<li>High probability of retaining access (high <span class=\"math\">p</span>): This occurs when <span class=\"math\">a</span> is small.</li>\n<li>Low probability of attack (low <span class=\"math\">q</span>): Occurs when <span class=\"math\">b</span> is large.</li>\n<li>Wide gap between <span class=\"math\">b</span> and <span class=\"math\">a</span>: This allows for a higher threshold, improving security and usability.</li>\n</ul>\n<p>If the gap between <span class=\"math\">b</span> and <span class=\"math\">a</span> is narrow, the user must choose a lower threshold, which reduces the risk of self-lockout but increases exposure to attacks. The sufficient condition for a positive threshold is <span class=\"math\">b &gt; a</span>, meaning the attacker\u2019s probability function must respond more strongly to changes in the threshold than the user\u2019s.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/e/e6d6a1befc9c1551f4ae53d7e3bdd4f50f5e974f.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/e6d6a1befc9c1551f4ae53d7e3bdd4f50f5e974f\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/e/e6d6a1befc9c1551f4ae53d7e3bdd4f50f5e974f.png\" alt=\"image\" data-base62-sha1=\"wW5FdkpylRv3VBOZ5kBjb0M6aFF\" width=\"358\" height=\"342\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">358\u00d7342 45.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<div class=\"math\">\n\\text{Fig. 2: Relationship between } \\tau^* \\text{vs } a \\text{ and } b\n</div>\n<p>A core takeaway of this model is that increasing security or usability leads to higher optimal thresholds.</p>\n<p>Take a practical example, where moving from a paper wallet to a hardware wallet boosts security. This raises parameter <span class=\"math\">b</span> and supports choosing a higher threshold. On the usability side, engraving seed phrases on a fire-resistant titanium plate reduces parameter <span class=\"math\">a</span>, again making a higher threshold possible.</p>\n<p>Fig.3 illustrates this trade-off through the loss functions. User loss increases as thresholds rise, since higher thresholds raise the chance of lockout. Attacker loss moves in the opposite direction, falling with higher thresholds because more signatures are required to steal funds. The total expected loss is simply the sum of these two effects.</p>\n<ul>\n<li>Shifts in parameters change the balance: Increasing security (higher <span class=\"math\">b</span>) drives attacker loss lower, reducing overall expected loss and supporting a higher threshold. Increasing a raises user loss instead, pushing total expected loss upward and lowering the optimal threshold.</li>\n</ul>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/6/6933d40ba8fc5cb54c2b165d646e8f838a7c854b.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/6933d40ba8fc5cb54c2b165d646e8f838a7c854b\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/6/6933d40ba8fc5cb54c2b165d646e8f838a7c854b.png\" alt=\"image\" data-base62-sha1=\"f0FaUDsiEyPaIy2lPgm8ekLFOIP\" width=\"558\" height=\"340\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">558\u00d7340 35.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<div class=\"math\">\n\\text{Fig. 3: The attacker\u2019s , user\u2019s and total expected loss functions}\n</div>\n<p>So far, we have focused on static thresholds, but real-world conditions don\u2019t stay constant. Over time, both users and attackers face changing levels of access. To capture this, we develop two dynamic models that show how thresholds can evolve.</p>\n<p>Degraded multisignature has a special implementation in Bitcoin that the 2021 Taproot upgrade enabled.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/8/864f91dfaa1a84443c88dec076b9a44e35e84b53.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/864f91dfaa1a84443c88dec076b9a44e35e84b53\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/8/864f91dfaa1a84443c88dec076b9a44e35e84b53.png\" alt=\"image\" data-base62-sha1=\"jaasqP9ZZC4SCWJy9fxVKHIGWyv\" width=\"514\" height=\"272\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">514\u00d7272 11.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<div class=\"math\">\n\\text{Fig. 4: An Example for Degraded Multisignature in Taproot}\n</div>\n<p>In the first model, both user and attacker access probabilities decay over time. This makes sense because users might lose keys through negligence or hardware failure, while attackers may also lose access as time passes.</p>\n<p>This model allows users to set both a threshold and a timelock. The optimal strategy is intuitive:</p>\n<ul>\n<li>Start with higher thresholds in the early stages, when access is fresh and reliable.</li>\n<li>Gradually lower thresholds over time.</li>\n<li>At the same time, extend timelocks, improving both security and usability as the system matures.</li>\n</ul>\n<p>Formally, this can be modeled by letting the user\u2019s and attacker\u2019s access probabilities decay exponentially over time (<span class=\"math\">p(\\tau)e^{- \\lambda t} \\ \\text{ and } \\ q(\\tau)e^{- \\gamma t}</span>). A degraded multisig scheme is then defined in stages. For each time interval, the scheme specifies a threshold and a corresponding timelock.</p>\n<p>The benefit of this approach is that unlike a fixed threshold, a degraded multisig adapts stage by stage, matching the user\u2019s needs and risks over time.</p>\n<p>Mathematically, we get the optimal degraded multisig contract as:</p>\n<div class=\"math\">\n\\tau_{i}^{*} = \\sqrt{\\frac{b + a (1 - \\frac{2y_{i}}{Z_{i}})}{ab}}\n</div>\n<div class=\"math\">\nT^{*} = \\frac{1}{\\gamma} \\ln \\left[\\frac{p(\\tau_{i-1}^{*})q(\\tau_{i-1}^{*}) - p(\\tau_{i}^{*})q(\\tau_{i}^{*})}{2(p(\\tau_{i-1}^{*}) - p(\\tau_{i}^{*}))}\\right]\n</div>\n<p>where</p>\n<div class=\"math\">\nZ_{i} = \\int_{T_{i}} e^{- \\lambda t} e^{-\\gamma t} dt,\\ \\ \ny_{i} = \\int_{T_{i}} e^{- \\lambda t} dt\n</div>\n<p><span class=\"math\">for\\ i = 1,\\dots,n.</span></p>\n<p>Key Implications:</p>\n<ul>\n<li>Thresholds degrade over time: early stages use higher thresholds, which gradually decline in later stages.</li>\n<li>Better security or usability allows for higher thresholds and longer time locks.</li>\n<li>As either user access rate (<span class=\"math\">\\lambda</span>) or attacker access rate (<span class=\"math\">\\gamma</span>) decays faster, the optimal threshold decreases.</li>\n</ul>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/e/e23cfdb7ae4f38281bcad8081a4a6f7f8fcd3435.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/e23cfdb7ae4f38281bcad8081a4a6f7f8fcd3435\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/e/e23cfdb7ae4f38281bcad8081a4a6f7f8fcd3435.png\" alt=\"image\" data-base62-sha1=\"whoA1OhDlgx5ewqFgf4mTf5oevb\" width=\"542\" height=\"282\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">542\u00d7282 55.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<div class=\"math\">\n\\text{Fig. 5: Two stage degraded multisig scheme }(\\tau_{i - 1}^{*}, \\tau_{i}^{*})\\\\\\text{ (User and attacker lose access over time)}\n</div>\n<p>The second dynamic model takes a different view, where the user access still decays over time (modeled as <span class=\"math\">p(\\tau)e^{- \\lambda t}</span>), but the attacker\u2019s access instead increases with frequent signature use (modeled as <span class=\"math\">q(\\tau)e^{\\gamma t}</span>). Think of it this way - the more signatures are revealed or used, the easier it becomes for an attacker to collect information.\nIn this model, thresholds also tend to decline over time, as users gradually lose keys. But there is a twist: if the attacker\u2019s gain rate grows much faster than the user\u2019s decay rate, the optimal strategy flips. In such cases, thresholds must actually rise in later stages to preserve security.\nThe optimal dynamic threshold signature contract, in this case, is given by:</p>\n<div class=\"math\">\n\\tau_{i}^{*} = \\sqrt{\\frac{b + a\\left( 1 - \\frac{{2y}_{i}}{Z_{i}} \\right)}{ab}}\n</div>\n<div class=\"math\">\nT^{*} = \\frac{1}{\\gamma}\\ln\\left[ \\frac{2\\left( p\\left( \\tau_{i - 1}^{*} \\right) - p\\left( \\tau_{i}^{*} \\right) \\right)}{p\\left( \\tau_{i - 1}^{*} \\right)q\\left( \\tau_{i - 1}^{*} \\right) - p\\left( \\tau_{i}^{*} \\right)q\\left( \\tau_{i}^{*} \\right)} \\right]\n</div>\n<p>where</p>\n<div class=\"math\">\nZ_{i} = \\int_{T_{i}} e^{- \\lambda t} e^{\\gamma t} dt, \\ \\ \ny_{i} = \\int_{T_{i}} e^{- \\lambda t} dt\n</div>\n<p><span class=\"math\">for\\ i = 1,\\dots,n.</span></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/5/536f95995bf453d14fc09b8030b4d61805de08e6.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/536f95995bf453d14fc09b8030b4d61805de08e6\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/original/2X/5/536f95995bf453d14fc09b8030b4d61805de08e6.png\" alt=\"image\" data-base62-sha1=\"bU6HiSDyuWuf1Kpz4MZzOy8zPZI\" width=\"568\" height=\"284\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">568\u00d7284 47.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<div class=\"math\">\n\\text{Fig. 6: Two stage dynamic threshold scheme }(\\tau_{i - 1}^{*}, \\tau_{i}^{*})\\\\ \\text{ (Attacker gains access over time)}\n</div>\n<p>The source code for our simulations is available on Github at: <a href=\"https://github.com/sindurasaraswathi/Optimal_Threshold_Signatures\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">GitHub - sindurasaraswathi/Optimal_Threshold_Signatures</a></p>\n<p>Our analysis here of optimal threshold signature helps to guide some of the wide range of possibilities that Taproot unlocks. Indeed, the Taproot Merkle trees (Taptrees) can have vast depth and complexity, and therefore, some theory is useful in terms of guiding which schemes are superior to others.</p>\n<p>Future research can extend this line of work by broadening the economic and security environment of future users of threshold signature schemes. The undiscovered country will be unlocking the full possibility of Taproot to allow for all manner of economic transactions to be represented through Taptrees and more complex contracts, including time locks and multiple signatures. Even greater possibilities will emerge when second-layer protocols integrate with the base layer. This can be particularly useful for artificial agents to utilize the full complexity that Taproot enables. While this work has focused chiefly on the human use cases of threshold signature, future users may be AI agents who can utilize Bitcoin Script in ways we cannot yet imagine.</p>\n<p>Read more about this research at: <a href=\"https://www.arxiv.org/pdf/2509.25408\" rel=\"noopener nofollow ugc\">https://www.arxiv.org/pdf/2509.25408</a></p>",
  "post_number": 1,
  "post_type": 1,
  "posts_count": 4,
  "updated_at": "2025-10-02T03:55:50.145Z",
  "reply_count": 2,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 173,
  "reads": 51,
  "readers_count": 50,
  "score": 910.2,
  "yours": false,
  "topic_id": 2023,
  "topic_slug": "optimal-threshold-signatures-in-bitcoin",
  "topic_title": "Optimal Threshold Signatures in Bitcoin",
  "topic_html_title": "Optimal Threshold Signatures in Bitcoin",
  "category_id": 6,
  "display_username": "Sindura Saraswathi",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Threshold signatures are now common methods to secure funds in Bitcoin. An m-of-n signature scheme requires at least $m$ signatures to unlock funds secured by $n$ public keys. An open question, however, is the optimal design of such schemes. When should the threshold be high, when should it be low, and how should it change over time? This is where things get interesting. So, we study this problem in a security context, where a malicious attacker tries to steal a user\u2019s signatures.\n\nImagine you are setting up your wallet. On one hand, a higher threshold keeps attackers at bay - they will need to compromise more keys before they can get your Bitcoin. On the other hand, the higher the threshold, the more likely you are to lock yourself out of your own funds. Self-lockout is a common problem, evidenced by the vast sums that users are willing to pay to recover lost bitcoin.\n\nSo, the real challenge is balancing these costs and benefits, namely, the benefit of security against the cost of usability. The \u201coptimal\u201d threshold is the one that minimizes your expected loss. That loss has two parts:\n\n* Attacker Loss: The risk of losing funds to an attacker.\n*  User Loss: The risk of losing access yourself.\n\nThink of it like this: putting your keys in a safe increases security, while engraving them on a titanium plate improves usability in case of fire. Both strategies give you more room to raise the threshold. At first glance, that might feel counterintuitive since, for example, placing signatures in a safe might induce the user to relax their threshold. But greater security decreases the probability of an attack, thereby making a high threshold relatively cheaper, so the user can afford to adopt a higher threshold than before. In other words, the better your security and usability setup, the more confidently you can raise your threshold and sleep well at night.\n\nTo model the security of a threshold signature scheme, let\u2019s call $\\tau$ the multi-signature threshold (fraction between 0 and 1). It is the number of required signatures divided by the total. For example, in a 2-of-3 setup, $\\tau = 2/3$. In a 3-of-5, $\\tau = 3/5$. These are common choices in practice.\n\nThe value of $\\tau$ captures the fundamental trade-off that higher thresholds mean stronger security (since attackers need more keys), but they also raise the chance of locking yourself out.\n\nNow, suppose we define two probabilities:\n\n* $p(\\tau)$: the probability that the user controls enough keys to meet the threshold.\n* $q(\\tau)$: the probability the attacker does.\n\nThe specific identities of the signatures are irrelevant; what matters is whether the threshold is met. For instance, in a 3-of-5 scheme, it is irrelevant whether an attacker holds {1,2,4} or {3,4,5}; either set satisfies the threshold.\n\nFormally, we can describe the situation with a state space $\\theta = (\\theta_u, \\theta_a)$,  where $\\theta_u$ = 1 if the user meets $\\tau$ and $\\theta_a$ = 1 if the attacker meets $\\tau$. That gives us four possible outcomes: {(0,0), (0,1), (1,0), (1,1)}. For simplicity, let\u2019s assume $p(\\tau)$ and $q(\\tau)$ are independent.\n\nThe risk to the user depends on two things: the value of the funds (say V) and who manages to meet the threshold. If only the user meets it, there is no problem. If only the attacker does, the user loses everything. If neither side reaches the threshold, the funds are stuck - still a total loss. And if both do, the outcome is contested, with a 50% chance of losing the funds.\n\n![image|534x256](upload://gWe8m7BOk0G0uo1KBUHjl6oGxmP.png)\n\nThe user will therefore select the threshold to minimize the expected loss across all four states of the world. \n\nAssuming the probability functions $p(\\tau) = 1 - \\frac{a}{2}\\tau^{2}$ and\n$q(\\tau) = 1 - \\frac{b}{2}\\tau^{2}$, we get the closed form solution for optimal threshold signature scheme as \n\n$$\n    \\tau^{*} = \\sqrt{\\frac{b - a}{ab}}\n$$\n\nThis establishes that the optimal threshold depends on the difference between parameters $b$ and $a$, which govern the curvature of the attacker\u2019s and user\u2019s probability functions, respectively.  Intuitively, the user prefers an environment with:\n\n* High probability of retaining access (high $p$): This occurs when $a$ is small.\n* Low probability of attack (low $q$): Occurs when $b$ is large.\n* Wide gap between $b$ and $a$: This allows for a higher threshold, improving security and usability.\n\nIf the gap between $b$ and $a$ is narrow, the user must choose a lower threshold, which reduces the risk of self-lockout but increases exposure to attacks. The sufficient condition for a positive threshold is $b > a$, meaning the attacker\u2019s probability function must respond more strongly to changes in the threshold than the user\u2019s.\n\n![image|358x342, 100%](upload://wW5FdkpylRv3VBOZ5kBjb0M6aFF.png)\n$$\n\\text{Fig. 2: Relationship between } \\tau^* \\text{vs } a \\text{ and } b\n$$\n\nA core takeaway of this model is that increasing security or usability leads to higher optimal thresholds.\n\nTake a practical example, where moving from a paper wallet to a hardware wallet boosts security. This raises parameter $b$ and supports choosing a higher threshold. On the usability side, engraving seed phrases on a fire-resistant titanium plate reduces parameter $a$, again making a higher threshold possible. \n\nFig.3 illustrates this trade-off through the loss functions. User loss increases as thresholds rise, since higher thresholds raise the chance of lockout. Attacker loss moves in the opposite direction, falling with higher thresholds because more signatures are required to steal funds. The total expected loss is simply the sum of these two effects.\n\n* Shifts in parameters change the balance: Increasing security (higher $b$) drives attacker loss lower, reducing overall expected loss and supporting a higher threshold. Increasing a raises user loss instead, pushing total expected loss upward and lowering the optimal threshold.\n\n![image|558x340](upload://f0FaUDsiEyPaIy2lPgm8ekLFOIP.png)\n\n$$\n\\text{Fig. 3: The attacker\u2019s , user\u2019s and total expected loss functions}\n$$\nSo far, we have focused on static thresholds, but real-world conditions don\u2019t stay constant. Over time, both users and attackers face changing levels of access. To capture this, we develop two dynamic models that show how thresholds can evolve.\n\nDegraded multisignature has a special implementation in Bitcoin that the 2021 Taproot upgrade enabled. \n\n![image|514x272](upload://jaasqP9ZZC4SCWJy9fxVKHIGWyv.png)\n\n$$\n\\text{Fig. 4: An Example for Degraded Multisignature in Taproot}\n$$\n\nIn the first model, both user and attacker access probabilities decay over time. This makes sense because users might lose keys through negligence or hardware failure, while attackers may also lose access as time passes.\n\nThis model allows users to set both a threshold and a timelock. The optimal strategy is intuitive:\n\n* Start with higher thresholds in the early stages, when access is fresh and reliable.\n* Gradually lower thresholds over time.\n* At the same time, extend timelocks, improving both security and usability as the system matures.\n\nFormally, this can be modeled by letting the user\u2019s and attacker\u2019s access probabilities decay exponentially over time ($p(\\tau)e^{- \\lambda t} \\ \\text{ and } \\ q(\\tau)e^{- \\gamma t}$). A degraded multisig scheme is then defined in stages. For each time interval, the scheme specifies a threshold and a corresponding timelock.\n\nThe benefit of this approach is that unlike a fixed threshold, a degraded multisig adapts stage by stage, matching the user\u2019s needs and risks over time.\n\nMathematically, we get the optimal degraded multisig contract as:\n\n$$\n \\tau_{i}^{*} = \\sqrt{\\frac{b + a (1 - \\frac{2y_{i}}{Z_{i}})}{ab}}\n$$\n$$\nT^{*} = \\frac{1}{\\gamma} \\ln \\left[\\frac{p(\\tau_{i-1}^{*})q(\\tau_{i-1}^{*}) - p(\\tau_{i}^{*})q(\\tau_{i}^{*})}{2(p(\\tau_{i-1}^{*}) - p(\\tau_{i}^{*}))}\\right]\n$$\nwhere\n$$\nZ_{i} = \\int_{T_{i}} e^{- \\lambda t} e^{-\\gamma t} dt,\\ \\ \ny_{i} = \\int_{T_{i}} e^{- \\lambda t} dt\n$$\n$for\\ i = 1,\\dots,n.$\n \nKey Implications:\n\n* Thresholds degrade over time: early stages use higher thresholds, which gradually decline in later stages.\n* Better security or usability allows for higher thresholds and longer time locks.\n* As either user access rate ($\\lambda$) or attacker access rate ($\\gamma$) decays faster, the optimal threshold decreases.\n \n![image|542x282](upload://whoA1OhDlgx5ewqFgf4mTf5oevb.png)\n\n$$\n\\text{Fig. 5: Two stage degraded multisig scheme }(\\tau_{i - 1}^{*}, \\tau_{i}^{*})\\\\\\text{ (User and attacker lose access over time)}\n$$\n\nThe second dynamic model takes a different view, where the user access still decays over time (modeled as $p(\\tau)e^{- \\lambda t}$), but the attacker\u2019s access instead increases with frequent signature use (modeled as $q(\\tau)e^{\\gamma t}$). Think of it this way - the more signatures are revealed or used, the easier it becomes for an attacker to collect information.\nIn this model, thresholds also tend to decline over time, as users gradually lose keys. But there is a twist: if the attacker\u2019s gain rate grows much faster than the user\u2019s decay rate, the optimal strategy flips. In such cases, thresholds must actually rise in later stages to preserve security.\nThe optimal dynamic threshold signature contract, in this case, is given by: \n$$\n\\tau_{i}^{*} = \\sqrt{\\frac{b + a\\left( 1 - \\frac{{2y}_{i}}{Z_{i}} \\right)}{ab}}\n$$\n$$\nT^{*} = \\frac{1}{\\gamma}\\ln\\left[ \\frac{2\\left( p\\left( \\tau_{i - 1}^{*} \\right) - p\\left( \\tau_{i}^{*} \\right) \\right)}{p\\left( \\tau_{i - 1}^{*} \\right)q\\left( \\tau_{i - 1}^{*} \\right) - p\\left( \\tau_{i}^{*} \\right)q\\left( \\tau_{i}^{*} \\right)} \\right]\n$$\nwhere\n$$\nZ_{i} = \\int_{T_{i}} e^{- \\lambda t} e^{\\gamma t} dt, \\ \\ \ny_{i} = \\int_{T_{i}} e^{- \\lambda t} dt\n$$\n$for\\ i = 1,\\dots,n.$\n \n![image|568x284](upload://bU6HiSDyuWuf1Kpz4MZzOy8zPZI.png)\n\n$$\n\\text{Fig. 6: Two stage dynamic threshold scheme }(\\tau_{i - 1}^{*}, \\tau_{i}^{*})\\\\ \\text{ (Attacker gains access over time)}\n$$\n\nThe source code for our simulations is available on Github at: https://github.com/sindurasaraswathi/Optimal_Threshold_Signatures\n\nOur analysis here of optimal threshold signature helps to guide some of the wide range of possibilities that Taproot unlocks. Indeed, the Taproot Merkle trees (Taptrees) can have vast depth and complexity, and therefore, some theory is useful in terms of guiding which schemes are superior to others. \n\nFuture research can extend this line of work by broadening the economic and security environment of future users of threshold signature schemes. The undiscovered country will be unlocking the full possibility of Taproot to allow for all manner of economic transactions to be represented through Taptrees and more complex contracts, including time locks and multiple signatures. Even greater possibilities will emerge when second-layer protocols integrate with the base layer. This can be particularly useful for artificial agents to utilize the full complexity that Taproot enables. While this work has focused chiefly on the human use cases of threshold signature, future users may be AI agents who can utilize Bitcoin Script in ways we cannot yet imagine.\n\nRead more about this research at: https://www.arxiv.org/pdf/2509.25408",
  "actions_summary": [
    {
      "id": 2,
      "count": 5
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 680,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Threshold signatures are now common methods to secure funds in Bitcoin. An m-of-n signature scheme requires at least m signatures to unlock funds secured by n public keys. An open question, however, is the optimal design of such schemes. When should the threshold be high, when should it be low, and &hellip;",
  "truncated": true,
  "post_url": "/t/optimal-threshold-signatures-in-bitcoin/2023/1",
  "reactions": [
    {
      "id": "heart",
      "type": "emoji",
      "count": 4
    },
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 5,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null,
  "can_vote": false
}