{
  "id": 3931,
  "name": "Zawy",
  "username": "zawy",
  "avatar_template": "/user_avatar/delvingbitcoin.org/zawy/{size}/750_2.png",
  "created_at": "2025-01-03T02:41:13.527Z",
  "cooked": "<p>Adjusting for \u201cexcess grandparents\u201d as described above seems to have potential in alleviating the topology problem (\u201clatency inequality\u201d).  The idea is that high-latency miners will disproportionally reference a parent that is a grandparent of a low-latency sibling.  I did some data collection and noticed these \u201cgrandparents\u201d occur equally as often as 3 parents when my target is parents = 1.44 and when the latencies are evenly distributed. The grandparent to 3-parent frequency ratio is normally 1:1 and it increases when latency is higher for some of the miners.</p>\n<p>To clarify, I want to identify blocks that have a parent that would have been a grandparent if not for the block having excessive latency in receiving the parent and/or sending out his own block that\u2019s a child to it. I\u2019m calling them a grandparent, but they\u2019re a parent. I adjust the DAA for the child block. He\u2019ll get very slightly higher difficulty for having longer latency and thereby having this type of parent, and his descendants will feel the small effect. We assume &gt;50% honest miners who won\u2019t steal pennies to lose pounds.</p>\n<p>Data collection to see if it would have the effect I thought it would</p>\n<pre><code class=\"lang-auto\">naughty grandparents per 3-parents\nhashrate fraction v. multiples of latency increase\nHRF\t\t2x\t\t\t4x\t\t\t8x\n0%\t\t102%\t\t102%\t\t102%\n1.25%\t108%\t\t111%\t\t100%\n2.5%\t111%\t\t121%\t\t94%\n5%\t\t117%\t\t134%\t\t93%\n10%\t\t131%\t\t169%\t\t126%\n20%\t\t147%\t\t195%\t\t215%\n30%\t\t140%\t\t192%\t\t229%\n40%\t\t133%\t\t179%\t\t206%\n50%\t\t124%\t\t153%\t\t188%\n60%\t\t117%\t\t138%\t\t174%\n70%\t\t116%\t\t127%\t\t169%\n80%\t\t108%\t\t120%\t\t165%\n90%\t\t107%\t\t117%\t\t159%\n95%\t\t\t\t\t\t\t\t149%\n100%\t102%\t\t102%\t\t102%\n</code></pre>\n<p>Since the ratio is 1.02 during equitable latency conditions, a simple change to the difficulty algorithm could be used.  The existing difficulty was:</p>\n<p>D = avgD * (1 + (numParentsObserved - 1.44) / 200 )</p>\n<p>so I added:</p>\n<p>D  = D * (1+ (grandparents - 3parentsBoolean) / 200 )</p>\n<p>avgD is the average difficulty of the block\u2019s immediate parents.  3parents is either 1 or 0 depending on if there were 3 parents for that block or not. It could be more sophisticated. These type of gandparents can be more than 1 for a block.</p>\n<p>It worked as good as the original equation under normal stable conditions and during hashrate attacks without change.</p>\n<p>These two charts show it reduced the problems caused by 20% of the miners having up to 4x slower latency.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb_2_690x350.png\" alt=\"image\" data-base62-sha1=\"lsqgaLlEW7QgfIzwtXpN6CSNtuH\" width=\"690\" height=\"350\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb_2_690x350.png, https://delvingbitcoin.org/uploads/default/optimized/1X/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb_2_1035x525.png 1.5x, https://delvingbitcoin.org/uploads/default/optimized/1X/96642ec0e9ef9a76717eca0cdaf5769fa4d4b2fb_2_1380x700.png 2x\" data-dominant-color=\"F8F6F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1920\u00d7975 131 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/8b10f008647cb1b3cba94302be0f685985c82074.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/8b10f008647cb1b3cba94302be0f685985c82074\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/8b10f008647cb1b3cba94302be0f685985c82074_2_690x350.png\" alt=\"image\" data-base62-sha1=\"jQeEJRHx79ymhxwLnsyDFlLNgUs\" width=\"690\" height=\"350\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/8b10f008647cb1b3cba94302be0f685985c82074_2_690x350.png, https://delvingbitcoin.org/uploads/default/optimized/1X/8b10f008647cb1b3cba94302be0f685985c82074_2_1035x525.png 1.5x, https://delvingbitcoin.org/uploads/default/optimized/1X/8b10f008647cb1b3cba94302be0f685985c82074_2_1380x700.png 2x\" data-dominant-color=\"F9F7F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1920\u00d7975 127 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>A comparison to 1 or 2 parents has more data and thereby be more accurate. 2 parents gave the best result. An adjustment to the 2nd equation is needed due to 2 parents being 4.4x more common than \u2018grandparents\u2019 under homogenous latencies. To clarify \u201chogobenous\u201d: latencies can vary widely and randomly and everything works fine for all algos as long as the latency is homogenous among all miners. The grandparent adjustment has a beneficial effect when they aren\u2019t</p>\n<p>D = D * ( 1 + (grandparents - 2parentsBoolean/4.4) / 200)</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437_2_690x350.png\" alt=\"image\" data-base62-sha1=\"yvymm0JYXRYOVx100iFownbQMpV\" width=\"690\" height=\"350\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437_2_690x350.png, https://delvingbitcoin.org/uploads/default/optimized/1X/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437_2_1035x525.png 1.5x, https://delvingbitcoin.org/uploads/default/optimized/1X/f1db0a23798ed5d9eeab7eb1c0c8a7133b6e1437_2_1380x700.png 2x\" data-dominant-color=\"F9F6F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1920\u00d7975 126 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>It doesn\u2019t work as good if the hashrate fraction is 15% instead of 20%. It would be good to provide protection when only 5% of miners have excessive latency, but that seems too challenging.</p>\n<p>The next 2 charts show the benefit is more pronounced when 25% of the hashrate has high latency.  The 1st one with the higher difficulty is with the new equation above.\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/43562dfcf240cbd53b3f74a08beac0ab998ca5fa.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/43562dfcf240cbd53b3f74a08beac0ab998ca5fa\" title=\"grandparentsF\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/43562dfcf240cbd53b3f74a08beac0ab998ca5fa_2_690x350.png\" alt=\"grandparentsF\" data-base62-sha1=\"9BGD1Zcbbc0PwMYjI3ti59sky0O\" width=\"690\" height=\"350\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/43562dfcf240cbd53b3f74a08beac0ab998ca5fa_2_690x350.png, https://delvingbitcoin.org/uploads/default/optimized/1X/43562dfcf240cbd53b3f74a08beac0ab998ca5fa_2_1035x525.png 1.5x, https://delvingbitcoin.org/uploads/default/optimized/1X/43562dfcf240cbd53b3f74a08beac0ab998ca5fa_2_1380x700.png 2x\" data-dominant-color=\"F9F7F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">grandparentsF</span><span class=\"informations\">1920\u00d7975 137 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600\" title=\"grandparentsG\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600_2_690x350.png\" alt=\"grandparentsG\" data-base62-sha1=\"90iayEbZ5bzUnEmZ1gXmue18xRm\" width=\"690\" height=\"350\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600_2_690x350.png, https://delvingbitcoin.org/uploads/default/optimized/1X/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600_2_1035x525.png 1.5x, https://delvingbitcoin.org/uploads/default/optimized/1X/3f1c0bf11b0dc7f0f3a2e543ee894e2bc175f600_2_1380x700.png 2x\" data-dominant-color=\"FAF7F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">grandparentsG</span><span class=\"informations\">1920\u00d7975 129 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
  "post_number": 10,
  "post_type": 1,
  "posts_count": 21,
  "updated_at": "2025-01-03T11:51:32.832Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 40,
  "reads": 35,
  "readers_count": 34,
  "score": 202.0,
  "yours": false,
  "topic_id": 1331,
  "topic_slug": "fastest-possible-pow-via-simple-dag",
  "topic_title": "Fastest-possible PoW via Simple DAG",
  "topic_html_title": "Fastest-possible PoW via Simple DAG",
  "category_id": 7,
  "display_username": "Zawy",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 9,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Adjusting for \"excess grandparents\" as described above seems to have potential in alleviating the topology problem (\"latency inequality\").  The idea is that high-latency miners will disproportionally reference a parent that is a grandparent of a low-latency sibling.  I did some data collection and noticed these \"grandparents\" occur equally as often as 3 parents when my target is parents = 1.44 and when the latencies are evenly distributed. The grandparent to 3-parent frequency ratio is normally 1:1 and it increases when latency is higher for some of the miners.\n\nTo clarify, I want to identify blocks that have a parent that would have been a grandparent if not for the block having excessive latency in receiving the parent and/or sending out his own block that's a child to it. I'm calling them a grandparent, but they're a parent. I adjust the DAA for the child block. He'll get very slightly higher difficulty for having longer latency and thereby having this type of parent, and his descendants will feel the small effect. We assume >50% honest miners who won't steal pennies to lose pounds.  \n\nData collection to see if it would have the effect I thought it would\n```\nnaughty grandparents per 3-parents\nhashrate fraction v. multiples of latency increase\nHRF\t\t2x\t\t\t4x\t\t\t8x\n0%\t\t102%\t\t102%\t\t102%\n1.25%\t108%\t\t111%\t\t100%\n2.5%\t111%\t\t121%\t\t94%\n5%\t\t117%\t\t134%\t\t93%\n10%\t\t131%\t\t169%\t\t126%\n20%\t\t147%\t\t195%\t\t215%\n30%\t\t140%\t\t192%\t\t229%\n40%\t\t133%\t\t179%\t\t206%\n50%\t\t124%\t\t153%\t\t188%\n60%\t\t117%\t\t138%\t\t174%\n70%\t\t116%\t\t127%\t\t169%\n80%\t\t108%\t\t120%\t\t165%\n90%\t\t107%\t\t117%\t\t159%\n95%\t\t\t\t\t\t\t\t149%\n100%\t102%\t\t102%\t\t102%\n```\n\nSince the ratio is 1.02 during equitable latency conditions, a simple change to the difficulty algorithm could be used.  The existing difficulty was:\n\nD = avgD * (1 + (numParentsObserved - 1.44) / 200 )\n\nso I added:\n\nD  = D * (1+ (grandparents - 3parentsBoolean) / 200 )\n\navgD is the average difficulty of the block's immediate parents.  3parents is either 1 or 0 depending on if there were 3 parents for that block or not. It could be more sophisticated. These type of gandparents can be more than 1 for a block.\n\nIt worked as good as the original equation under normal stable conditions and during hashrate attacks without change.  \n\nThese two charts show it reduced the problems caused by 20% of the miners having up to 4x slower latency.\n\n![image|690x350](upload://lsqgaLlEW7QgfIzwtXpN6CSNtuH.png)\n![image|690x350](upload://jQeEJRHx79ymhxwLnsyDFlLNgUs.png)\n\nA comparison to 1 or 2 parents has more data and thereby be more accurate. 2 parents gave the best result. An adjustment to the 2nd equation is needed due to 2 parents being 4.4x more common than 'grandparents' under homogenous latencies. To clarify \"hogobenous\": latencies can vary widely and randomly and everything works fine for all algos as long as the latency is homogenous among all miners. The grandparent adjustment has a beneficial effect when they aren't\n\nD = D * ( 1 + (grandparents - 2parentsBoolean/4.4) / 200)\n\n![image|690x350](upload://yvymm0JYXRYOVx100iFownbQMpV.png)\n\nIt doesn't work as good if the hashrate fraction is 15% instead of 20%. It would be good to provide protection when only 5% of miners have excessive latency, but that seems too challenging.\n\nThe next 2 charts show the benefit is more pronounced when 25% of the hashrate has high latency.  The 1st one with the higher difficulty is with the new equation above.\n![grandparentsF|690x350](upload://9BGD1Zcbbc0PwMYjI3ti59sky0O.png)\n\n![grandparentsG|690x350](upload://90iayEbZ5bzUnEmZ1gXmue18xRm.png)",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 502,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Adjusting for \u201cexcess grandparents\u201d as described above seems to have potential in alleviating the topology problem (\u201clatency inequality\u201d).  The idea is that high-latency miners will disproportionally reference a parent that is a grandparent of a low-latency sibling.  I did some data collection and n&hellip;",
  "truncated": true,
  "post_url": "/t/fastest-possible-pow-via-simple-dag/1331/10",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}