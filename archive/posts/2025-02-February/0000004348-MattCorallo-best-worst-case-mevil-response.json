{
  "id": 4348,
  "name": "Matt Corallo",
  "username": "MattCorallo",
  "avatar_template": "/letter_avatar_proxy/v4/letter/m/e47c2d/{size}.png",
  "created_at": "2025-02-20T19:23:29.487Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"1465\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>I think a \u201cbid\u201d of that form would be unpleasant if passed all the way through to miners \u2013 accepting the bid but still including transaction W that interacts with smart contract Z means (in general) modifying transaction W to spend an output of Y (or perhaps some child of Y), and potentially updating the witness data of W to deal with the difference in value of Y\u2019s output vs Z\u2019s output.</p>\n</blockquote>\n</aside>\n<p>Mmm, this is a good point, and I had mostly been thinking of this in the context of things like CSV (and CSV-based rollup) protocols, where this likely doesn\u2019t apply (at least if they\u2019re EVM-like). However,</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"1465\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>Would it be plausible to make the \u201cmevpool marketplace\u201d operate solely on packages of transactions, that is:</p>\n</blockquote>\n</aside>\n<p>Yea, sorry, somewhat shorthand here this is indeed how I\u2019ve been thinking about bids. A proposer would be able to submit one or more transactions in a single bid, and indeed would be able to do what you describe here.</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"1465\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>For sealed bids, I think you could reveal with utxos the package spends, the txids and wtids, and the total sigops, weight, and fee, and then either rely on trusting the marketplace to reveal the tx contents or a trusted execution environment in a similar way.</p>\n</blockquote>\n</aside>\n<p>Yep, though you can pass this all the way through to miners just as well. Basically you\u2019d move bids to always be \u201cthe full set of transactions which interact with a contract\u201d rather than ever being a subset of them (for contracts that rely on state passed via UTXOs) and then you can send the whole tx bundle through to the miner\u2019s TEE (or, indeed, just reveal the metadata if you\u2019re using a trusted marketplace).</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"1465\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>This assumes miners can do package RBF in a fairly optimal manner</p>\n</blockquote>\n</aside>\n<p>Indeed, though luckily this is somewhat simplified in that the miner is required to only either include or not-include the whole package, they cant split it into parts. They just have to be able to compare that to their existing mempool, which is hard but if we\u2019re talking about a server-class processor with SGX you can throw some CPU at it and get close enough to optimal that I\u2019m not worried :).</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"1465\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>Revealing the utxos that sealed txs are spending might be something of a give away to competitors, but seems unavoidable if you want miners to be building the block templates.</p>\n</blockquote>\n</aside>\n<p>This is part of the reason for the TEE - if we can take the whole block building logic and shove it in SGX, we can run it locally at the miner but also send it Sealed transaction (packages) which can be considered for the block template but won\u2019t be extractable (at least for reasonable cost).</p>",
  "post_number": 4,
  "post_type": 1,
  "updated_at": "2025-02-20T19:23:29.487Z",
  "reply_count": 0,
  "reply_to_post_number": 2,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 12,
  "readers_count": 11,
  "score": 47.4,
  "yours": false,
  "topic_id": 1465,
  "topic_slug": "best-worst-case-mevil-response",
  "topic_title": "Best-(Worst-)Case MEVil Response",
  "topic_html_title": "Best-(Worst-)Case MEVil Response",
  "category_id": 7,
  "display_username": "Matt Corallo",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"ajtowns, post:2, topic:1465\"]\nI think a \u201cbid\u201d of that form would be unpleasant if passed all the way through to miners \u2013 accepting the bid but still including transaction W that interacts with smart contract Z means (in general) modifying transaction W to spend an output of Y (or perhaps some child of Y), and potentially updating the witness data of W to deal with the difference in value of Y\u2019s output vs Z\u2019s output.\n[/quote]\n\nMmm, this is a good point, and I had mostly been thinking of this in the context of things like CSV (and CSV-based rollup) protocols, where this likely doesn't apply (at least if they're EVM-like). However,\n\n[quote=\"ajtowns, post:2, topic:1465\"]\nWould it be plausible to make the \u201cmevpool marketplace\u201d operate solely on packages of transactions, that is:\n[/quote]\n\nYea, sorry, somewhat shorthand here this is indeed how I've been thinking about bids. A proposer would be able to submit one or more transactions in a single bid, and indeed would be able to do what you describe here.\n\n[quote=\"ajtowns, post:2, topic:1465\"]\nFor sealed bids, I think you could reveal with utxos the package spends, the txids and wtids, and the total sigops, weight, and fee, and then either rely on trusting the marketplace to reveal the tx contents or a trusted execution environment in a similar way.\n[/quote]\n\nYep, though you can pass this all the way through to miners just as well. Basically you'd move bids to always be \"the full set of transactions which interact with a contract\" rather than ever being a subset of them (for contracts that rely on state passed via UTXOs) and then you can send the whole tx bundle through to the miner's TEE (or, indeed, just reveal the metadata if you're using a trusted marketplace).\n\n[quote=\"ajtowns, post:2, topic:1465\"]\nThis assumes miners can do package RBF in a fairly optimal manner\n[/quote]\n\nIndeed, though luckily this is somewhat simplified in that the miner is required to only either include or not-include the whole package, they cant split it into parts. They just have to be able to compare that to their existing mempool, which is hard but if we're talking about a server-class processor with SGX you can throw some CPU at it and get close enough to optimal that I'm not worried :).\n\n[quote=\"ajtowns, post:2, topic:1465\"]\nRevealing the utxos that sealed txs are spending might be something of a give away to competitors, but seems unavoidable if you want miners to be building the block templates.\n[/quote]\n\nThis is part of the reason for the TEE - if we can take the whole block building logic and shove it in SGX, we can run it locally at the miner but also send it Sealed transaction (packages) which can be considered for the block template but won't be extractable (at least for reasonable cost).",
  "actions_summary": [
    {
      "id": 2,
      "count": 1
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 50,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 1,
  "current_user_used_main_reaction": false
}