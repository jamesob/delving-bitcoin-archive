{
  "id": 4213,
  "name": "Anthony Towns",
  "username": "ajtowns",
  "avatar_template": "/user_avatar/delvingbitcoin.org/ajtowns/{size}/417_2.png",
  "created_at": "2025-02-07T03:38:00.282Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"morehouse\" data-post=\"10\" data-topic=\"1412\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/m/df705f/48.png\" class=\"avatar\"> morehouse:</div>\n<blockquote>\n<p>In fact we\u2019ve already seen a similar kind of <a href=\"https://x.com/peterktodd/status/1793380279018803208\">accidental pinning</a> in the wild with expired anchor outputs.</p>\n</blockquote>\n</aside>\n<p>I don\u2019t think that\u2019s an interesting example: anchor outputs for txs that have already confirmed are just \u201chere\u2019s a small amount of free sats for anyone\u201d; if you\u2019re structuring your tx in such a way that you\u2019re making moving real funds contingent on also claiming those free sats, that\u2019s a bad bug.</p>\n<aside class=\"quote no-group\" data-username=\"morehouse\" data-post=\"10\" data-topic=\"1412\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/m/df705f/48.png\" class=\"avatar\"> morehouse:</div>\n<blockquote>\n<p>Are you sure that <em>no one</em> on the network will ever want to grief in this way?</p>\n</blockquote>\n</aside>\n<p>Even with a keyed anchor, your counterparty can grief you in this way, and they are much more likely to do so than a random person on the network, because they have a much greater chance of seeing a profit from doing so (and even if it\u2019s just due to buggy software, they\u2019re the ones paying attention to the tx prior to it being mined). You can\u2019t make this scenario impossible (or even vanishingly unlikely) all you can do is make the expected costs cheaper. If the 1000vb ancestor limit provided by TRUC doesn\u2019t reduce those costs enough, that\u2019s an argument for providing a way to have <a href=\"https://github.com/bitcoin/bips/blob/ea7aae8d1ff275f0d5cff4b3c0efaff66b8fa55f/bip-0431.mediawiki#cite_note-13\">a smaller limit</a> (the limit was already reduced from <a href=\"https://github.com/bitcoin/bitcoin/pull/25038#issuecomment-1198946822\">4000vb to 1000vb</a>).</p>\n<aside class=\"quote no-group\" data-username=\"morehouse\" data-post=\"10\" data-topic=\"1412\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/m/df705f/48.png\" class=\"avatar\"> morehouse:</div>\n<blockquote>\n<p>A mining pool may stand to profit nicely if the victim pays 50% more in fees than they normally would.</p>\n</blockquote>\n</aside>\n<p>If they run the attack, then their win scenarios are:</p>\n<ul>\n<li>every other miner that wins a block before them sees their tx (at high fee but low feerate) instead of the user\u2019s tx (at low fee but high feerate) and doesn\u2019t mine it, slightly driving down the revenue of other mining pools</li>\n<li>people routinely overpay channel close txs, driving up average close fees, of which they get the regular percentage</li>\n</ul>\n<p>Their loss scenario is that the mempool clears out a bit too much and a different pool mines their high fee / low feerate tx, meaning they pay extra fees to another miner, and the user gets their tx mined without paying any fees. I don\u2019t think that adds up to making a nice profit.</p>\n<p>If this griefing approach does somehow become common anyway, it can also be worked around by some nodes/pools adopting a policy of \u201creplace by feerate\u201d, at least for txs that would be at the top of the mempool. (And cluster mempool would make measuring \u201ctop of the mempool\u201d substantially more efficient/straightforward)</p>",
  "post_number": 12,
  "post_type": 1,
  "updated_at": "2025-02-07T03:43:05.408Z",
  "reply_count": 0,
  "reply_to_post_number": 10,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 7,
  "readers_count": 6,
  "score": 1.4,
  "yours": false,
  "topic_id": 1412,
  "topic_slug": "which-ephemeral-anchor-script-should-lightning-use",
  "topic_title": "Which ephemeral anchor script should lightning use?",
  "topic_html_title": "Which ephemeral anchor script should lightning use?",
  "category_id": 7,
  "display_username": "Anthony Towns",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"morehouse, post:10, topic:1412\"]\nIn fact we\u2019ve already seen a similar kind of [accidental pinning](https://x.com/peterktodd/status/1793380279018803208) in the wild with expired anchor outputs.\n[/quote]\n\nI don't think that's an interesting example: anchor outputs for txs that have already confirmed are just \"here's a small amount of free sats for anyone\"; if you're structuring your tx in such a way that you're making moving real funds contingent on also claiming those free sats, that's a bad bug.\n\n[quote=\"morehouse, post:10, topic:1412\"]\nAre you sure that *no one* on the network will ever want to grief in this way?\n[/quote]\n\nEven with a keyed anchor, your counterparty can grief you in this way, and they are much more likely to do so than a random person on the network, because they have a much greater chance of seeing a profit from doing so (and even if it's just due to buggy software, they're the ones paying attention to the tx prior to it being mined). You can't make this scenario impossible (or even vanishingly unlikely) all you can do is make the expected costs cheaper. If the 1000vb ancestor limit provided by TRUC doesn't reduce those costs enough, that's an argument for providing a way to have [a smaller limit](https://github.com/bitcoin/bips/blob/ea7aae8d1ff275f0d5cff4b3c0efaff66b8fa55f/bip-0431.mediawiki#cite_note-13) (the limit was already reduced from [4000vb to 1000vb](https://github.com/bitcoin/bitcoin/pull/25038#issuecomment-1198946822)).\n\n[quote=\"morehouse, post:10, topic:1412\"]\nA mining pool may stand to profit nicely if the victim pays 50% more in fees than they normally would.\n[/quote]\n\nIf they run the attack, then their win scenarios are:\n * every other miner that wins a block before them sees their tx (at high fee but low feerate) instead of the user's tx (at low fee but high feerate) and doesn't mine it, slightly driving down the revenue of other mining pools\n * people routinely overpay channel close txs, driving up average close fees, of which they get the regular percentage\n\nTheir loss scenario is that the mempool clears out a bit too much and a different pool mines their high fee / low feerate tx, meaning they pay extra fees to another miner, and the user gets their tx mined without paying any fees. I don't think that adds up to making a nice profit.\n\nIf this griefing approach does somehow become common anyway, it can also be worked around by some nodes/pools adopting a policy of \"replace by feerate\", at least for txs that would be at the top of the mempool. (And cluster mempool would make measuring \"top of the mempool\" substantially more efficient/straightforward)",
  "actions_summary": [],
  "moderator": true,
  "admin": true,
  "staff": true,
  "user_id": 3,
  "hidden": false,
  "trust_level": 4,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": "Github link was replaced with a permanent link",
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}