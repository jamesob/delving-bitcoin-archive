{
  "id": 2948,
  "name": "Murch",
  "username": "murch",
  "avatar_template": "/user_avatar/delvingbitcoin.org/murch/{size}/139_2.png",
  "created_at": "2024-08-13T18:29:05.073Z",
  "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"sipa\" data-post=\"9\" data-topic=\"1062\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sipa/48/102_2.png\" class=\"avatar\"> sipa:</div>\n<blockquote>\n<p>Overall the operation takes 2\\sqrt{2} + \\epsilon \\approx 2.832\u221a2+\u03f5\u22482.832\\sqrt{2} + \\epsilon \\approx 2.83 windows\u2019 worth of time, but produced 333 windows\u2019 worth of blocks, without ever raising the difficulty above the starting one.</p>\n</blockquote>\n</aside>\n<p>I\u2019m not sure I understand your scenario. The first difficulty period takes 4 weeks (if they are fudging timestamps with half the hashrate), or 2 weeks (if they only fudge the timestamp of the last block) and the timestamp on the last block is <span class=\"math\">\\sqrt{2}\u00d72</span> weeks from the start of the attack, i.e. pushed 0.82 weeks into the future. The difficulty is reduced to <span class=\"math\">d_{new} =\\frac{1}{\\sqrt{2}}\u00d7d_{old}</span>.  The attacker then needs to start mining by themselves since nobody else will accept their post-dated last block. The second period takes <span class=\"math\">\\frac{2 weeks}{0.5 \u00d7 hashrate}\u00d7\\frac{d_{new}}{d_{old}} = \\frac{2\u00d72}{\\sqrt{2}}</span> weeks because the difficulty went down but they have only half the hashrate which is another <span class=\"math\">\\sqrt{2}\u00d72 \\approx 2.82</span> weeks.</p>\n<p>If that\u2019s exactly the timestamp increase they use in the second difficulty period, the difficulty remains constant. So, now the attacker uses minimal timestamp increases to mine a third difficulty period which takes them another 2.82 weeks. The final timestamp is now about 4.82 weeks from the start of the attack, but the elapsed time is either 7.64 weeks or 9.64 weeks from the start of the attack. The difficulty now increases maximally, which is either 2\u00d7 or 2.5\u00d7, which leads to a new difficulty of <span class=\"math\">2\u00d7\\sqrt(2)</span> or <span class=\"math\">2.5\u00d7\\sqrt(2)</span>. This is bigger than the original difficulty, and the elapsed time is bigger than 6 weeks.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"sipa\" data-post=\"9\" data-topic=\"1062\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sipa/48/102_2.png\" class=\"avatar\"> sipa:</div>\n<blockquote>\n<ul>\n<li>First window takes \\sqrt{2}\u221a2\\sqrt{2} times two weeks</li>\n<li>Second window takes \\sqrt{2}\u221a2\\sqrt{2} times two weeks</li>\n<li>Third window takes minimum legal time (i.e. 2016/6 seconds).</li>\n</ul>\n</blockquote>\n</aside>\n<p>So, I guess it\u2019s not clear to me whether you meant elapsed time, or timestamp progress here, and how much hashrate you assumed the attacker had.</p>",
  "post_number": 10,
  "post_type": 1,
  "updated_at": "2024-08-13T18:29:05.073Z",
  "reply_count": 0,
  "reply_to_post_number": 9,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 1.0,
  "yours": false,
  "topic_id": 1062,
  "topic_slug": "zawy-s-alternating-timestamp-attack",
  "topic_title": "Zawy\u2019s Alternating Timestamp Attack",
  "topic_html_title": "Zawy\u2019s Alternating Timestamp Attack",
  "category_id": 7,
  "display_username": "Murch",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": "",
  "bookmarked": false,
  "raw": "[quote=\"sipa, post:9, topic:1062\"]\nOverall the operation takes 2\\sqrt{2} + \\epsilon \\approx 2.832\u221a2+\u03f5\u22482.832\\sqrt{2} + \\epsilon \\approx 2.83 windows\u2019 worth of time, but produced 333 windows\u2019 worth of blocks, without ever raising the difficulty above the starting one.\n[/quote]\n\nI\u2019m not sure I understand your scenario. The first difficulty period takes 4 weeks (if they are fudging timestamps with half the hashrate), or 2 weeks (if they only fudge the timestamp of the last block) and the timestamp on the last block is $\\sqrt{2}\u00d72$ weeks from the start of the attack, i.e. pushed 0.82 weeks into the future. The difficulty is reduced to $d_{new} =\\frac{1}{\\sqrt{2}}\u00d7d_{old}$.  The attacker then needs to start mining by themselves since nobody else will accept their post-dated last block. The second period takes $\\frac{2 weeks}{0.5 \u00d7 hashrate}\u00d7\\frac{d_{new}}{d_{old}} = \\frac{2\u00d72}{\\sqrt{2}}$ weeks because the difficulty went down but they have only half the hashrate which is another $\\sqrt{2}\u00d72 \\approx 2.82$ weeks. \n\nIf that\u2019s exactly the timestamp increase they use in the second difficulty period, the difficulty remains constant. So, now the attacker uses minimal timestamp increases to mine a third difficulty period which takes them another 2.82 weeks. The final timestamp is now about 4.82 weeks from the start of the attack, but the elapsed time is either 7.64 weeks or 9.64 weeks from the start of the attack. The difficulty now increases maximally, which is either 2\u00d7 or 2.5\u00d7, which leads to a new difficulty of $2\u00d7\\sqrt(2)$ or $2.5\u00d7\\sqrt(2)$. This is bigger than the original difficulty, and the elapsed time is bigger than 6 weeks.\n\n[quote=\"sipa, post:9, topic:1062\"]\n* First window takes \\sqrt{2}\u221a2\\sqrt{2} times two weeks\n* Second window takes \\sqrt{2}\u221a2\\sqrt{2} times two weeks\n* Third window takes minimum legal time (i.e. 2016/6 seconds).\n[/quote]\n\nSo, I guess it\u2019s not clear to me whether you meant elapsed time, or timestamp progress here, and how much hashrate you assumed the attacker had.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 58,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}