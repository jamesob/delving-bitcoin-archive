{
  "id": 3003,
  "name": "moonsettler",
  "username": "moonsettler",
  "avatar_template": "/user_avatar/delvingbitcoin.org/moonsettler/{size}/38_2.png",
  "created_at": "2024-08-20T15:15:29.451Z",
  "cooked": "<p>An anti-exfil variant for airgaped signing devices using PSBTs that works with the QR code based traditional signing workflow.</p>\n<h2><a name=\"p-3003-signing-protocol-1\" class=\"anchor\" href=\"#p-3003-signing-protocol-1\"></a>Signing protocol:</h2>\n<pre><code class=\"lang-plaintext\">x: private key\nX: public key\nm: message to sign\nn: nonce extra\n</code></pre>\n<h3><a name=\"p-3003-h-1-signing-device-2\" class=\"anchor\" href=\"#p-3003-h-1-signing-device-2\"></a>1. signing device</h3>\n<pre><code class=\"lang-plaintext\">q = hash(x, m, n)\nQ = q\u00b7G\nk = q + hash(Q, m, n)\nR = k\u00b7G\ne = hash(R, X, m)\n</code></pre>\n<p>Schnorr signature</p>\n<pre><code class=\"lang-plaintext\">s = k + x\u00b7e\n</code></pre>\n<p>ECDSA signature</p>\n<pre><code class=\"lang-plaintext\">r = R.x\ns = k\u207b\u00b9\u00b7(m + r\u00b7x)\n</code></pre>\n<h3><a name=\"p-3003-h-2-return-to-wallet-app-3\" class=\"anchor\" href=\"#p-3003-h-2-return-to-wallet-app-3\"></a>2. return to wallet app</h3>\n<pre><code class=\"lang-plaintext\">Q, s\n</code></pre>\n<h3><a name=\"p-3003-h-3-wallet-app-calculates-4\" class=\"anchor\" href=\"#p-3003-h-3-wallet-app-calculates-4\"></a>3. wallet app calculates</h3>\n<pre><code class=\"lang-plaintext\">R = Q + hash(Q, m, n)\u00b7G\nR, s\n</code></pre>\n<h3><a name=\"p-3003-h-4-verify-5\" class=\"anchor\" href=\"#p-3003-h-4-verify-5\"></a>4. verify</h3>\n<p>Schnorr verify</p>\n<pre><code class=\"lang-plaintext\">e = hash(R, X, m)\n\ns\u00b7G ?= R + e\u00b7X\n</code></pre>\n<p>ECDSA verify</p>\n<pre><code class=\"lang-plaintext\">r = R.x\n\ns\u207b\u00b9\u00b7m\u00b7G + s\u207b\u00b9\u00b7r\u00b7X ?= R\n</code></pre>\n<p>[<a href=\"https://gist.github.com/moonsettler/d4eb59c62a2b8f104c72603231b73a41\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Non interactive anti-exfil \u00b7 GitHub</a>](Gist, Q&amp;A, earlier discussion)</p>",
  "post_number": 1,
  "post_type": 1,
  "updated_at": "2024-08-20T18:40:40.188Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 7,
  "reads": 15,
  "readers_count": 14,
  "score": 82.8,
  "yours": false,
  "topic_id": 1081,
  "topic_slug": "non-interactive-anti-exfil-airgap-compatible",
  "topic_title": "Non interactive anti-exfil (airgap compatible)",
  "topic_html_title": "Non interactive anti-exfil (airgap compatible)",
  "category_id": 7,
  "display_username": "moonsettler",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "An anti-exfil variant for airgaped signing devices using PSBTs that works with the QR code based traditional signing workflow.\n\n## Signing protocol:\n```text\nx: private key\nX: public key\nm: message to sign\nn: nonce extra\n```\n### 1. signing device\n```text\nq = hash(x, m, n)\nQ = q\u00b7G\nk = q + hash(Q, m, n)\nR = k\u00b7G\ne = hash(R, X, m)\n```\nSchnorr signature\n```text\ns = k + x\u00b7e\n```\nECDSA signature\n```text\nr = R.x\ns = k\u207b\u00b9\u00b7(m + r\u00b7x)\n```\n### 2. return to wallet app\n```text\nQ, s\n```\n### 3. wallet app calculates\n```text\nR = Q + hash(Q, m, n)\u00b7G\nR, s\n```\n### 4. verify\nSchnorr verify\n```text\ne = hash(R, X, m)\n\ns\u00b7G ?= R + e\u00b7X\n```\nECDSA verify\n```text\nr = R.x\n\ns\u207b\u00b9\u00b7m\u00b7G + s\u207b\u00b9\u00b7r\u00b7X ?= R\n```\n\n[https://gist.github.com/moonsettler/d4eb59c62a2b8f104c72603231b73a41](Gist, Q&A, earlier discussion)",
  "actions_summary": [
    {
      "id": 2,
      "count": 1
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 48,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 1,
  "current_user_used_main_reaction": false
}