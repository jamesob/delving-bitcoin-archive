{
  "id": 3095,
  "name": "moonsettler",
  "username": "moonsettler",
  "avatar_template": "/user_avatar/delvingbitcoin.org/moonsettler/{size}/38_2.png",
  "created_at": "2024-09-03T21:25:48.966Z",
  "cooked": "<h3><a name=\"p-3095-dark-smoothie-1\" class=\"anchor\" href=\"#p-3095-dark-smoothie-1\"></a>Dark Smoothie</h3>\n<p>I was not sure where to put this, so here we go:</p>\n<p>Many have heard about Dark Skippy already, while it is trivial to leak the private key using chosen nonce and it only takes a single signature, Dark Skippy demonstrated the ability to practically leak a 128 bit (12 words) seed using merely 2 signatures from the same device. Here is an alternative (Dark Smoothie), that works if a transaction is signed with 2 inputs locked by the same private key x and can leak 256 bits (24 words) without any fancy math or churning:</p>\n<pre><code class=\"lang-plaintext\">k1 = hash(attacker_secret|e1)\u00b7x\nk2 = 256_bit_secret\nz = e1+hash(attacker_secret|e1)\ns1 = k1+e1\u00b7x = x\u00b7z\nx = s1\u00b7mod_inv(z)\ns2 = k2+e2\u00b7x\nk2 = s2-e2\u00b7x\n</code></pre>\n<p><code>256_bit_secret</code> leaked on an encrypted channel to the attacker! Worst part is, this works as a low probability attack, that may be triggered by something like for example \u201cdusting\u201d an address with a TXID that conforms to some specific 32 bit checkum. That means such a signing device will statistically always pass factory and user tests expecting RFC6979 noncegen, but can still be triggered to leak the secrets without physical access.</p>\n<p>Both attacks are in theory \u201cdefeated\u201d by level 2 or 3 Anti-Exfil if the companion app is not malicious.</p>",
  "post_number": 14,
  "post_type": 1,
  "updated_at": "2024-09-03T21:28:46.874Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 10,
  "reads": 3,
  "readers_count": 2,
  "score": 50.6,
  "yours": false,
  "topic_id": 1081,
  "topic_slug": "non-interactive-anti-exfil-airgap-compatible",
  "topic_title": "Non interactive anti-exfil (airgap compatible)",
  "topic_html_title": "Non interactive anti-exfil (airgap compatible)",
  "category_id": 7,
  "display_username": "moonsettler",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "### Dark Smoothie\nI was not sure where to put this, so here we go:\n\nMany have heard about Dark Skippy already, while it is trivial to leak the private key using chosen nonce and it only takes a single signature, Dark Skippy demonstrated the ability to practically leak a 128 bit (12 words) seed using merely 2 signatures from the same device. Here is an alternative (Dark Smoothie), that works if a transaction is signed with 2 inputs locked by the same private key x and can leak 256 bits (24 words) without any fancy math or churning:\n```text\nk1 = hash(attacker_secret|e1)\u00b7x\nk2 = 256_bit_secret\nz = e1+hash(attacker_secret|e1)\ns1 = k1+e1\u00b7x = x\u00b7z\nx = s1\u00b7mod_inv(z)\ns2 = k2+e2\u00b7x\nk2 = s2-e2\u00b7x\n```\n`256_bit_secret` leaked on an encrypted channel to the attacker! Worst part is, this works as a low probability attack, that may be triggered by something like for example \"dusting\" an address with a TXID that conforms to some specific 32 bit checkum. That means such a signing device will statistically always pass factory and user tests expecting RFC6979 noncegen, but can still be triggered to leak the secrets without physical access.\n\nBoth attacks are in theory \"defeated\" by level 2 or 3 Anti-Exfil if the companion app is not malicious.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 48,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}