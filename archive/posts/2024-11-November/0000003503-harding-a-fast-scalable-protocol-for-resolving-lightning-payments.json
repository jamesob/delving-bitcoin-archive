{
  "id": 3503,
  "name": "David A. Harding",
  "username": "harding",
  "avatar_template": "/user_avatar/delvingbitcoin.org/harding/{size}/6_2.png",
  "created_at": "2024-11-10T18:03:56.191Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"JohnLaw\" data-post=\"5\" data-topic=\"1233\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/j/58956e/48.png\" class=\"avatar\"> JohnLaw:</div>\n<blockquote>\n<p>I\u2019m afraid I\u2019m not following you here. What do you mean by a \u201cpenalty payment\u201d?</p>\n</blockquote>\n</aside>\n<p>Let\u2019s assume Alice wants to pay Carol through Bob, <code>A -&gt; B -&gt; C</code>.  Alice\nuses OPR to offer Bob 10,000 sats (~$10) conditional on delivery of a\npreimage within 10 seconds.  Bob makes the same offer to Carol but for 9\nseconds (and minus a small forwarding fee).</p>\n<p>Before either OPR-HTLC is resolved, Bob\u2019s node is subjected to a ping\nflood DoS attack for 15 seconds, preventing him from communicating with\neither Alice or Carol.  When he comes back online, Carol delivers the\npreimage along with a claim that she sent it before the expiry.  Bob\u2019s\nnode knows it lost connectivity during that time, so it resolves the\nHTLC\u2014paying Carol 10,000 sats.</p>\n<p>Bob also delivers the preimage to Alice but she says that it\u2019s too late.\nAgain Bob\u2019s node acquiesces and refunds her 10,000 sats.  Now Bob has\npaid Carol 10,000 sats without gaining anything from Alice, a net loss\nof 10,000 sats.</p>\n<p>Either Alice or Carol, who might actually be the same person (Mallory),\ncould have enginereed this situation by attacking Bob\u2019s node.</p>\n<p>This attack can also be performed on longer routes, e.g. <code>A -&gt; B -&gt; ... -&gt; Y -&gt; Z</code>.  If Kay\u2019s node is prevented from communicating, she\u2019ll pay\nforward to Lloyd and refund to John.  John will refund to Iris, etc,\nback to Alice.  Zed will have propagated the preimage back to Lloyd and\nclaimed the payment.  Again, Kay loses money due to being the victim of\nan attack.  Also again, if the endpoints (Alice and Zed) are both\ncontrolled by the same person (Mallory), that person will gain from\nKay\u2019s loss.</p>\n<p>This may not be called a penalty, but I think it acts as one.</p>\n<p>This attack doesn\u2019t require Mallory to DoS attack nodes or attempt to\ndisrupt the network\u2014it can simply depend on some nodes naturally\ncrashing or losing connectivity from time to time\u2014but instigating\nattacks will increases its profitability.  The natural consequence of\nthis attack is that OPR nodes will need to be much more robust against\nIP-layer attacks, which is good for payment reliability but bad if it\nexcessively raises the cost of running a node, as expensive nodes or\ncost sharing will likely lead to forwarding node centralization.</p>",
  "post_number": 7,
  "post_type": 1,
  "updated_at": "2024-11-10T18:03:56.191Z",
  "reply_count": 1,
  "reply_to_post_number": 5,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 6,
  "readers_count": 5,
  "score": 6.2,
  "yours": false,
  "topic_id": 1233,
  "topic_slug": "a-fast-scalable-protocol-for-resolving-lightning-payments",
  "topic_title": "A Fast, Scalable Protocol For Resolving Lightning Payments",
  "topic_html_title": "A Fast, Scalable Protocol For Resolving Lightning Payments",
  "category_id": 7,
  "display_username": "David A. Harding",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"JohnLaw, post:5, topic:1233\"]\nI\u2019m afraid I\u2019m not following you here. What do you mean by a \u201cpenalty payment\u201d?\n[/quote]\n\nLet's assume Alice wants to pay Carol through Bob, `A -> B -> C`.  Alice\nuses OPR to offer Bob 10,000 sats (~$10) conditional on delivery of a\npreimage within 10 seconds.  Bob makes the same offer to Carol but for 9\nseconds (and minus a small forwarding fee).\n\nBefore either OPR-HTLC is resolved, Bob's node is subjected to a ping\nflood DoS attack for 15 seconds, preventing him from communicating with\neither Alice or Carol.  When he comes back online, Carol delivers the\npreimage along with a claim that she sent it before the expiry.  Bob's\nnode knows it lost connectivity during that time, so it resolves the\nHTLC---paying Carol 10,000 sats.\n\nBob also delivers the preimage to Alice but she says that it's too late.\nAgain Bob's node acquiesces and refunds her 10,000 sats.  Now Bob has\npaid Carol 10,000 sats without gaining anything from Alice, a net loss\nof 10,000 sats.\n\nEither Alice or Carol, who might actually be the same person (Mallory),\ncould have enginereed this situation by attacking Bob's node.\n\nThis attack can also be performed on longer routes, e.g. `A -> B -> ...\n-> Y -> Z`.  If Kay's node is prevented from communicating, she'll pay\nforward to Lloyd and refund to John.  John will refund to Iris, etc,\nback to Alice.  Zed will have propagated the preimage back to Lloyd and\nclaimed the payment.  Again, Kay loses money due to being the victim of\nan attack.  Also again, if the endpoints (Alice and Zed) are both\ncontrolled by the same person (Mallory), that person will gain from\nKay's loss.\n\nThis may not be called a penalty, but I think it acts as one.\n\nThis attack doesn't require Mallory to DoS attack nodes or attempt to\ndisrupt the network---it can simply depend on some nodes naturally\ncrashing or losing connectivity from time to time---but instigating\nattacks will increases its profitability.  The natural consequence of\nthis attack is that OPR nodes will need to be much more robust against\nIP-layer attacks, which is good for payment reliability but bad if it\nexcessively raises the cost of running a node, as expensive nodes or\ncost sharing will likely lead to forwarding node centralization.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 6,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}