{
  "id": 704,
  "name": "Pieter Wuille",
  "username": "sipa",
  "avatar_template": "/user_avatar/delvingbitcoin.org/sipa/{size}/102_2.png",
  "created_at": "2023-12-10T18:14:04.947Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>I assume you are defining it on a graph so that you can have a chunking across multiple clusters</p>\n</blockquote>\n</aside>\n<p>Right. I\u2019ve added a paragraph to elaborate on why that is.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>it seems to me that this definition would only require that the topology is valid at the chunk borders and would not require the transactions to be topological <em>within the chunks</em>.</p>\n</blockquote>\n</aside>\n<p>Chunks, as defined here, are sets; they don\u2019t have an internal ordering. I\u2019ve gone back and forth in my thinking whether sets or sequences are better. The advantage of sets is that at the chunking level, you don\u2019t need to care about distinct intra-chunk linearization orderings. The disadvantage is that converting back from chunkings to linearizations isn\u2019t as natural.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>Would it perhaps be sufficient that a feerate diagram has exactly one \u201cconvex hull\u201d for a geometric proof? E.g. if we draw all transactions separately in the feerate diagram instead of their chunks, could we use the approach you use in the <em>gathering theorem</em> to show that all possible subgroupings will always be below the convex hull?</p>\n</blockquote>\n</aside>\n<p>Let me think a bit more about that.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>Should this perhaps be restricted to topologically valid reorderings?</p>\n</blockquote>\n</aside>\n<p>Done.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>This should be \u201cin chunk <em>j</em> of <em>L</em>\u201d.</p>\n</blockquote>\n</aside>\n<p>Fixed.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>Maybe \u201call remaining transactions of <em>S</em> <em>after</em> the first <em>j</em> chunks of <em>L</em>\u201d would be clearer.</p>\n</blockquote>\n</aside>\n<p>Agreed, done.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>\u201cchoose an arbitrary but consistent <strong>way/approach/method/criteria/something</strong> to order them\u201d?</p>\n</blockquote>\n</aside>\n<p>I\u2019ve formalized this a bit more, selecting the ordering before the function definition.</p>\n<aside class=\"quote no-group\" data-username=\"murch\" data-post=\"2\" data-topic=\"202\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/murch/48/139_2.png\" class=\"avatar\"> murch:</div>\n<blockquote>\n<p>What do you mean with \u201chave connected components whose feerate is all the same\u201d? I assume you are referring to the optimal linearization consisting only of chunks that cannot be split further by reordering, i.e. that any valid reordering would not lead to a different chunking, but the \u201chave connected components whose feerate is all the same\u201d makes me think that you are postulating that there are two chunks with the same feerate.</p>\n</blockquote>\n</aside>\n<p>Consider the following cluster:</p>\n<pre data-code-height=\"234\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">graph BT\n   T0[\"B: 7\"] --&gt; T1;\n   T1[\"A: 1\"];\n   T2[\"D: 5\"] --&gt; T3;\n   T3[\"C: 3\"];\n   T4[\"E: 1\"] --&gt; T0;\n   T4 --&gt; T2;\n</code></pre>\n<ul>\n<li>The linearization [ACDBE] has chunking [ACDB,E]</li>\n<li>The linearization [ABCDE] has chunking [AB,CD,E]</li>\n</ul>\n<p>As defined so far, both linearizations are equivalent (because their diagram coincides), and optimal. Yet still, chunk ACDB contains two disconnected components. The point of this theorem is showing that in an optimal linearization, chunks are still not necessarily connected, but this is only possible if the connected components all have the same feerate (4 in this example).</p>\n<p>What I want to get to here, but haven\u2019t really fleshed out, is a stronger notion of optimality than defined so far, which also requires all chunks to be connected - and that every graph has such a very-optimal linearization too.</p>\n<p>Actually, now that you bring it up, I realize that\u2019s not as strong as we\u2019d want yet. Even with requiring connected chunks, it\u2019s still possible that optimal chunkings contain chunks with equal-feerate subsets, so I guess very-optimality should instead be \u201coptimal diagram, and chunks cannot contain topologically-valid strict subsets with equal feerate as the chunk itself\u201d or so?</p>",
  "post_number": 3,
  "post_type": 1,
  "updated_at": "2023-12-10T18:20:05.944Z",
  "reply_count": 1,
  "reply_to_post_number": 2,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 3,
  "readers_count": 2,
  "score": 5.6,
  "yours": false,
  "topic_id": 202,
  "topic_slug": "cluster-mempool-definitions-theory",
  "topic_title": "Cluster mempool definitions & theory",
  "topic_html_title": "Cluster mempool definitions &amp; theory",
  "category_id": 9,
  "display_username": "Pieter Wuille",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"murch, post:2, topic:202\"]\nI assume you are defining it on a graph so that you can have a chunking across multiple clusters\n[/quote]\n\nRight. I've added a paragraph to elaborate on why that is.\n\n[quote=\"murch, post:2, topic:202\"]\nit seems to me that this definition would only require that the topology is valid at the chunk borders and would not require the transactions to be topological *within the chunks*.\n[/quote]\n\nChunks, as defined here, are sets; they don't have an internal ordering. I've gone back and forth in my thinking whether sets or sequences are better. The advantage of sets is that at the chunking level, you don't need to care about distinct intra-chunk linearization orderings. The disadvantage is that converting back from chunkings to linearizations isn't as natural.\n\n[quote=\"murch, post:2, topic:202\"]\nWould it perhaps be sufficient that a feerate diagram has exactly one \u201cconvex hull\u201d for a geometric proof? E.g. if we draw all transactions separately in the feerate diagram instead of their chunks, could we use the approach you use in the *gathering theorem* to show that all possible subgroupings will always be below the convex hull?\n[/quote]\n\nLet me think a bit more about that.\n\n[quote=\"murch, post:2, topic:202\"]\nShould this perhaps be restricted to topologically valid reorderings?\n[/quote]\n\nDone.\n\n[quote=\"murch, post:2, topic:202\"]\nThis should be \u201cin chunk *j* of *L*\u201d.\n[/quote]\n\nFixed.\n\n[quote=\"murch, post:2, topic:202\"]\nMaybe \u201call remaining transactions of *S* *after* the first *j* chunks of *L*\u201d would be clearer.\n[/quote]\n\nAgreed, done.\n\n[quote=\"murch, post:2, topic:202\"]\n\u201cchoose an arbitrary but consistent **way/approach/method/criteria/something** to order them\u201d?\n[/quote]\n\nI've formalized this a bit more, selecting the ordering before the function definition.\n\n[quote=\"murch, post:2, topic:202\"]\nWhat do you mean with \u201chave connected components whose feerate is all the same\u201d? I assume you are referring to the optimal linearization consisting only of chunks that cannot be split further by reordering, i.e. that any valid reordering would not lead to a different chunking, but the \u201chave connected components whose feerate is all the same\u201d makes me think that you are postulating that there are two chunks with the same feerate.\n[/quote]\n\nConsider the following cluster:\n\n```mermaid height=234,auto\ngraph BT\n   T0[\"B: 7\"] --> T1;\n   T1[\"A: 1\"];\n   T2[\"D: 5\"] --> T3;\n   T3[\"C: 3\"];\n   T4[\"E: 1\"] --> T0;\n   T4 --> T2;\n```\n\n* The linearization [ACDBE] has chunking [ACDB,E]\n* The linearization [ABCDE] has chunking [AB,CD,E]\n\nAs defined so far, both linearizations are equivalent (because their diagram coincides), and optimal. Yet still, chunk ACDB contains two disconnected components. The point of this theorem is showing that in an optimal linearization, chunks are still not necessarily connected, but this is only possible if the connected components all have the same feerate (4 in this example).\n\nWhat I want to get to here, but haven't really fleshed out, is a stronger notion of optimality than defined so far, which also requires all chunks to be connected - and that every graph has such a very-optimal linearization too.\n\nActually, now that you bring it up, I realize that's not as strong as we'd want yet. Even with requiring connected chunks, it's still possible that optimal chunkings contain chunks with equal-feerate subsets, so I guess very-optimality should instead be \"optimal diagram, and chunks cannot contain topologically-valid strict subsets with equal feerate as the chunk itself\" or so?",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 96,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}