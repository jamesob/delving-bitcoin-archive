{
  "id": 6237,
  "name": "",
  "username": "nymius",
  "avatar_template": "/user_avatar/delvingbitcoin.org/nymius/{size}/884_2.png",
  "created_at": "2025-11-13T20:42:06.815Z",
  "cooked": "<p>I would like to resurrect this post to talk about silent payment spending, something that was left out of the currently proposed specifications, although initially mentioned.</p>\n<p>On PSBTs, when spending non silent payment outputs, one can rely on the <code>PSBT_IN_BIP32_DERIVATION</code> or any of the allowed <code>PSBT_IN_TAP_*</code> combinations available to get the right private keys to sign for each input.</p>\n<p>To spend silent payment outputs, one has to combine the private key with the tweak derived from the transaction corpus.</p>\n<p>Before proceeding with any specification, I would like to have a strong rationale for this.</p>\n<p>I\u2019ve been researching other related BIPs: 370 (PSBTv2), 371 (Taproot PSBT fields), 340 (Schnorr signatures) and 373 (MuSig2 PSBT Fields), and these are the relevant notes I considered:</p>\n<ul>\n<li>\n<p>It is possible to spend using a <code>PSBT_IN_PROPRIETARY</code> type, but BIP 352 is not tied to a single implementation, and different applications using the protocol may want to interoperate with each other. This approach is too brittle and will require synchronization, which may eventually (or initially as I\u2019m proposing here) involve specifying a new PSBT field.</p>\n</li>\n<li>\n<p><code>PSBT_IN_TAP_MERKLE_ROOT</code> field is the semantically closest to the purpose seek here, as it\u2019s also the input for a taproot tweak, but can\u2019t be used either because of the tagged hash used for tweaking: <em>TapTweak</em>.</p>\n<p>A change of the hash tag used for silent payments to <em>TapTweak</em> or something compatible with taproot tweaking is not impossible. It would not break domain compartmentalization, as the data from which each hash is computed is different.\nThere are also no concerns here in relation to change verification as silent payment change does not depend of any taproot tree.\nThe issue is it will require changes to the current BIP 352, which is not feasible, at least under this spec.\nOne unanswered question along this line of reasoning is why <code>PSBT_IN_TAP_MERKLE_ROOT</code> wasn\u2019t considered to be just a <code>PSBT_IN_TAP_TWEAK</code>? Including directly <code>hash(\"TapTweak\", &lt;pubkey&gt;, merkle_root&gt;)</code> into the PSBT.\nIf it would have been like this, adding silent payment tweaks would be trivial.\nAssuming the use of raw tweaks is not exclusive of the silent payment protocol, and that other protocols alike may need to create raw tweaks for their own purposes. If the intermediate tagged hash step is not a requirement, we may not need to scope the field just for silent payments.</p>\n</li>\n<li>\n<p>Spend public keys are 33 bytes, but by dropping the first byte it fits inside <code>PSBT_IN_TAP_INTERNAL_KEY</code> at the cost of having to check the matching with the public key before signing. The gain here would be to not have to add another field, or encode extra data into the field.</p>\n</li>\n</ul>\n<p>Any ideas or corrections on this matter?</p>",
  "post_number": 31,
  "post_type": 1,
  "posts_count": 29,
  "updated_at": "2025-11-13T20:42:06.815Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 0.8,
  "yours": false,
  "topic_id": 877,
  "topic_slug": "bip352-psbt-support",
  "topic_title": "BIP352: PSBT support",
  "topic_html_title": "BIP352: PSBT support",
  "category_id": 12,
  "display_username": "",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "I would like to resurrect this post to talk about silent payment spending, something that was left out of the currently proposed specifications, although initially mentioned.\n\nOn PSBTs, when spending non silent payment outputs, one can rely on the `PSBT_IN_BIP32_DERIVATION` or any of the allowed `PSBT_IN_TAP_*` combinations available to get the right private keys to sign for each input.\n\nTo spend silent payment outputs, one has to combine the private key with the tweak derived from the transaction corpus.\n\nBefore proceeding with any specification, I would like to have a strong rationale for this.\n\nI\u2019ve been researching other related BIPs: 370 (PSBTv2), 371 (Taproot PSBT fields), 340 (Schnorr signatures) and 373 (MuSig2 PSBT Fields), and these are the relevant notes I considered:\n\n* It is possible to spend using a `PSBT_IN_PROPRIETARY` type, but BIP 352 is not tied to a single implementation, and different applications using the protocol may want to interoperate with each other. This approach is too brittle and will require synchronization, which may eventually (or initially as I\u2019m proposing here) involve specifying a new PSBT field.\n\n* `PSBT_IN_TAP_MERKLE_ROOT` field is the semantically closest to the purpose seek here, as it\u2019s also the input for a taproot tweak, but can\u2019t be used either because of the tagged hash used for tweaking: *TapTweak*.\n\n  A change of the hash tag used for silent payments to *TapTweak* or something compatible with taproot tweaking is not impossible. It would not break domain compartmentalization, as the data from which each hash is computed is different.\n  There are also no concerns here in relation to change verification as silent payment change does not depend of any taproot tree.\n  The issue is it will require changes to the current BIP 352, which is not feasible, at least under this spec.\n  One unanswered question along this line of reasoning is why `PSBT_IN_TAP_MERKLE_ROOT` wasn\u2019t considered to be just a `PSBT_IN_TAP_TWEAK`? Including directly `hash(\"TapTweak\", <pubkey>, merkle_root>)` into the PSBT.\n  If it would have been like this, adding silent payment tweaks would be trivial.\n  Assuming the use of raw tweaks is not exclusive of the silent payment protocol, and that other protocols alike may need to create raw tweaks for their own purposes. If the intermediate tagged hash step is not a requirement, we may not need to scope the field just for silent payments.\n\n* Spend public keys are 33 bytes, but by dropping the first byte it fits inside `PSBT_IN_TAP_INTERNAL_KEY` at the cost of having to check the matching with the public key before signing. The gain here would be to not have to add another field, or encode extra data into the field.\n\nAny ideas or corrections on this matter?",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 595,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I would like to resurrect this post to talk about silent payment spending, something that was left out of the currently proposed specifications, although initially mentioned. \nOn PSBTs, when spending non silent payment outputs, one can rely on the PSBT_IN_BIP32_DERIVATION or any of the allowed PSBT_&hellip;",
  "truncated": true,
  "post_url": "/t/bip352-psbt-support/877/31",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}