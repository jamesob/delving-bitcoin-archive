{
  "id": 6378,
  "name": "Matt Morehouse",
  "username": "morehouse",
  "avatar_template": "/letter_avatar_proxy/v4/letter/m/df705f/{size}.png",
  "created_at": "2025-12-04T20:02:58.406Z",
  "cooked": "<p>One denial-of-service and two theft-of-funds vulnerabilities were fixed in LND 0.19.0.  Users should immediately upgrade to <a href=\"https://github.com/lightningnetwork/lnd/releases/tag/v0.19.0-beta\" rel=\"noopener nofollow ugc\">LND 0.19.0</a> or later protect their funds.</p>\n<h2><a name=\"p-6378-the-infinite-inbox-dos-1\" class=\"anchor\" href=\"#p-6378-the-infinite-inbox-dos-1\"></a>The Infinite Inbox DoS</h2>\n<p>Large internal queue sizes and an unrestricted incoming connection policy enabled attackers to quickly exhaust LND\u2019s available memory and cause it to crash or hang.</p>\n<p>More details are provided in the corresponding <a href=\"https://morehouse.github.io/lightning/lnd-infinite-inbox-dos/\" rel=\"noopener nofollow ugc\">blog post</a>.</p>\n<h2><a name=\"p-6378-the-excessive-failback-exploit-2-2\" class=\"anchor\" href=\"#p-6378-the-excessive-failback-exploit-2-2\"></a>The Excessive Failback Exploit <span class=\"hashtag-raw\">#2</span></h2>\n<p>A variant of the <a href=\"https://delvingbitcoin.org/t/disclosure-lnd-excessive-failback-exploit/1493\">previously disclosed</a> excessive failback bug could still be exploited to steal funds from LND nodes.  The variant was discovered while drafting an <a href=\"https://github.com/lightning/bolts/pull/1233\" rel=\"noopener nofollow ugc\">update</a> to BOLT 5 that was intended to help prevent similar vulnerabilities in the future.</p>\n<p>More details are provided in the corresponding <a href=\"https://morehouse.github.io/lightning/lnd-excessive-failback-exploit-2/\" rel=\"noopener nofollow ugc\">blog post</a>.</p>\n<h2><a name=\"p-6378-the-replacement-stalling-attack-3\" class=\"anchor\" href=\"#p-6378-the-replacement-stalling-attack-3\"></a>The Replacement Stalling Attack</h2>\n<p>Weaknesses in LND\u2019s sweeper system enabled an attacker to stall LND\u2019s attempts at claiming expired HTLCs on chain.  After stalling for 80 blocks, the attacker could steal essentially the entire channel balance.  This vulnerability was discovered during code review of LND\u2019s sweeper rewrite in 2024.</p>\n<p>More details are provided in the corresponding <a href=\"https://morehouse.github.io/lightning/lnd-replacement-stalling-attack/\" rel=\"noopener nofollow ugc\">blog post</a>.</p>",
  "post_number": 1,
  "post_type": 1,
  "posts_count": 6,
  "updated_at": "2025-12-04T20:02:58.406Z",
  "reply_count": 1,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 117,
  "reads": 51,
  "readers_count": 50,
  "score": 700.2,
  "yours": false,
  "topic_id": 2145,
  "topic_slug": "disclosure-critical-vulnerabilities-fixed-in-lnd-0-19-0",
  "topic_title": "Disclosure: Critical vulnerabilities fixed in LND 0.19.0",
  "topic_html_title": "Disclosure: Critical vulnerabilities fixed in LND 0.19.0",
  "category_id": 8,
  "display_username": "Matt Morehouse",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "One denial-of-service and two theft-of-funds vulnerabilities were fixed in LND 0.19.0.  Users should immediately upgrade to [LND 0.19.0](https://github.com/lightningnetwork/lnd/releases/tag/v0.19.0-beta) or later protect their funds.\n\n## The Infinite Inbox DoS\n\nLarge internal queue sizes and an unrestricted incoming connection policy enabled attackers to quickly exhaust LND's available memory and cause it to crash or hang.\n\nMore details are provided in the corresponding [blog post](https://morehouse.github.io/lightning/lnd-infinite-inbox-dos/).\n\n##  The Excessive Failback Exploit #2\n\nA variant of the [previously disclosed](https://delvingbitcoin.org/t/disclosure-lnd-excessive-failback-exploit/1493) excessive failback bug could still be exploited to steal funds from LND nodes.  The variant was discovered while drafting an [update](https://github.com/lightning/bolts/pull/1233) to BOLT 5 that was intended to help prevent similar vulnerabilities in the future.\n\nMore details are provided in the corresponding [blog post](https://morehouse.github.io/lightning/lnd-excessive-failback-exploit-2/).\n\n## The Replacement Stalling Attack\n\nWeaknesses in LND's sweeper system enabled an attacker to stall LND's attempts at claiming expired HTLCs on chain.  After stalling for 80 blocks, the attacker could steal essentially the entire channel balance.  This vulnerability was discovered during code review of LND's sweeper rewrite in 2024.\n\nMore details are provided in the corresponding [blog post](https://morehouse.github.io/lightning/lnd-replacement-stalling-attack/).",
  "actions_summary": [
    {
      "id": 2,
      "count": 7
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 47,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "One denial-of-service and two theft-of-funds vulnerabilities were fixed in LND 0.19.0.  Users should immediately upgrade to <a href=\"https://github.com/lightningnetwork/lnd/releases/tag/v0.19.0-beta\" rel=\"noopener nofollow ugc\">LND 0.19.0</a> or later protect their funds. \n<a name=\"p-6378-the-infinite-inbox-dos-1\" class=\"anchor\" href=\"#p-6378-the-infinite-inbox-dos-1\"></a>The Infinite Inbox DoS\nLarge internal queue sizes and an unrestricted incoming connection policy enabled attackers to quickly exhaust &hellip;",
  "truncated": true,
  "post_url": "/t/disclosure-critical-vulnerabilities-fixed-in-lnd-0-19-0/2145/1",
  "reactions": [
    {
      "id": "heart",
      "type": "emoji",
      "count": 5
    },
    {
      "id": "+1",
      "type": "emoji",
      "count": 2
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 7,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null,
  "can_vote": false
}