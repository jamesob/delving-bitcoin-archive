{
  "id": 6441,
  "name": "Jonathan Harvey-Buschel",
  "username": "jonhbit",
  "avatar_template": "/user_avatar/delvingbitcoin.org/jonhbit/{size}/1661_2.png",
  "created_at": "2025-12-16T16:41:03.140Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"rustyrussell\" data-post=\"14\" data-topic=\"2105\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/rustyrussell/48/154_2.png\" class=\"avatar\"> rustyrussell:</div>\n<blockquote>\n<p>How about:</p>\n<ol>\n<li>Send a sketch every 60 seconds.  You may reduce the set before sending.</li>\n<li>If you receive a sketch you can decode, simply reply with any messages the sender is missing.</li>\n<li>If you can\u2019t decode:\n<ol>\n<li>If they are on a different blockheight, ignore.</li>\n<li>If you can send a larger set, do so next time.</li>\n<li>If you have other peers, wait until you get more failures.</li>\n<li>If they have much less gossip than you, start streaming gossip.</li>\n<li>Otherwise, something is wrong, query them for everything (or if you don\u2019t have a channel with them, ignore?).</li>\n</ol>\n</li>\n</ol>\n<p>I don\u2019t really think a query protocol is needed.</p>\n</blockquote>\n</aside>\n<p>Another argument against point 2 / not having some message like GETDATA for requesting message contents, is that you may end up receiving the same message multiple times from multiple peers. I still agree that querying for sketches is not needed; I\u2019m referring to how the full message is sent.</p>\n<p>For example, if 2 of my 5 peers have a message that I\u2019m missing, and I send both peers a sketch built from a set missing that message, they would both end up sending me the missing message, and we\u2019ve wasted some bandwidth. If I have to request the message data, I can choose the peer to request from, and request exactly once.</p>\n<p>Turns out this was proposed a while ago <img src=\"https://delvingbitcoin.org/images/emoji/twitter/sweat_smile.png?v=14\" title=\":sweat_smile:\" class=\"emoji\" alt=\":sweat_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> <a href=\"https://github.com/lightning/bolts/pull/584\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">[WIP] BOLT 7: Inventory-based gossip by sstone \u00b7 Pull Request #584 \u00b7 lightning/bolts \u00b7 GitHub</a> I\u2019m not sure why it got dropped / deprioritized back then in 2020.</p>\n<p>To be fair, I think the bandwidth overhead of the \u2018push\u2019 version where you send missing messages to your peer should decrease as the reconciliation interval decreases. Which we may want to do for other reasons like keeping the expected set difference small.</p>",
  "post_number": 19,
  "post_type": 1,
  "posts_count": 20,
  "updated_at": "2025-12-16T16:52:48.693Z",
  "reply_count": 1,
  "reply_to_post_number": 14,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 15,
  "readers_count": 14,
  "score": 8.0,
  "yours": false,
  "topic_id": 2105,
  "topic_slug": "gossip-observer-new-project-to-monitor-the-lightning-p2p-network",
  "topic_title": "Gossip Observer: New project to monitor the Lightning P2P network",
  "topic_html_title": "Gossip Observer: New project to monitor the Lightning P2P network",
  "category_id": 7,
  "display_username": "Jonathan Harvey-Buschel",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"rustyrussell, post:14, topic:2105, full:true\"]\nHow about:\n\n1. Send a sketch every 60 seconds.  You may reduce the set before sending.\n2. If you receive a sketch you can decode, simply reply with any messages the sender is missing.\n3. If you can\u2019t decode:\n   1. If they are on a different blockheight, ignore.\n   2. If you can send a larger set, do so next time.\n   3. If you have other peers, wait until you get more failures.\n   4. If they have much less gossip than you, start streaming gossip.\n   5. Otherwise, something is wrong, query them for everything (or if you don\u2019t have a channel with them, ignore?).\n\n\nI don\u2019t really think a query protocol is needed.\n[/quote]\n\nAnother argument against point 2 / not having some message like GETDATA for requesting message contents, is that you may end up receiving the same message multiple times from multiple peers. I still agree that querying for sketches is not needed; I'm referring to how the full message is sent.\n\nFor example, if 2 of my 5 peers have a message that I'm missing, and I send both peers a sketch built from a set missing that message, they would both end up sending me the missing message, and we've wasted some bandwidth. If I have to request the message data, I can choose the peer to request from, and request exactly once.\n\nTurns out this was proposed a while ago :sweat_smile: https://github.com/lightning/bolts/pull/584 I'm not sure why it got dropped / deprioritized back then in 2020.\n\nTo be fair, I think the bandwidth overhead of the 'push' version where you send missing messages to your peer should decrease as the reconciliation interval decreases. Which we may want to do for other reasons like keeping the expected set difference small.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 982,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Another argument against point 2 / not having some message like GETDATA for requesting message contents, is that you may end up receiving the same message multiple times from multiple peers. I still agree that querying for sketches is not needed; I\u2019m referring to how the full message is sent. \nFor &hellip;",
  "truncated": true,
  "post_url": "/t/gossip-observer-new-project-to-monitor-the-lightning-p2p-network/2105/19",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}