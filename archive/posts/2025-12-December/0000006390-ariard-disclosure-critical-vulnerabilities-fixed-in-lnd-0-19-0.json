{
  "id": 6390,
  "name": "Antoine Riard",
  "username": "ariard",
  "avatar_template": "/letter_avatar_proxy/v4/letter/a/c67d28/{size}.png",
  "created_at": "2025-12-06T01:25:56.514Z",
  "cooked": "<p>Thanks for the disclosures \u2013 Browsed over the Replacement Stalling Attacks one, if my memory is correct on this subject, I think Bastien Teinturier was the first back in 2021 sharing with few lightning devs the idea of \u201ccat-and-mouse\u201d attacks, i,e adversarially aggregating and disaggregating <code>option_anchors</code> second-stage HTLCs transactions. Sounds what you found is one variant of those \u201ccat-and-mouse\u201d attacks, but this is nothing very specific to LND.</p>\n<p>About disclosure timeline, 90-days is generally the basic infosec embargo timeline. It can be a bit dry, assuming it\u2019s a \u201csimple\u201d bug that can be fixed solely by the implementation (so no cross-layer vulnerability), letting a 4-6 months sounds more generous and in line with the usual release cycles of Lightning implementations. It\u2019s really depends on the type of vulnerability, however the drawback with an isolated release with only 2 or 3 lines of changelog, with one altering some critical code paths, is to make it too much obvious there is \u201ccovert fix\u201d somewhere and lowering the bar for any external actor to know what to look for to reverse-engineer.</p>\n<p>On all the logic area you\u2019re pointing you, i.e claimable outputs detection, generation of claims transactions, fee selection and scheduled rebroadcast of the claims of transactions, it has been floated few times the idea, at least since 2020, to write a specific BOLT encompassing all this flow with the do and don\u2019t. While there is no necessity at all of inter-compatibility among the Lightning implementations on logic, despite being one of the most critical area for channels funds security, somehow Lightning implementations kept put one\u2019s foot in one\u2019s mouth on this flow. An (incomplete) <a href=\"https://github.com/discreetlogcontracts/dlcspecs/blob/9cd9148938c616690c79d99ec6f330e213c246c5/Non-Interactive-Protocol.md\" rel=\"noopener nofollow ugc\">experience</a> has been attempted for the DLC spec on what such piece of recommendations can cover.</p>\n<p>Otherwise, we can also keep eating popcorns and making laughs of Lightning implementations being insecure again and again on their on-chain logic management.</p>",
  "post_number": 5,
  "post_type": 1,
  "posts_count": 6,
  "updated_at": "2025-12-06T01:31:02.473Z",
  "reply_count": 1,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 1,
  "reads": 40,
  "readers_count": 39,
  "score": 33.0,
  "yours": false,
  "topic_id": 2145,
  "topic_slug": "disclosure-critical-vulnerabilities-fixed-in-lnd-0-19-0",
  "topic_title": "Disclosure: Critical vulnerabilities fixed in LND 0.19.0",
  "topic_html_title": "Disclosure: Critical vulnerabilities fixed in LND 0.19.0",
  "category_id": 8,
  "display_username": "Antoine Riard",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Thanks for the disclosures \u2013 Browsed over the Replacement Stalling Attacks one, if my memory is correct on this subject, I think Bastien Teinturier was the first back in 2021 sharing with few lightning devs the idea of \u201ccat-and-mouse\u201d attacks, i,e adversarially aggregating and disaggregating `option_anchors` second-stage HTLCs transactions. Sounds what you found is one variant of those \u201ccat-and-mouse\u201d attacks, but this is nothing very specific to LND.\n\nAbout disclosure timeline, 90-days is generally the basic infosec embargo timeline. It can be a bit dry, assuming it\u2019s a \u201csimple\u201d bug that can be fixed solely by the implementation (so no cross-layer vulnerability), letting a 4-6 months sounds more generous and in line with the usual release cycles of Lightning implementations. It\u2019s really depends on the type of vulnerability, however the drawback with an isolated release with only 2 or 3 lines of changelog, with one altering some critical code paths, is to make it too much obvious there is \u201ccovert fix\u201d somewhere and lowering the bar for any external actor to know what to look for to reverse-engineer.\n\nOn all the logic area you\u2019re pointing you, i.e claimable outputs detection, generation of claims transactions, fee selection and scheduled rebroadcast of the claims of transactions, it has been floated few times the idea, at least since 2020, to write a specific BOLT encompassing all this flow with the do and don\u2019t. While there is no necessity at all of inter-compatibility among the Lightning implementations on logic, despite being one of the most critical area for channels funds security, somehow Lightning implementations kept put one\u2019s foot in one\u2019s mouth on this flow. An (incomplete) [experience](https://github.com/discreetlogcontracts/dlcspecs/blob/9cd9148938c616690c79d99ec6f330e213c246c5/Non-Interactive-Protocol.md) has been attempted for the DLC spec on what such piece of recommendations can cover.\n\nOtherwise, we can also keep eating popcorns and making laughs of Lightning implementations being insecure again and again on their on-chain logic management.",
  "actions_summary": [
    {
      "id": 2,
      "count": 1
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 5,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": "Github link was replaced with a permanent link",
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Thanks for the disclosures \u2013 Browsed over the Replacement Stalling Attacks one, if my memory is correct on this subject, I think Bastien Teinturier was the first back in 2021 sharing with few lightning devs the idea of \u201ccat-and-mouse\u201d attacks, i,e adversarially aggregating and disaggregating option_&hellip;",
  "truncated": true,
  "post_url": "/t/disclosure-critical-vulnerabilities-fixed-in-lnd-0-19-0/2145/5",
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 1,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}