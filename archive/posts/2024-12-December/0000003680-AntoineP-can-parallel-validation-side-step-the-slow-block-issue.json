{
  "id": 3680,
  "name": "Antoine Poinsot",
  "username": "AntoineP",
  "avatar_template": "/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png",
  "created_at": "2024-12-02T18:23:17.666Z",
  "cooked": "<p>Unfortunately not.</p>\n<p>When presented a block a miner has the choice to mine on top of it or keep mining on the previous tip.</p>\n<ul>\n<li>If the block is valid, it\u2019s in his best interest (and the network\u2019s) to mine on top of it [0].</li>\n<li>If the block is invalid, it\u2019s in his best interest (and the network\u2019s) to mine on top of the previous tip.</li>\n</ul>\n<p>However this is assuming the miner knows instantly whether the block is valid. Until he knows the validity of the block the miner only has two poor choices: keep mining on a likely outdated tip or take the risk of mining on top of a potentially invalid block.</p>\n<p>It seems likely that a miner would prefer the first option, by assuming mining on the old tip is wasted anyways and that a miner wouldn\u2019t waste a valid PoW on an invalid block. This is also <a href=\"https://bitcoin.stackexchange.com/q/38437/101498\">what we observe(d)</a> in practice.</p>\n<p>The idea you present involves 1) a miner being presented a block, figuring out it\u2019s expensive to validate, discarding it, and instead continuing to mine on top of the old tip to then 2) find a normal block at the same height before other miners are done validating the expensive one and 3) other miners being presented with this normal block to start building on top of it in place of the competing expensive block.</p>\n<p>Besides all the issues that may be created by implementing 3) and the low likelihood of 2), i don\u2019t think we can reasonably expect 1) to happen in the first place. A minority miner does not want to discard a potentially-valid block.</p>\n<p>It is also possible, although improbable, that a race between a normal and an expensive block could also happen naturally, but in this case the expensive block is already at a severe disadvantage due to how its propagation is hindered. In this case having miners who received the expensive block first also validate the normal block in parallel would further disadvantage the expensive block. But this is only a marginal improvement in an unlikely scenario, at the cost of high implementation complexity.</p>\n<p>Finally i\u2019d like to point out there is a third option for miners when presented a block that is potentially expensive to validate: just stop mining until you are done validating. This is unfortunate for the network. When miners distrust each other this is also more rationale than wasting electricity mining on a potentially outdated tip or a potentially invalid block. Unfortunately what i expect instead is that miners would build tighter trust relationship to reduce their risk of SPV mining. In this sense expensive block validation is an additional mining centralization pressure which i think we should mitigate by bounding the maximum block validation time.</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p>And with every future soft fork we need to deeply worry about block validation time.</p>\n</blockquote>\n</aside>\n<p>In any case we always do need to deeply worry about how a new feature may impact block validation time?</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p><strong>It would be really nice if we can make slow blocks a problem only for the miner who produced one.</strong></p>\n</blockquote>\n</aside>\n<p>Note that even if this resolved the attack against other miners this would also be a concern, in the sense that it would be a new dimension to optimize for when building a block template.</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p>Does the large miner advantage stay in place even if their blocks are at increased risk of reorg?</p>\n</blockquote>\n</aside>\n<p>The attacker does not need to be large, although this could degenerate in a race to the bottom where large miners eventually benefit. But i think the race to the bottom scenario is unlikely if the attack necessitates a large number of preparation blocks.</p>\n<p>That said as discussed previously i don\u2019t think your idea makes it so their blocks are at a higher risk of reorg.</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p>If miners typically run higher end hardware for their node, does that mean slow blocks propagate just fine between miners, with the other nodes in the network being out of the loop?</p>\n</blockquote>\n</aside>\n<p>If \u201cminers\u201d is a group of tightly interconnected nodes, it means expensive blocks relay faster (not \u201cjust fine\u201d though <img src=\"https://delvingbitcoin.org/images/emoji/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\">) between them. But i don\u2019t think we can assume such a network topology.</p>\n<p>Also an attacker exploiting this would probably want to directly connect to as much of his competition as he can.</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p>Does it create an incentive for miners who trust each other (or collude) to skip validation so they always build on the first-seen block, ignoring a fast-to-validate competitor block?</p>\n</blockquote>\n</aside>\n<p>I think it is a likely outcome, yes. Along with (further) tightening of trust relationship between miners to edge their risk of doing this, as discussed above.</p>\n<aside class=\"quote no-group\" data-username=\"sjors\" data-post=\"1\" data-topic=\"1288\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/sjors/48/59_2.png\" class=\"avatar\"> sjors:</div>\n<blockquote>\n<p>Does this accidentally introduce an incentive to produce empty blocks?</p>\n</blockquote>\n</aside>\n<p>Empty blocks are a symptom of SPV mining due to propagation time. If the miner is stalled due to validation time he already has the full block and therefore can include transactions in his template.</p>\n<p>In passing, the fact miners are SPV mining due to propagation time, which are tiny compared to the potential validation times we are talking about, confirms we should be concerned expensive blocks would significantly incentivize them to skip full validation / collude.</p>\n<hr>\n<p>[0] As long as the miner doesn\u2019t have more than 50% of the hashrate of course.</p>",
  "post_number": 11,
  "post_type": 1,
  "updated_at": "2024-12-02T18:23:17.666Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 0.8,
  "yours": false,
  "topic_id": 1288,
  "topic_slug": "can-parallel-validation-side-step-the-slow-block-issue",
  "topic_title": "Can parallel validation side-step the slow block issue?",
  "topic_html_title": "Can parallel validation side-step the slow block issue?",
  "category_id": 7,
  "display_username": "Antoine Poinsot",
  "primary_group_name": null,
  "flair_name": "wg-consensus-cleanup",
  "flair_url": "/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png",
  "flair_bg_color": "",
  "flair_color": "",
  "flair_group_id": 43,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": "Regular",
  "title_is_group": false,
  "bookmarked": false,
  "raw": "Unfortunately not.\n\nWhen presented a block a miner has the choice to mine on top of it or keep mining on the previous tip.\n- If the block is valid, it's in his best interest (and the network's) to mine on top of it \\[0].\n- If the block is invalid, it's in his best interest (and the network's) to mine on top of the previous tip.\n\nHowever this is assuming the miner knows instantly whether the block is valid. Until he knows the validity of the block the miner only has two poor choices: keep mining on a likely outdated tip or take the risk of mining on top of a potentially invalid block.\n\nIt seems likely that a miner would prefer the first option, by assuming mining on the old tip is wasted anyways and that a miner wouldn't waste a valid PoW on an invalid block. This is also [what we observe(d)](https://bitcoin.stackexchange.com/q/38437/101498) in practice.\n\nThe idea you present involves 1) a miner being presented a block, figuring out it's expensive to validate, discarding it, and instead continuing to mine on top of the old tip to then 2) find a normal block at the same height before other miners are done validating the expensive one and 3) other miners being presented with this normal block to start building on top of it in place of the competing expensive block.\n\nBesides all the issues that may be created by implementing 3) and the low likelihood of 2), i don't think we can reasonably expect 1) to happen in the first place. A minority miner does not want to discard a potentially-valid block.\n\nIt is also possible, although improbable, that a race between a normal and an expensive block could also happen naturally, but in this case the expensive block is already at a severe disadvantage due to how its propagation is hindered. In this case having miners who received the expensive block first also validate the normal block in parallel would further disadvantage the expensive block. But this is only a marginal improvement in an unlikely scenario, at the cost of high implementation complexity.\n\nFinally i'd like to point out there is a third option for miners when presented a block that is potentially expensive to validate: just stop mining until you are done validating. This is unfortunate for the network. When miners distrust each other this is also more rationale than wasting electricity mining on a potentially outdated tip or a potentially invalid block. Unfortunately what i expect instead is that miners would build tighter trust relationship to reduce their risk of SPV mining. In this sense expensive block validation is an additional mining centralization pressure which i think we should mitigate by bounding the maximum block validation time.\n\n[quote=\"sjors, post:1, topic:1288\"]\nAnd with every future soft fork we need to deeply worry about block validation time.\n[/quote]\n\nIn any case we always do need to deeply worry about how a new feature may impact block validation time?\n\n[quote=\"sjors, post:1, topic:1288\"]\n**It would be really nice if we can make slow blocks a problem only for the miner who produced one.**\n[/quote]\n\nNote that even if this resolved the attack against other miners this would also be a concern, in the sense that it would be a new dimension to optimize for when building a block template.\n\n[quote=\"sjors, post:1, topic:1288\"]\nDoes the large miner advantage stay in place even if their blocks are at increased risk of reorg?\n[/quote]\n\nThe attacker does not need to be large, although this could degenerate in a race to the bottom where large miners eventually benefit. But i think the race to the bottom scenario is unlikely if the attack necessitates a large number of preparation blocks.\n\nThat said as discussed previously i don't think your idea makes it so their blocks are at a higher risk of reorg.\n\n[quote=\"sjors, post:1, topic:1288\"]\nIf miners typically run higher end hardware for their node, does that mean slow blocks propagate just fine between miners, with the other nodes in the network being out of the loop?\n[/quote]\n\nIf \"miners\" is a group of tightly interconnected nodes, it means expensive blocks relay faster (not \"just fine\" though :slight_smile:) between them. But i don't think we can assume such a network topology.\n\nAlso an attacker exploiting this would probably want to directly connect to as much of his competition as he can.\n\n[quote=\"sjors, post:1, topic:1288\"]\nDoes it create an incentive for miners who trust each other (or collude) to skip validation so they always build on the first-seen block, ignoring a fast-to-validate competitor block?\n[/quote]\n\nI think it is a likely outcome, yes. Along with (further) tightening of trust relationship between miners to edge their risk of doing this, as discussed above.\n\n[quote=\"sjors, post:1, topic:1288\"]\nDoes this accidentally introduce an incentive to produce empty blocks?\n[/quote]\n\nEmpty blocks are a symptom of SPV mining due to propagation time. If the miner is stalled due to validation time he already has the full block and therefore can include transactions in his template.\n\nIn passing, the fact miners are SPV mining due to propagation time, which are tiny compared to the potential validation times we are talking about, confirms we should be concerned expensive blocks would significantly incentivize them to skip full validation / collude.\n\n\n----\n\n\\[0] As long as the miner doesn't have more than 50% of the hashrate of course.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 12,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}