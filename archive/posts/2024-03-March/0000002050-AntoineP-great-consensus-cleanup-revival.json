{
  "id": 2050,
  "name": "Antoine Poinsot",
  "username": "AntoineP",
  "avatar_template": "/letter_avatar_proxy/v4/letter/a/8e8cbc/{size}.png",
  "created_at": "2024-03-26T23:31:32.536Z",
  "cooked": "<p>To expand on the coinbase uniqueness fix. Technically, only coinbase transactions before height 227,931 may be duplicated. Among these, only those whose first element is a minimal <code>CScriptNum</code> push of a height &gt; 227,931 can effectively be [0]. Therefore an argument can be made in favour of reducing the risk of for miners to a minimum by only requiring a witness commitment at the heights which were committed to in these early coinbase transactions.</p>\n<p>I don\u2019t think it is worth the complexity. This would need a mechanism to keep track of those heights. And i think the risk of implementing this mechanism outweights the risk of a miner mining an invalid block 21 years from now because he didn\u2019t update his software. (21 years because this is not needed before after block height 1,983,702.)</p>\n<p>Still, it\u2019s interesting to see what future blocks could have a duplicate coinbase. To this end i\u2019ve scanned the 227,931 first blocks of the chain. I\u2019m counting 189,023 coinbase transactions which <em>could</em> (this disregards [0]) be duplicated without violating BIP34. I count 10 before block 5,000,000 (about 100 years from now), 24 before block 10,000,000 and 80 before block 100,000,000.</p>\n<p>Here is the 24 ones before block 10,000,000:</p>\n<div class=\"md-table\">\n<table>\n<thead>\n<tr>\n<th>Original block height</th>\n<th>duplicable block height</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>147,396</td>\n<td>8,624,845</td>\n</tr>\n<tr>\n<td>149,732</td>\n<td>8,631,390</td>\n</tr>\n<tr>\n<td>149,813</td>\n<td>8,631,629</td>\n</tr>\n<tr>\n<td>149,838</td>\n<td>8,631,693</td>\n</tr>\n<tr>\n<td>150,283</td>\n<td>8,632,995</td>\n</tr>\n<tr>\n<td>151,491</td>\n<td>8,636,474</td>\n</tr>\n<tr>\n<td>152,374</td>\n<td>8,638,716</td>\n</tr>\n<tr>\n<td>152,599</td>\n<td>8,639,231</td>\n</tr>\n<tr>\n<td>153,662</td>\n<td>8,641,929</td>\n</tr>\n<tr>\n<td>164,384</td>\n<td>1,983,702</td>\n</tr>\n<tr>\n<td>169,895</td>\n<td>3,708,179</td>\n</tr>\n<tr>\n<td>170,307</td>\n<td>3,709,183</td>\n</tr>\n<tr>\n<td>171,896</td>\n<td>3,712,990</td>\n</tr>\n<tr>\n<td>172,069</td>\n<td>3,713,413</td>\n</tr>\n<tr>\n<td>172,357</td>\n<td>3,714,082</td>\n</tr>\n<tr>\n<td>172,428</td>\n<td>3,714,265</td>\n</tr>\n<tr>\n<td>174,151</td>\n<td>5,208,854</td>\n</tr>\n<tr>\n<td>176,684</td>\n<td>490,897</td>\n</tr>\n<tr>\n<td>177,628</td>\n<td>9,558,101</td>\n</tr>\n<tr>\n<td>183,669</td>\n<td>3,761,471</td>\n</tr>\n<tr>\n<td>196,988</td>\n<td>4,275,806</td>\n</tr>\n<tr>\n<td>201,577</td>\n<td>5,327,833</td>\n</tr>\n<tr>\n<td>206,039</td>\n<td>7,299,941</td>\n</tr>\n<tr>\n<td>206,354</td>\n<td>7,299,941</td>\n</tr>\n</tbody>\n</table>\n</div><p>For the curious, <a href=\"https://gist.github.com/darosior/3a5ac0a8d935fa9d3e90310590ca6699\">here</a> is the full list of all the potential future violations.</p>\n<hr>\n<p>[0] And even then only those which weren\u2019t spent in a transaction which also indirectly spends a non-duplicable coinbase can in practice lead to a BIP30 violation.</p>",
  "post_number": 4,
  "post_type": 1,
  "updated_at": "2024-03-26T23:31:32.536Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 6,
  "readers_count": 5,
  "score": 1.2,
  "yours": false,
  "topic_id": 710,
  "topic_slug": "great-consensus-cleanup-revival",
  "topic_title": "Great Consensus Cleanup Revival",
  "topic_html_title": "Great Consensus Cleanup Revival",
  "category_id": 7,
  "display_username": "Antoine Poinsot",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "To expand on the coinbase uniqueness fix. Technically, only coinbase transactions before height 227,931 may be duplicated. Among these, only those whose first element is a minimal `CScriptNum` push of a height > 227,931 can effectively be [0]. Therefore an argument can be made in favour of reducing the risk of for miners to a minimum by only requiring a witness commitment at the heights which were committed to in these early coinbase transactions.\n\nI don't think it is worth the complexity. This would need a mechanism to keep track of those heights. And i think the risk of implementing this mechanism outweights the risk of a miner mining an invalid block 21 years from now because he didn't update his software. (21 years because this is not needed before after block height 1,983,702.)\n\nStill, it's interesting to see what future blocks could have a duplicate coinbase. To this end i've scanned the 227,931 first blocks of the chain. I'm counting 189,023 coinbase transactions which *could* (this disregards [0]) be duplicated without violating BIP34. I count 10 before block 5,000,000 (about 100 years from now), 24 before block 10,000,000 and 80 before block 100,000,000.\n\nHere is the 24 ones before block 10,000,000:\n\n| Original block height | duplicable block height |\n| ----------------------------| ------------------------------ |\n| 147,396 | 8,624,845 |\n| 149,732 | 8,631,390 |\n| 149,813 | 8,631,629 |\n| 149,838 | 8,631,693 |\n| 150,283 | 8,632,995 |\n| 151,491 | 8,636,474 |\n| 152,374 | 8,638,716 |\n| 152,599 | 8,639,231 |\n| 153,662 | 8,641,929 |\n| 164,384 | 1,983,702 |\n| 169,895 | 3,708,179 |\n| 170,307 | 3,709,183 |\n| 171,896 | 3,712,990 |\n| 172,069 | 3,713,413 |\n| 172,357 | 3,714,082 |\n| 172,428 | 3,714,265 |\n| 174,151 | 5,208,854 |\n| 176,684 | 490,897 |\n| 177,628 | 9,558,101 |\n| 183,669 | 3,761,471 |\n| 196,988 | 4,275,806 |\n| 201,577 | 5,327,833 |\n| 206,039 | 7,299,941 |\n| 206,354 | 7,299,941 |\n\nFor the curious, [here](https://gist.github.com/darosior/3a5ac0a8d935fa9d3e90310590ca6699) is the full list of all the potential future violations.\n\n---\n\n[0] And even then only those which weren't spent in a transaction which also indirectly spends a non-duplicable coinbase can in practice lead to a BIP30 violation.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 12,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}