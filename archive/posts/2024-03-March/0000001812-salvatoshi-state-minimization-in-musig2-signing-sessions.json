{
  "id": 1812,
  "name": "salvatoshi",
  "username": "salvatoshi",
  "avatar_template": "/user_avatar/delvingbitcoin.org/salvatoshi/{size}/72_2.png",
  "created_at": "2024-03-07T09:26:58.805Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"real-or-random\" data-post=\"5\" data-topic=\"626\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/real-or-random/48/413_2.png\" class=\"avatar\"> real-or-random:</div>\n<blockquote>\n<p>Hashing the commitment to the <code>txid</code> and the wallet policy sounds dangerous to me. What if you get a second PSBT for the same transaction? (It may very well be the case that I\u2019m misunderstanding \u2026)</p>\n</blockquote>\n</aside>\n<p>The idea with the <code>session_id</code> is that it should make <code>id</code> collisions unlikely in practice, but a collision should not pose a security risk, and at most cause a signing failure.</p>\n<p>If the second time a colliding psbt is presented with mutated parameters that affect NonceGen (any of the extra args), then for at least one <span class=\"math\">(i, j)</span> pair the recomputed secnonce/pubnonce would be different, signing is aborted and the session destroyed.\nIf the colliding psbt is presented with mutated members that do <em>not</em> affect the output of NonceGen, then the changes in the second PSBT vs the first are irrelevant, as NonceGen would have been executed in with the same exact parameters if there was no mutation.</p>\n<p>So unless I missed something, that should still be safe.</p>",
  "post_number": 6,
  "post_type": 1,
  "updated_at": "2024-03-07T09:26:58.805Z",
  "reply_count": 1,
  "reply_to_post_number": 5,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 8,
  "readers_count": 7,
  "score": 6.4,
  "yours": false,
  "topic_id": 626,
  "topic_slug": "state-minimization-in-musig2-signing-sessions",
  "topic_title": "State minimization in MuSig2 signing sessions",
  "topic_html_title": "State minimization in MuSig2 signing sessions",
  "category_id": 8,
  "display_username": "salvatoshi",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "\n[quote=\"real-or-random, post:5, topic:626\"]\nHashing the commitment to the `txid` and the wallet policy sounds dangerous to me. What if you get a second PSBT for the same transaction? (It may very well be the case that I\u2019m misunderstanding \u2026)\n[/quote]\n\nThe idea with the `session_id` is that it should make `id` collisions unlikely in practice, but a collision should not pose a security risk, and at most cause a signing failure.\n\nIf the second time a colliding psbt is presented with mutated parameters that affect NonceGen (any of the extra args), then for at least one $(i, j)$ pair the recomputed secnonce/pubnonce would be different, signing is aborted and the session destroyed.\nIf the colliding psbt is presented with mutated members that do *not* affect the output of NonceGen, then the changes in the second PSBT vs the first are irrelevant, as NonceGen would have been executed in with the same exact parameters if there was no mutation.\n\nSo unless I missed something, that should still be safe.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 81,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}