{
  "id": 5162,
  "name": "Eugene",
  "username": "Crypt-iQ",
  "avatar_template": "/user_avatar/delvingbitcoin.org/crypt-iq/{size}/306_2.png",
  "created_at": "2025-05-30T11:59:27.125Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"t-bast\" data-post=\"3\" data-topic=\"1723\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/t-bast/48/98_2.png\" class=\"avatar\"> t-bast:</div>\n<blockquote>\n<p>The 65kB limit ensures that we\u2019re still within a single TCP packet, which hopefully shouldn\u2019d degrade performance too much. It would be a loss though if padding all messages to 65kB would actually degrade performance more than delaying HTLC messages!</p>\n</blockquote>\n</aside>\n<p>I was looking into this recently to jog my memory \u2013 TCP packets are fragmented based on the path\u2019s minimum MTU (PMTU) and then reassembly of TCP packets occurs. This means in practice TCP packets are limited to ~1500 bytes. See <a href=\"https://datatracker.ietf.org/doc/html/rfc8900#name-ip-fragmentation\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">RFC 8900 - IP Fragmentation Considered Fragile</a> for more information if you have some time. That RFC links to another RFC (<a href=\"https://datatracker.ietf.org/doc/html/rfc4963\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">RFC 4963 - IPv4 Reassembly Errors at High Data Rates</a>) that describes an IPv4 fragmentation attack where a 3rd-party can spoof the 16-bit ID counter in the IP header and cause IP reassembly to fail (when validating the checksum) or pass with corrupted data (randomly passes the checksum which is also 16-bit).</p>\n<p>If this is just a typo and you meant Lightning packet then please disregard. I am not sure of the overhead of reassembly of TCP packets, but from what I\u2019ve read fragmentation seems to have some issues. Mistakes my own.</p>",
  "post_number": 10,
  "post_type": 1,
  "posts_count": 39,
  "updated_at": "2025-05-30T16:26:04.056Z",
  "reply_count": 1,
  "reply_to_post_number": null,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 24,
  "readers_count": 23,
  "score": 24.8,
  "yours": false,
  "topic_id": 1723,
  "topic_slug": "latency-and-privacy-in-lightning",
  "topic_title": "Latency and Privacy in Lightning",
  "topic_html_title": "Latency and Privacy in Lightning",
  "category_id": 7,
  "display_username": "Eugene",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 4,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"t-bast, post:3, topic:1723\"]\nThe 65kB limit ensures that we\u2019re still within a single TCP packet, which hopefully shouldn\u2019d degrade performance too much. It would be a loss though if padding all messages to 65kB would actually degrade performance more than delaying HTLC messages!\n[/quote]\n\nI was looking into this recently to jog my memory -- TCP packets are fragmented based on the path's minimum MTU (PMTU) and then reassembly of TCP packets occurs. This means in practice TCP packets are limited to ~1500 bytes. See https://datatracker.ietf.org/doc/html/rfc8900#name-ip-fragmentation for more information if you have some time. That RFC links to another RFC (https://datatracker.ietf.org/doc/html/rfc4963) that describes an IPv4 fragmentation attack where a 3rd-party can spoof the 16-bit ID counter in the IP header and cause IP reassembly to fail (when validating the checksum) or pass with corrupted data (randomly passes the checksum which is also 16-bit).\n\nIf this is just a typo and you meant Lightning packet then please disregard. I am not sure of the overhead of reassembly of TCP packets, but from what I've read fragmentation seems to have some issues. Mistakes my own.",
  "actions_summary": [
    {
      "id": 2,
      "count": 1
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 253,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I was looking into this recently to jog my memory \u2013 TCP packets are fragmented based on the path\u2019s minimum MTU (PMTU) and then reassembly of TCP packets occurs. This means in practice TCP packets are limited to ~1500 bytes. See <a href=\"https://datatracker.ietf.org/doc/html/rfc8900#name-ip-fragmentation\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">RFC 8900 - IP Fragmentation Considered Fragile</a> for more information if &hellip;",
  "truncated": true,
  "post_url": "/t/latency-and-privacy-in-lightning/1723/10",
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 1,
  "current_user_used_main_reaction": false
}