{
  "id": 7000,
  "name": "Jonathan Harvey-Buschel",
  "username": "jonhbit",
  "avatar_template": "/user_avatar/delvingbitcoin.org/jonhbit/{size}/1661_2.png",
  "created_at": "2026-02-28T00:38:04.260Z",
  "cooked": "<p>Thanks all for the interest on this subject! Since December, I have my new version of gossip-observer running and collecting data, so I can reply with some insights informed by preliminary results from that system.</p>\n<p>Replying in order:</p>\n<aside class=\"quote no-group\" data-username=\"endothermicdev\" data-post=\"20\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/endothermicdev/48/1720_2.png\" class=\"avatar\"> endothermicdev:</div>\n<blockquote>\n<p>I\u2019m assuming if you have 5 peers, you\u2019ll send your sketch to them at roughly even intervals - in this case, 12s. That keeps the diff of each set smaller, which means a smaller sketch capacity needs to be encoded and the decoding time is faster. In this case, you should have your sketch updated with your previous peer\u2019s responses before the next round starts. With a sufficient number of gossip peers, that may not hold true, but than would require a large number of peers and it\u2019s still a vast improvement over naive flood propagation.</p>\n</blockquote>\n</aside>\n<p>Makes sense to me <img src=\"https://delvingbitcoin.org/images/emoji/twitter/+1.png?v=15\" title=\":+1:\" class=\"emoji\" alt=\":+1:\" loading=\"lazy\" width=\"20\" height=\"20\"> I agree just keeping the sketch up to date is likely best.</p>\n<p>Related, since we have the blocknumber suffix for the set key of a message, we could indeed skip the GETDATA round trip, since both peers can compute which peer has the newer message for a specific channel (all fields would match, but blocknumber would differ). I think this matches what Rusty suggested upthread.</p>\n<aside class=\"quote no-group\" data-username=\"endothermicdev\" data-post=\"20\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/endothermicdev/48/1720_2.png\" class=\"avatar\"> endothermicdev:</div>\n<blockquote>\n<p>If you can encode the gossip message into the sketch element (without hashing it) this becomes easier because you can update your sketch with the message you\u2019re already in the process of retrieving. If the message is encoded into the sketch with SCID + blockheight, this becomes easy.</p>\n</blockquote>\n</aside>\n<p>IIUC basically all of the messages are too big to be used as a sketch element directly? Just due to sigs and keys basically. And I think the use of TLV will make the new messages slightly bigger. Maybe I\u2019m misunderstanding the suggestion here?</p>\n<aside class=\"quote no-group\" data-username=\"endothermicdev\" data-post=\"20\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/endothermicdev/48/1720_2.png\" class=\"avatar\"> endothermicdev:</div>\n<blockquote>\n<p>As a side note, there are a bunch of tradeoffs in any design here, and we have implicit assumptions about number of gossip peers, and the relative availability of sketch encoding compute vs bandwidth. It might be worthwhile to state some design goals and hardware limitations. As a starting point, I would assume a similar number of channels and updates as are broadcast today, and that the sketch encoding/decoding could be accomplished by a Raspberry Pi 5 with 10 peers (CLN current gossiper default) each getting a single round per minute.</p>\n</blockquote>\n</aside>\n<p>Agreed - I\u2019ll start to work in this direction of initial benchmarking. I have an ARM SBC similar to a Pi 4 that I can use for benchmarking Minisketch operations for the set and difference sizes we\u2019re thinking about here.</p>\n<aside class=\"quote no-group\" data-username=\"jpjuni0r\" data-post=\"21\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/jpjuni0r/48/1719_2.png\" class=\"avatar\"> jpjuni0r:</div>\n<blockquote>\n<p>Since you are talking about neighborhoods, do you think that the gossip graph is partitioned? I think that three random gossip syncers should be enough that there is only a single partition, though that assumes that every node works reliably.</p>\n</blockquote>\n</aside>\n<p>Mm, not exactly - moreso that some groups of nodes may either have issues propagating their messages, or that they receive new messages with a large delay compared to the average across the network.</p>\n<p>After reviewing some implementation code further, I\u2019m <em>more</em> convinced that the P2P network is unlikely to be partitioned. In the worst case, nodes may miss messages via normal gossip flooding, but they can receive messages via \u2018catchup\u2019 behavior like the requesting data via timestampfilter messages, or just requesting the full graph. Combined with random rotation of peers, I think that should be sufficient. We should be able to test this hypothesis with gossip graph snapshots, similar to Fabian\u2019s 2nd figure below.</p>\n<aside class=\"quote no-group\" data-username=\"jpjuni0r\" data-post=\"21\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/jpjuni0r/48/1719_2.png\" class=\"avatar\"> jpjuni0r:</div>\n<blockquote>\n<p>Still, even when ignoring the private nodes, I find that it is not ideal that there are nodes in the network that are not reachable, and it raises the question, whether they are able to process payments. That number of 4,859 nodes that recently created a new gossip message also was unexpected for me. For a typical channel, I find that they typically create a new channel update at least every 24 hours.</p>\n</blockquote>\n</aside>\n<p>I agree, and I found something similar - for a channel, if one peer is offline, (IIUC) the second peer would still rebroadcast the channel_announcement, and the channel_update for their side of the channel. So this channel would still be known to the network. However, if the channel_update for the other direction of the channel is stale or missing, then a payment (in either direction) would likely fail. In practice, I think implementations \u2018prune\u2019 channels missing fee info for one side of the channel from their graph view when performing pathfinding.</p>\n<p>I found that many channels are in this state, but I need to refine my methodology there.</p>\n<aside class=\"quote no-group\" data-username=\"jpjuni0r\" data-post=\"21\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/jpjuni0r/48/1719_2.png\" class=\"avatar\"> jpjuni0r:</div>\n<blockquote>\n<p>Another related point to your goal minimizing bandwidth: I found that there is a small minority of nodes that are very \u201cchatty\u201d. Those frequently create redundant channel updates or node announcements, that differ only in their timestamp and signature fields. In once case, there is a node creating a new node announcement every 30 sec.</p>\n</blockquote>\n</aside>\n<p>I see the same behavior, at least for channel updates (02/05-02/12):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/6/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8.jpeg\" data-download-href=\"https://delvingbitcoin.org/uploads/default/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8\" title=\"scid_msg_count\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/2X/6/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8_2_690x497.jpeg\" alt=\"scid_msg_count\" data-base62-sha1=\"faw4ebn7NxzqHKryCud6K5Cbu9G\" width=\"690\" height=\"497\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/2X/6/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8_2_690x497.jpeg, https://delvingbitcoin.org/uploads/default/optimized/2X/6/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8_2_1035x745.jpeg 1.5x, https://delvingbitcoin.org/uploads/default/original/2X/6/6a50f5cce82bb79a65bbda3b2350c7c094ed8cb8.jpeg 2x\" data-dominant-color=\"FAF2EE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">scid_msg_count</span><span class=\"informations\">1341\u00d7966 79 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>This is only comparing the \u2018outer\u2019 message with its signature and timestamp; I haven\u2019t yet compared the same data for the \u2018inner\u2019 fields as you suggested, to see how many messages are just \u2018refreshes\u2019 of the same content.</p>\n<aside class=\"quote no-group\" data-username=\"jpjuni0r\" data-post=\"21\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/jpjuni0r/48/1719_2.png\" class=\"avatar\"> jpjuni0r:</div>\n<blockquote>\n<p>What exactly do you mean by \u201cdifferent positions\u201d in the P2P network? Is that just a different selection of gossip syncers?</p>\n</blockquote>\n</aside>\n<p>I meant positions in the sense of <a href=\"https://en.wikipedia.org/wiki/Community_structure\" rel=\"noopener nofollow ugc\">detected communities</a>. Rephrased: \u201cDoes a node\u2019s position in the payment channel network affect its view of the network state, which is constructed from the gossip messages it receives over time?\u201d</p>\n<p>I used <a href=\"https://skewed.de/lab/posts/modularity-harmful/\" rel=\"noopener nofollow ugc\">stochastic block modelling</a> with the edge capacities as an extra parameter to perform community detection, and got this result:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/d/db2ead9366e01a0fad7a71d4badc6dea83a03be6.jpeg\" data-download-href=\"https://delvingbitcoin.org/uploads/default/db2ead9366e01a0fad7a71d4badc6dea83a03be6\" title=\"graph_communities_1\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/2X/d/db2ead9366e01a0fad7a71d4badc6dea83a03be6_2_690x450.jpeg\" alt=\"graph_communities_1\" data-base62-sha1=\"vgYzxySFVwAXziBWl0KEVRELaWa\" width=\"690\" height=\"450\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/2X/d/db2ead9366e01a0fad7a71d4badc6dea83a03be6_2_690x450.jpeg, https://delvingbitcoin.org/uploads/default/optimized/2X/d/db2ead9366e01a0fad7a71d4badc6dea83a03be6_2_1035x675.jpeg 1.5x, https://delvingbitcoin.org/uploads/default/optimized/2X/d/db2ead9366e01a0fad7a71d4badc6dea83a03be6_2_1380x900.jpeg 2x\" data-dominant-color=\"ECEBEC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">graph_communities_1</span><span class=\"informations\">1600\u00d71044 131 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I\u2019ll dive into this more on a deep-dive post on the BNOC forum later this week, but the tl;dr is that I found 21 communities, and 9 communities-of-communities.</p>\n<p>A massive portion of the node count is attributable to this entity, <a>Lightning Network Token</a>. They sell preconfigured nodes that seem to open a very small public channel to their hub node. This is the 4 communities on the far left; a total of ~2000 nodes.</p>\n<p>The grey community is mostly Tor-only nodes that only have 1-3 channels to the network \u2018core\u2019, specifically nodes that accept low-capacity channels such as 1ML or CoinGate. That\u2019s ~5600 nodes.</p>\n<p>For these communities, since they have very few payment channels, <em>and</em> with the assumption that massive hub nodes like 1ML aren\u2019t actually forwarding all gossip traffic to all channel peers (since it\u2019s a lot of traffic and system load), those nodes may lag behind in their network view. With random gossip peer selection, the odds of the selected peer having very few payment channels is high.</p>\n<p>Gossip-observer has one LDK node connected to each community shown here, and I\u2019m collecting snapshots of the gossip graph of each node every few hours. So from that I should be able to validate this hypothesis.</p>\n<aside class=\"quote no-group\" data-username=\"jpjuni0r\" data-post=\"21\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/jpjuni0r/48/1719_2.png\" class=\"avatar\"> jpjuni0r:</div>\n<blockquote>\n<p>Looking forward to your investigation! I can also share that analysis based on my dataset (below), where there are only two peaks: One around 0 and the other one around the number of average peers that the node had. Though I did not include all messages received in the results, but made two methodological adjustments:</p>\n</blockquote>\n</aside>\n<p>The notes on your methodology were very useful, thanks again for that! I should be able to perform similar deduplication for my collected data and cross-check with your results. I also don\u2019t have an explanation for why there is a peak around 0 / some messages not being widely received. But we may be able to get some hints from the message contents.</p>\n<aside class=\"quote no-group\" data-username=\"fabian.kraus\" data-post=\"22\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/e68b1a/48.png\" class=\"avatar\"> fabian.kraus:</div>\n<blockquote>\n<p>run two Core Lightning nodes (<em>Alice</em> and <em>Bob</em>) in <em>default</em> <em>configuration</em>, meaning ~10 peers to receive gossip from. Every gossip messages that is appended to the <code>gossip_store file</code> gets timestamped and saved in a database.</p>\n</blockquote>\n</aside>\n<p>Good to see you on this thread! My results for propagation delay are quite similar, so that\u2019s good <img src=\"https://delvingbitcoin.org/images/emoji/twitter/slight_smile.png?v=15\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/f/ffd48e07c7fad7526ac8e0bb04fa970b92900f33.jpeg\" data-download-href=\"https://delvingbitcoin.org/uploads/default/ffd48e07c7fad7526ac8e0bb04fa970b92900f33\" title=\"prop_delay_outer\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/2X/f/ffd48e07c7fad7526ac8e0bb04fa970b92900f33_2_611x500.jpeg\" alt=\"prop_delay_outer\" data-base62-sha1=\"Avb9ovpBCHuzhKv6wy47s4pVF7l\" width=\"611\" height=\"500\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/2X/f/ffd48e07c7fad7526ac8e0bb04fa970b92900f33_2_611x500.jpeg, https://delvingbitcoin.org/uploads/default/optimized/2X/f/ffd48e07c7fad7526ac8e0bb04fa970b92900f33_2_916x750.jpeg 1.5x, https://delvingbitcoin.org/uploads/default/original/2X/f/ffd48e07c7fad7526ac8e0bb04fa970b92900f33.jpeg 2x\" data-dominant-color=\"F2F4F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">prop_delay_outer</span><span class=\"informations\">1143\u00d7935 63.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>This was for <code>2026-02-05</code> to <code>2026-02-12</code>. I haven\u2019t re-run this on the data collected since the 12th.</p>\n<p>The box plots are for P05, P25, P50, P75, P95. I was puzzled by the large difference in P50 across message types, but I think LND actually processes announcements before updates, so they may be forwarded with different delays as well.</p>\n<p>The rightmost plot, \u2018Observer\u2019, is for messages sent from the gossip-observer nodes. I opened 7 channels, and I\u2019m sending random channel updates on an interval for each to generate new messages. I think the lower P50 is just due to knowing the time of message creation, vs. the expected one-hop propagation delay of a gossip message of 30 seconds (from the 60 second batching timer).</p>\n<aside class=\"quote no-group\" data-username=\"fabian.kraus\" data-post=\"22\" data-topic=\"2105\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/e68b1a/48.png\" class=\"avatar\"> fabian.kraus:</div>\n<blockquote>\n<p>Comparison of the unique message sets of the two nodes: Do both nodes see the same network?</p>\n</blockquote>\n</aside>\n<p>Good to see high-ish overlap here! I think a good next question is to dig into that non-overlapping data and see if it\u2019s always for the same parts of the graph, message types, message contents, etc. I\u2019ll try to do the same.</p>\n<p>It would be interesting to see your stats on messages I\u2019m generating / that we have a known origin location and time for - as I\u2019m running a custom version of LDK node, I\u2019m not sure how other implementations, with stock settings, may be seeing my channels.</p>\n<p>I\u2019ll think more about interesting queries as well - I\u2019m still refining that myself tbh.</p>\n<p><em>P.S.Thank you to emzy and SchroedingersCat for accepting my low-value channel open requests. Hat-tip to Megalithic for running a routing node specifically for smaller-value channels.</em></p>",
  "post_number": 23,
  "post_type": 1,
  "posts_count": 22,
  "updated_at": "2026-02-28T00:45:32.715Z",
  "reply_count": 0,
  "reply_to_post_number": 20,
  "quote_count": 3,
  "incoming_link_count": 0,
  "reads": 3,
  "readers_count": 2,
  "score": 0.4,
  "yours": false,
  "topic_id": 2105,
  "topic_slug": "gossip-observer-new-project-to-monitor-the-lightning-p2p-network",
  "topic_title": "Gossip Observer: New project to monitor the Lightning P2P network",
  "topic_html_title": "Gossip Observer: New project to monitor the Lightning P2P network",
  "category_id": 7,
  "display_username": "Jonathan Harvey-Buschel",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Thanks all for the interest on this subject! Since December, I have my new version of gossip-observer running and collecting data, so I can reply with some insights informed by preliminary results from that system.\n\nReplying in order:\n\n[quote=\"endothermicdev, post:20, topic:2105\"]\nI\u2019m assuming if you have 5 peers, you\u2019ll send your sketch to them at roughly even intervals - in this case, 12s. That keeps the diff of each set smaller, which means a smaller sketch capacity needs to be encoded and the decoding time is faster. In this case, you should have your sketch updated with your previous peer\u2019s responses before the next round starts. With a sufficient number of gossip peers, that may not hold true, but than would require a large number of peers and it\u2019s still a vast improvement over naive flood propagation.\n[/quote]\n\nMakes sense to me :+1: I agree just keeping the sketch up to date is likely best.\n\nRelated, since we have the blocknumber suffix for the set key of a message, we could indeed skip the GETDATA round trip, since both peers can compute which peer has the newer message for a specific channel (all fields would match, but blocknumber would differ). I think this matches what Rusty suggested upthread.\n\n[quote=\"endothermicdev, post:20, topic:2105\"]\nIf you can encode the gossip message into the sketch element (without hashing it) this becomes easier because you can update your sketch with the message you\u2019re already in the process of retrieving. If the message is encoded into the sketch with SCID + blockheight, this becomes easy.\n[/quote]\n\nIIUC basically all of the messages are too big to be used as a sketch element directly? Just due to sigs and keys basically. And I think the use of TLV will make the new messages slightly bigger. Maybe I'm misunderstanding the suggestion here?\n\n[quote=\"endothermicdev, post:20, topic:2105\"]\nAs a side note, there are a bunch of tradeoffs in any design here, and we have implicit assumptions about number of gossip peers, and the relative availability of sketch encoding compute vs bandwidth. It might be worthwhile to state some design goals and hardware limitations. As a starting point, I would assume a similar number of channels and updates as are broadcast today, and that the sketch encoding/decoding could be accomplished by a Raspberry Pi 5 with 10 peers (CLN current gossiper default) each getting a single round per minute.\n[/quote]\n\nAgreed - I'll start to work in this direction of initial benchmarking. I have an ARM SBC similar to a Pi 4 that I can use for benchmarking Minisketch operations for the set and difference sizes we're thinking about here.\n\n[quote=\"jpjuni0r, post:21, topic:2105\"]\nSince you are talking about neighborhoods, do you think that the gossip graph is partitioned? I think that three random gossip syncers should be enough that there is only a single partition, though that assumes that every node works reliably.\n[/quote]\n\nMm, not exactly - moreso that some groups of nodes may either have issues propagating their messages, or that they receive new messages with a large delay compared to the average across the network.\n\nAfter reviewing some implementation code further, I'm _more_ convinced that the P2P network is unlikely to be partitioned. In the worst case, nodes may miss messages via normal gossip flooding, but they can receive messages via 'catchup' behavior like the requesting data via timestampfilter messages, or just requesting the full graph. Combined with random rotation of peers, I think that should be sufficient. We should be able to test this hypothesis with gossip graph snapshots, similar to Fabian's 2nd figure below.\n\n[quote=\"jpjuni0r, post:21, topic:2105\"]\nStill, even when ignoring the private nodes, I find that it is not ideal that there are nodes in the network that are not reachable, and it raises the question, whether they are able to process payments. That number of 4,859 nodes that recently created a new gossip message also was unexpected for me. For a typical channel, I find that they typically create a new channel update at least every 24 hours.\n[/quote]\n\nI agree, and I found something similar - for a channel, if one peer is offline, (IIUC) the second peer would still rebroadcast the channel_announcement, and the channel_update for their side of the channel. So this channel would still be known to the network. However, if the channel_update for the other direction of the channel is stale or missing, then a payment (in either direction) would likely fail. In practice, I think implementations 'prune' channels missing fee info for one side of the channel from their graph view when performing pathfinding.\n\nI found that many channels are in this state, but I need to refine my methodology there.\n\n[quote=\"jpjuni0r, post:21, topic:2105\"]\nAnother related point to your goal minimizing bandwidth: I found that there is a small minority of nodes that are very \u201cchatty\u201d. Those frequently create redundant channel updates or node announcements, that differ only in their timestamp and signature fields. In once case, there is a node creating a new node announcement every 30 sec.\n[/quote]\n\nI see the same behavior, at least for channel updates (02/05-02/12):\n\n![scid_msg_count|690x497](upload://faw4ebn7NxzqHKryCud6K5Cbu9G.jpeg)\n\nThis is only comparing the 'outer' message with its signature and timestamp; I haven't yet compared the same data for the 'inner' fields as you suggested, to see how many messages are just 'refreshes' of the same content.\n\n[quote=\"jpjuni0r, post:21, topic:2105\"]\nWhat exactly do you mean by \u201cdifferent positions\u201d in the P2P network? Is that just a different selection of gossip syncers?\n[/quote]\n\nI meant positions in the sense of [detected communities](https://en.wikipedia.org/wiki/Community_structure). Rephrased: \"Does a node's position in the payment channel network affect its view of the network state, which is constructed from the gossip messages it receives over time?\"\n\nI used [stochastic block modelling](https://skewed.de/lab/posts/modularity-harmful/) with the edge capacities as an extra parameter to perform community detection, and got this result:\n\n![graph_communities_1|690x450](upload://vgYzxySFVwAXziBWl0KEVRELaWa.jpeg)\n\nI'll dive into this more on a deep-dive post on the BNOC forum later this week, but the tl;dr is that I found 21 communities, and 9 communities-of-communities.\n\nA massive portion of the node count is attributable to this entity, [Lightning Network Token](btclnt.com/). They sell preconfigured nodes that seem to open a very small public channel to their hub node. This is the 4 communities on the far left; a total of ~2000 nodes.\n\nThe grey community is mostly Tor-only nodes that only have 1-3 channels to the network 'core', specifically nodes that accept low-capacity channels such as 1ML or CoinGate. That's ~5600 nodes.\n\nFor these communities, since they have very few payment channels, _and_ with the assumption that massive hub nodes like 1ML aren't actually forwarding all gossip traffic to all channel peers (since it's a lot of traffic and system load), those nodes may lag behind in their network view. With random gossip peer selection, the odds of the selected peer having very few payment channels is high.\n\nGossip-observer has one LDK node connected to each community shown here, and I'm collecting snapshots of the gossip graph of each node every few hours. So from that I should be able to validate this hypothesis.\n\n[quote=\"jpjuni0r, post:21, topic:2105\"]\nLooking forward to your investigation! I can also share that analysis based on my dataset (below), where there are only two peaks: One around 0 and the other one around the number of average peers that the node had. Though I did not include all messages received in the results, but made two methodological adjustments:\n[/quote]\n\nThe notes on your methodology were very useful, thanks again for that! I should be able to perform similar deduplication for my collected data and cross-check with your results. I also don't have an explanation for why there is a peak around 0 / some messages not being widely received. But we may be able to get some hints from the message contents.\n\n[quote=\"fabian.kraus, post:22, topic:2105\"]\nrun two Core Lightning nodes (*Alice* and *Bob*) in *default* *configuration*, meaning ~10 peers to receive gossip from. Every gossip messages that is appended to the `gossip_store file` gets timestamped and saved in a database.\n[/quote]\n\nGood to see you on this thread! My results for propagation delay are quite similar, so that's good :slight_smile: \n\n![prop_delay_outer|611x500](upload://Avb9ovpBCHuzhKv6wy47s4pVF7l.jpeg)\n\nThis was for `2026-02-05` to `2026-02-12`. I haven't re-run this on the data collected since the 12th.\n\nThe box plots are for P05, P25, P50, P75, P95. I was puzzled by the large difference in P50 across message types, but I think LND actually processes announcements before updates, so they may be forwarded with different delays as well.\n\nThe rightmost plot, 'Observer', is for messages sent from the gossip-observer nodes. I opened 7 channels, and I'm sending random channel updates on an interval for each to generate new messages. I think the lower P50 is just due to knowing the time of message creation, vs. the expected one-hop propagation delay of a gossip message of 30 seconds (from the 60 second batching timer).\n\n[quote=\"fabian.kraus, post:22, topic:2105\"]\nComparison of the unique message sets of the two nodes: Do both nodes see the same network?\n[/quote]\n\nGood to see high-ish overlap here! I think a good next question is to dig into that non-overlapping data and see if it's always for the same parts of the graph, message types, message contents, etc. I'll try to do the same.\n\nIt would be interesting to see your stats on messages I'm generating / that we have a known origin location and time for - as I'm running a custom version of LDK node, I'm not sure how other implementations, with stock settings, may be seeing my channels.\n\nI'll think more about interesting queries as well - I'm still refining that myself tbh.\n\n_P.S.Thank you to emzy and SchroedingersCat for accepting my low-value channel open requests. Hat-tip to Megalithic for running a routing node specifically for smaller-value channels._",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 982,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Thanks all for the interest on this subject! Since December, I have my new version of gossip-observer running and collecting data, so I can reply with some insights informed by preliminary results from that system. \nReplying in order: \n\nMakes sense to me :+1: I agree just keeping the sketch up to da&hellip;",
  "truncated": true,
  "post_url": "/t/gossip-observer-new-project-to-monitor-the-lightning-p2p-network/2105/23",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}