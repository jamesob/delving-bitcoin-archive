{
  "id": 6785,
  "name": "Ethan Heilman",
  "username": "EthanHeilman",
  "avatar_template": "/user_avatar/delvingbitcoin.org/ethanheilman/{size}/328_2.png",
  "created_at": "2026-02-09T18:59:40.785Z",
  "cooked": "<p>I want to share my thoughts on increasing the security of Bitcoin to long term threats such as quantum and classical breaks in Bitcoin\u2019s signature algorithms by adding algorithm agility mechanisms to Bitcoin. To quote <a href=\"https://datatracker.ietf.org/doc/html/rfc7696\" rel=\"noopener nofollow ugc\">RFC 7696: Guidelines for Cryptographic Algorithm Agility</a>:</p>\n<p>\u201cProtocol designers need to assume that advances in computing power or advances in cryptoanalytic techniques will eventually make any algorithm obsolete.  For this reason, protocols need mechanisms  to migrate from one algorithm suite to another over time.</p>\n<p>Algorithm agility is achieved when a protocol can easily migrate from one algorithm suite to another more desirable one, over time.\u201d</p>\n<p>I propose introducing a very secure post-quantum signature algorithm to be used alongside the current algorithms. This signature algorithm can be very expensive in txn fees and block space since it is for emergency migrations only. This enables Bitcoin holders to cheaply and easily create outputs that \u201cfailsafe\u201d even against  an unexpected break in a signature algorithm.</p>\n<h2><a name=\"p-6785-motivation-1\" class=\"anchor\" href=\"#p-6785-motivation-1\" aria-label=\"Heading link\"></a><strong>Motivation</strong></h2>\n<p>Bitcoin should enable a person to self-custody coins for at least one human lifetime, ~75 years. Someone should be able to bury an HD Seed in a coffee can and then dig it up in 75 years and spend those coins. No store of value can promise complete safety on long timescales, but the trust we build by demonstrating that Bitcoin is serious about mitigating long-term low probability risks. Trust and credibility is built even when the risk we defended against never happens.</p>\n<p>The main risk I will be considering here is the loss of the ability to authenticate ownership of coins resulting from a break in a digital signature algorithm used by Bitcoin. Such risks are extremely unlikely in the short term (1 to 5 years), but become more likely on 5 to 75 year timescales. Most of the focus in the wider cryptocurrency world has been on mitigating the quantum threat, but I take a less narrow view of the problem. We should consider not just Quantum attacks on Bitcoin\u2019s signature algorithms and also classical breaks that do not require a quantum computer. One particular area of concern to me is an unexpected breakthrough in Mathematics driven by AI approaches.</p>\n<p>To address these risks we propose the following design for protecting holders even against an unexpected break in Bitcoin\u2019s signature algorithms quantum or otherwise.</p>\n<h2><a name=\"p-6785-design-2\" class=\"anchor\" href=\"#p-6785-design-2\" aria-label=\"Heading link\"></a><strong>Design</strong></h2>\n<p>Assume that Bitcoin supported two digital signature algorithms: DSA1 and DSA2. Each signature scheme would have its own CHECKSIG opcode, CHECKSIG_DSA1 and CHECKSIG_DSA2.</p>\n<p>Using BIP 360, we could have a leaf script for CHECKSIG_DSA1 and a leaf script for CHECKSIG_DSA2.</p>\n<ul>\n<li>Leaf1: DSA1_PUBKEY, CHECKSIG_DSA1</li>\n<li>Leaf2: DSA2_PUBKEY, CHECKSIG_DSA2</li>\n</ul>\n<p>If DSA1 was broken, users could simply switch to spending the output with DSA2 signatures by using leaf2. An attacker that could break DSA1, wouldn\u2019t be able to learn the public key for DSA1, and thus wouldn\u2019t be able to spend DSA1, despite DSA1 being vulnerable.</p>\n<p>This approach makes the assumption that the user has not leaked their public key to an attacker or reused their public keys. As a user wishing to hold Bitcoin in an output over long periods of time generate a fresh set of public keys for that output.</p>\n<p>Our approach does not defend against the case where DSA1 and DSA2 are broken at the same time. For this reason, DSA1 and DSA2 should use different cryptographic assumptions. Additionally DSA2 should use a signature scheme that trades off efficiency for additional security and robustness. This way, we can get the best of both worlds, DSA1 can be used for everyday signatures and if DSA1 is broken, DSA2 can be used to migrate to a new signature scheme, say DSA3. Even if DSA3, chosen in haste to replace DSA1, is also found to be weak, holders are still protected. This is because DSA2 is unbroken, allowing us to replace DSA3 with DSA4.</p>\n<ul>\n<li>DSA1 - Efficient, low cost to use, should support nice-to-have features such as aggregation.</li>\n<li>DSA2 - Expensive, extreme levels of security, only used to transition to new signature schemes.</li>\n</ul>\n<p>A person with an HD seed buried in a coffee can for 75 years is still safe even if they don\u2019t transition from DSA1 to DSA3 and since DSA2 is still safe. When they dig it up, they can use DSA2 to move the output to DSA3+DSA2.</p>\n<p>Given this framework, let\u2019s think about DSA1 and DSA2 with concrete algorithms:</p>\n<ul>\n<li>DSA1 is Schnorr, the currently supported Schnorr signature algorithmin Bitcoin.</li>\n<li>DSA2 is SLH-DSA (SPHINCS+ SLH-DSA-SHA2-128s). SLH-DSA is a hash based signature algorithm. Hash based signatures are the most likely secure long term.</li>\n</ul>\n<p>If we merged BIP 360 and support for a SLH-DSA CHECKSIG opcode, holders could hedge against a classical or quantum attack against Schnorr, while still using Schnorr.</p>\n<p>Our approach mitigates the main drawback of the size of SLH-DSA signatures, their size. SLH-DSA signatures are 8 KB in size, while [0] explores methods for reducing the size of these signatures to 3 KB, 3 KB is still huge. Because SLH-DSA signatures would not have any additional discount, they would be very expensive in transaction fees, and only economically worthwhile to migrate from Schnorr to a new signature scheme. In all other cases the addition of SLH-DSA would exist as unused leaf scripts in the output, which increases the witness by 32 bytes.</p>\n<p>An additional benefit to this approach of using BIP 360 and SLH-DSA would be to buy time for non-hash based PQ signature schemes to mature. We are seeing rapid advances in research on post-quantum signature schemes and waiting a little long might buy us a lot. SLH-DSA would provide an effective hedge against this risk, while delaying the decision of what PQ signature scheme should replace Schnorr in the event of Schnorr\u2019s security being weakened.</p>\n<h2><a name=\"p-6785-q-a-3\" class=\"anchor\" href=\"#p-6785-q-a-3\" aria-label=\"Heading link\"></a><strong>Q &amp; A</strong></h2>\n<p><strong>Q:</strong> Could these signatures be abused to store JPEGs on the blockchain?</p>\n<p><strong>A:</strong> No because they would have no additional discount. This means they would have no advantage for JPEGs over what is currently possible.</p>\n<p>\u2013</p>\n<p><strong>Q:</strong> Why not use XMSS or Lamport signatures instead of SLH_DSA?</p>\n<p><strong>A:</strong> I prefer SLH_DSA because it is likely to be well supported outside of Bitcoin and Bitcoin can benefit from this ecosystem of support in the form of HSMs, hardware acceleration and software liberties. That said, it is reasonable to consider stateful hash based signature schemes like XMSS, Winternitz, or Lamport signatures as the fallback signature, especially if size becomes a concern.</p>\n<p>\u2013</p>\n<p><strong>Q:</strong> What non-consensus critical changes would be needed to support this?</p>\n<p><strong>A:</strong> We\u2019d need to create new wallet standards to provide alternatives to BIP32 xpubs. Wallet would have to write code to generate SLH-DSA keys and create a script tree per signature alg. Wallets would also have to put into place mechanisms to warn for and prevent public key reuse.</p>\n<p>\u2013</p>\n<p><strong>Q:</strong> What consensus critical changes would be needed to support this?</p>\n<p><strong>A:</strong> We\u2019d need to merge something like BIP 360 and then a new CHECKSIG opcode for SLH_DSA.</p>\n<p>\u2013</p>\n<p><strong>Q:</strong> Couldn\u2019t you do this without BIP 360 by using Taproot instead and then disabling the taproot key spend path?</p>\n<p><strong>A:</strong> Yes, however this would be confiscatory, since Taproot allows key spend path only outputs. People holding key spend path-only Taproot outputs would have the coins in those outputs destroyed. BIP 360, in essence is Taproot, without the key spend path. BIP 360 provides the same functionality as disabling Taproot key spend paths, but rather than being confiscatory, it is opt in.</p>\n<p>\u2013</p>\n<p><strong>Q:</strong> Are you proposing this now because you think that the Bitcoin signature algorithms are under threat?</p>\n<p><strong>A:</strong> No, I am confident in the Bitcoin signature algorithms and I know of no immediate threats. This effort is motivated by longtermism and thinking about how to enable Bitcoin to be safe on timescales of decades or centuries.</p>\n<p>[0]: Mikhail Kudinov, Jonas Nick, Hash-based Signature Schemes for Bitcoin (2025) <a href=\"https://eprint.iacr.org/2025/2203\" rel=\"noopener nofollow ugc\">https://eprint.iacr.org/2025/2203</a></p>",
  "post_number": 1,
  "post_type": 1,
  "posts_count": 1,
  "updated_at": "2026-02-09T19:56:17.534Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 2,
  "reads": 2,
  "readers_count": 1,
  "score": 0.4,
  "yours": false,
  "topic_id": 2241,
  "topic_slug": "algorithm-agility-to-defeat-quantum-and-classical-attacks-on-bitcoins-signature-algorithms",
  "topic_title": "Algorithm agility to defeat quantum and classical attacks on Bitcoin's signature algorithms",
  "topic_html_title": "Algorithm agility to defeat quantum and classical attacks on Bitcoin&rsquo;s signature algorithms",
  "category_id": 7,
  "display_username": "Ethan Heilman",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 3,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "I want to share my thoughts on increasing the security of Bitcoin to long term threats such as quantum and classical breaks in Bitcoin\u2019s signature algorithms by adding algorithm agility mechanisms to Bitcoin. To quote [RFC 7696: Guidelines for Cryptographic Algorithm Agility](https://datatracker.ietf.org/doc/html/rfc7696):\n\n\u201cProtocol designers need to assume that advances in computing power or advances in cryptoanalytic techniques will eventually make any algorithm obsolete.  For this reason, protocols need mechanisms  to migrate from one algorithm suite to another over time.\n\nAlgorithm agility is achieved when a protocol can easily migrate from one algorithm suite to another more desirable one, over time.\u201d\n\nI propose introducing a very secure post-quantum signature algorithm to be used alongside the current algorithms. This signature algorithm can be very expensive in txn fees and block space since it is for emergency migrations only. This enables Bitcoin holders to cheaply and easily create outputs that \u201cfailsafe\u201d even against  an unexpected break in a signature algorithm.\n\n## **Motivation**\n\nBitcoin should enable a person to self-custody coins for at least one human lifetime, \\~75 years. Someone should be able to bury an HD Seed in a coffee can and then dig it up in 75 years and spend those coins. No store of value can promise complete safety on long timescales, but the trust we build by demonstrating that Bitcoin is serious about mitigating long-term low probability risks. Trust and credibility is built even when the risk we defended against never happens.\n\nThe main risk I will be considering here is the loss of the ability to authenticate ownership of coins resulting from a break in a digital signature algorithm used by Bitcoin. Such risks are extremely unlikely in the short term (1 to 5 years), but become more likely on 5 to 75 year timescales. Most of the focus in the wider cryptocurrency world has been on mitigating the quantum threat, but I take a less narrow view of the problem. We should consider not just Quantum attacks on Bitcoin\u2019s signature algorithms and also classical breaks that do not require a quantum computer. One particular area of concern to me is an unexpected breakthrough in Mathematics driven by AI approaches.\n\nTo address these risks we propose the following design for protecting holders even against an unexpected break in Bitcoin\u2019s signature algorithms quantum or otherwise.\n\n## **Design**\n\nAssume that Bitcoin supported two digital signature algorithms: DSA1 and DSA2. Each signature scheme would have its own CHECKSIG opcode, CHECKSIG_DSA1 and CHECKSIG_DSA2.\n\nUsing BIP 360, we could have a leaf script for CHECKSIG_DSA1 and a leaf script for CHECKSIG_DSA2.\n\n* Leaf1: DSA1_PUBKEY, CHECKSIG_DSA1\n* Leaf2: DSA2_PUBKEY, CHECKSIG_DSA2\n\nIf DSA1 was broken, users could simply switch to spending the output with DSA2 signatures by using leaf2. An attacker that could break DSA1, wouldn\u2019t be able to learn the public key for DSA1, and thus wouldn\u2019t be able to spend DSA1, despite DSA1 being vulnerable.\n\nThis approach makes the assumption that the user has not leaked their public key to an attacker or reused their public keys. As a user wishing to hold Bitcoin in an output over long periods of time generate a fresh set of public keys for that output.\n\nOur approach does not defend against the case where DSA1 and DSA2 are broken at the same time. For this reason, DSA1 and DSA2 should use different cryptographic assumptions. Additionally DSA2 should use a signature scheme that trades off efficiency for additional security and robustness. This way, we can get the best of both worlds, DSA1 can be used for everyday signatures and if DSA1 is broken, DSA2 can be used to migrate to a new signature scheme, say DSA3. Even if DSA3, chosen in haste to replace DSA1, is also found to be weak, holders are still protected. This is because DSA2 is unbroken, allowing us to replace DSA3 with DSA4.\n\n* DSA1 - Efficient, low cost to use, should support nice-to-have features such as aggregation.\n* DSA2 - Expensive, extreme levels of security, only used to transition to new signature schemes.\n\nA person with an HD seed buried in a coffee can for 75 years is still safe even if they don\u2019t transition from DSA1 to DSA3 and since DSA2 is still safe. When they dig it up, they can use DSA2 to move the output to DSA3+DSA2.\n\nGiven this framework, let\u2019s think about DSA1 and DSA2 with concrete algorithms:\n\n* DSA1 is Schnorr, the currently supported Schnorr signature algorithmin Bitcoin.\n* DSA2 is SLH-DSA (SPHINCS+ SLH-DSA-SHA2-128s). SLH-DSA is a hash based signature algorithm. Hash based signatures are the most likely secure long term.\n\nIf we merged BIP 360 and support for a SLH-DSA CHECKSIG opcode, holders could hedge against a classical or quantum attack against Schnorr, while still using Schnorr.\n\nOur approach mitigates the main drawback of the size of SLH-DSA signatures, their size. SLH-DSA signatures are 8 KB in size, while \\[0\\] explores methods for reducing the size of these signatures to 3 KB, 3 KB is still huge. Because SLH-DSA signatures would not have any additional discount, they would be very expensive in transaction fees, and only economically worthwhile to migrate from Schnorr to a new signature scheme. In all other cases the addition of SLH-DSA would exist as unused leaf scripts in the output, which increases the witness by 32 bytes.\n\nAn additional benefit to this approach of using BIP 360 and SLH-DSA would be to buy time for non-hash based PQ signature schemes to mature. We are seeing rapid advances in research on post-quantum signature schemes and waiting a little long might buy us a lot. SLH-DSA would provide an effective hedge against this risk, while delaying the decision of what PQ signature scheme should replace Schnorr in the event of Schnorr\u2019s security being weakened.\n\n## **Q & A**\n\n**Q:** Could these signatures be abused to store JPEGs on the blockchain?\n\n**A:** No because they would have no additional discount. This means they would have no advantage for JPEGs over what is currently possible.\n\n\u2013\n\n**Q:** Why not use XMSS or Lamport signatures instead of SLH_DSA?\n\n**A:** I prefer SLH_DSA because it is likely to be well supported outside of Bitcoin and Bitcoin can benefit from this ecosystem of support in the form of HSMs, hardware acceleration and software liberties. That said, it is reasonable to consider stateful hash based signature schemes like XMSS, Winternitz, or Lamport signatures as the fallback signature, especially if size becomes a concern.\n\n\u2013\n\n**Q:** What non-consensus critical changes would be needed to support this?\n\n**A:** We\u2019d need to create new wallet standards to provide alternatives to BIP32 xpubs. Wallet would have to write code to generate SLH-DSA keys and create a script tree per signature alg. Wallets would also have to put into place mechanisms to warn for and prevent public key reuse.\n\n\u2013\n\n**Q:** What consensus critical changes would be needed to support this?\n\n**A:** We\u2019d need to merge something like BIP 360 and then a new CHECKSIG opcode for SLH_DSA.\n\n\u2013\n\n**Q:** Couldn\u2019t you do this without BIP 360 by using Taproot instead and then disabling the taproot key spend path?\n\n**A:** Yes, however this would be confiscatory, since Taproot allows key spend path only outputs. People holding key spend path-only Taproot outputs would have the coins in those outputs destroyed. BIP 360, in essence is Taproot, without the key spend path. BIP 360 provides the same functionality as disabling Taproot key spend paths, but rather than being confiscatory, it is opt in.\n\n\u2013\n\n**Q:** Are you proposing this now because you think that the Bitcoin signature algorithms are under threat?\n\n**A:** No, I am confident in the Bitcoin signature algorithms and I know of no immediate threats. This effort is motivated by longtermism and thinking about how to enable Bitcoin to be safe on timescales of decades or centuries.\n\n\\[0\\]: Mikhail Kudinov, Jonas Nick, Hash-based Signature Schemes for Bitcoin (2025) [https://eprint.iacr.org/2025/2203](https://eprint.iacr.org/2025/2203)",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 267,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I want to share my thoughts on increasing the security of Bitcoin to long term threats such as quantum and classical breaks in Bitcoin\u2019s signature algorithms by adding algorithm agility mechanisms to Bitcoin. To quote <a href=\"https://datatracker.ietf.org/doc/html/rfc7696\" rel=\"noopener nofollow ugc\">RFC 7696: Guidelines for Cryptographic Algorithm Agility</a>: \n\u201cProtocol designers nee&hellip;",
  "truncated": true,
  "post_url": "/t/algorithm-agility-to-defeat-quantum-and-classical-attacks-on-bitcoins-signature-algorithms/2241/1",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null,
  "can_vote": false
}