{
  "id": 6783,
  "name": "bitryonix",
  "username": "bitryonix",
  "avatar_template": "/user_avatar/delvingbitcoin.org/bitryonix/{size}/1813_2.png",
  "created_at": "2026-02-09T05:36:52.959Z",
  "cooked": "<p><strong>Duress Mechanism in the Boomerang Protocol: Protecting Users Under Coercion</strong></p>\n<p>Hey everyone, diving deeper into the Boomerang protocol\u2019s security features, here\u2019s a detailed breakdown of the duress mechanism. This is a system designed to let users signal distress discreetly during withdrawals, without alerting an attacker. It leverages memorized \u201cconsent sets\u201d based on countries, encrypted communications, and integration with Search and Rescue (SAR) entities to trigger help if needed. The goal is to make coercion risky for attackers while maintaining plausible deniability.\nI\u2019ll cover the core concepts, setup, runtime usage (e.g., during withdrawals), security assumptions, and how it handles adversaries. This is based on the protocol\u2019s design docs and diagrams. Please feel free to ask for clarifications!</p>\n<p><strong>What is the Duress Mechanism?</strong>\nThe duress system allows users to signal coercion (e.g., being forced to sign a transaction) by entering a non-standard input during \u201cduress checks.\u201d These checks happen at key points like committing to a withdrawal or randomly during the process. If duress is signaled, the system silently sends a payload to SARs (trusted rescuers) to decrypt and use \u201cdoxing data\u201d (personal info for location/recovery) to initiate a rescue, without changing observable behavior to tip off the attacker.\nKey actors:</p>\n<ul>\n<li>\n<p><strong>User</strong>: Creates doxing data and a password; memorizes a \u201cconsent set\u201d of 5 countries.</p>\n</li>\n<li>\n<p><strong>SAR (Search and Rescue Entity)</strong>: Holds encrypted doxing data; Once received a payload created after a positive duress signal, can decrypt and act on duress signals.</p>\n</li>\n<li>\n<p><strong>Adversary</strong>: Can capture/observe the user but can\u2019t break crypto or hardware security.</p>\n</li>\n</ul>\n<p><strong>Doxing Data: The Rescue Payload</strong>\nDoxing data helps SAR locate and rescue the user:</p>\n<ul>\n<li>\n<p><strong>Static Data</strong>: Fixed info like name, ID, addresses, phone numbers, and trusted contacts (encrypted with doxing_key = SHA256(doxing_password)). Sent to SAR during setup.</p>\n</li>\n<li>\n<p><strong>Dynamic Data</strong>: Real-time feeds (e.g., phone location) encrypted and updated continuously.</p>\n</li>\n</ul>\n<p>On duress, Boomlet (hardware wallet) sends the doxing_key (encrypted for SAR) in message payloads. SAR decrypts, hashes to identify the user, and starts rescue ops.</p>\n<p><strong>Core Concepts</strong></p>\n<ul>\n<li>\n<p><strong>Consent Set</strong>: 5 unique countries (no order) chosen by the user during setup. Matching this set means \u201cno duress\u201d; any other combination signals duress.</p>\n</li>\n<li>\n<p><strong>Country Mapping</strong>: Based on 195 countries (UN-like list) sorted alphabetically (1 = Afghanistan, \u2026, 195 = Zimbabwe).</p>\n</li>\n<li>\n<p><strong>Duress Checks</strong>: Boomlet generates 5 random lists of 1-195 numbers; ST (Secure Terminal) maps to countries and displays as columns. User selects one per column.</p>\n</li>\n<li>\n<p><strong>Plausible Deniability</strong>: Under torture, user can reveal any 5 countries as the \u201cconsent set\u201d\u2014attacker can\u2019t verify without risking a real duress signal.</p>\n</li>\n</ul>\n<p>Probability of random guess succeeding: ~3.73e-12 (1 in 267 billion), making blind attacks infeasible.</p>\n<p><strong>Setup Process</strong>\nDone via isolated devices (Iso, Boomlet, ST) with QR codes for secure, air-gapped comms:</p>\n<ul>\n<li>\n<p>Boomlet and ST exchange identity pubkeys via Iso/QR to establish shared ECDH key (AES encryption).</p>\n</li>\n<li>\n<p>Boomlet generates random list [1-195], encrypts, sends via Iso/QR to ST.</p>\n</li>\n<li>\n<p>ST decrypts, maps to countries (alphabetical), displays list.</p>\n</li>\n<li>\n<p>User selects 5 countries via joystick (memorizes names); ST records indices, encrypts, sends back via QR/Iso.</p>\n</li>\n<li>\n<p>Boomlet decrypts, extracts numbers as consent_set.</p>\n</li>\n<li>\n<p>Confirmation: Boomlet sends 5 new random lists; user re-selects to match consent_set. Mismatch? Retry or restart.</p>\n</li>\n</ul>\n<p>After setup, user only remembers 5 country names; system stores numbers securely.</p>\n<p><strong>Runtime Process (e.g., During Withdrawal)</strong>\nChecks triggered by Boomlet (at commitment or PRNG-based random intervals):</p>\n<ul>\n<li>\n<p>Boomlet generates 5 random [1-195] lists, encrypts, sends via Niso/QR to ST.</p>\n</li>\n<li>\n<p>ST decrypts, maps to country columns, displays on small monitor.</p>\n</li>\n<li>\n<p>User selects one country per column via joystick (hidden from observer).</p>\n</li>\n<li>\n<p>ST encrypts indices, sends back via QR/Niso to Boomlet.</p>\n</li>\n<li>\n<p>Boomlet decrypts, extracts numbers, compares to consent_set:</p>\n<ul>\n<li>\n<p>Match = No duress: Encrypts all-zeroes payload for SAR.</p>\n</li>\n<li>\n<p>Mismatch = Duress: Encrypts doxing_key for SAR.</p>\n</li>\n</ul>\n</li>\n<li>\n<p>Payload embedded in next withdrawal message to Watchtower (WT).</p>\n</li>\n<li>\n<p>WT forwards payload to SAR.</p>\n</li>\n<li>\n<p>SAR decrypts:</p>\n<ul>\n<li>\n<p>All zeroes? Ignore (no duress).</p>\n</li>\n<li>\n<p>Else? Hash to doxing_identifier, search database, decrypt doxing data, start rescue.</p>\n</li>\n<li>\n<p>Malformed? Increment counter; if threshold hit, halt protocol.</p>\n</li>\n</ul>\n</li>\n<li>\n<p>SAR signs/acknowledges back to WT/Boomlet for verification.</p>\n</li>\n</ul>\n<p>Once duress is signaled, all future messages carry it. Persistent alert.</p>\n<p><strong>Security Features and Attacker Assumptions</strong>\nCovers forced transactions or continued signing under compromise. Resistant to:</p>\n<ul>\n<li>\n<p>Replay attacks (fresh random lists each time).</p>\n</li>\n<li>\n<p>Typos (set-based, order-insensitive).</p>\n</li>\n<li>\n<p>Observation (ST\u2019s small screen + hidden input).</p>\n</li>\n</ul>\n<p>Attacker can:</p>\n<ul>\n<li>Capture/observe user, read plain messages, act as user, destroy hardware.</li>\n</ul>\n<p>But cannot:</p>\n<ul>\n<li>Break JavaCard security, crypto, or observe ST input without seeing screen + hands simultaneously.</li>\n</ul>\n<p>Consequences: No observable changes on duress (plausible deniability); withdrawal proceeds normally but SAR is alerted.</p>",
  "post_number": 2,
  "post_type": 1,
  "posts_count": 2,
  "updated_at": "2026-02-09T05:36:52.959Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 1,
  "readers_count": 0,
  "score": 0.2,
  "yours": false,
  "topic_id": 2239,
  "topic_slug": "boomerang-bitcoin-cold-storage-with-built-in-coercion-resistance",
  "topic_title": "Boomerang: Bitcoin Cold Storage with Built-In Coercion Resistance",
  "topic_html_title": "Boomerang: Bitcoin Cold Storage with Built-In Coercion Resistance",
  "category_id": 7,
  "display_username": "bitryonix",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "**Duress Mechanism in the Boomerang Protocol: Protecting Users Under Coercion**\n\nHey everyone, diving deeper into the Boomerang protocol's security features, here's a detailed breakdown of the duress mechanism. This is a system designed to let users signal distress discreetly during withdrawals, without alerting an attacker. It leverages memorized \"consent sets\" based on countries, encrypted communications, and integration with Search and Rescue (SAR) entities to trigger help if needed. The goal is to make coercion risky for attackers while maintaining plausible deniability.\nI'll cover the core concepts, setup, runtime usage (e.g., during withdrawals), security assumptions, and how it handles adversaries. This is based on the protocol's design docs and diagrams. Please feel free to ask for clarifications!\n\n**What is the Duress Mechanism?**\nThe duress system allows users to signal coercion (e.g., being forced to sign a transaction) by entering a non-standard input during \"duress checks.\" These checks happen at key points like committing to a withdrawal or randomly during the process. If duress is signaled, the system silently sends a payload to SARs (trusted rescuers) to decrypt and use \"doxing data\" (personal info for location/recovery) to initiate a rescue, without changing observable behavior to tip off the attacker.\nKey actors:\n\n* **User**: Creates doxing data and a password; memorizes a \"consent set\" of 5 countries.\n\n* **SAR (Search and Rescue Entity)**: Holds encrypted doxing data; Once received a payload created after a positive duress signal, can decrypt and act on duress signals.\n\n* **Adversary**: Can capture/observe the user but can't break crypto or hardware security.\n\n\n**Doxing Data: The Rescue Payload**\nDoxing data helps SAR locate and rescue the user:\n\n* **Static Data**: Fixed info like name, ID, addresses, phone numbers, and trusted contacts (encrypted with doxing_key = SHA256(doxing_password)). Sent to SAR during setup.\n\n* **Dynamic Data**: Real-time feeds (e.g., phone location) encrypted and updated continuously.\n\nOn duress, Boomlet (hardware wallet) sends the doxing_key (encrypted for SAR) in message payloads. SAR decrypts, hashes to identify the user, and starts rescue ops.\n\n**Core Concepts**\n\n* **Consent Set**: 5 unique countries (no order) chosen by the user during setup. Matching this set means \"no duress\"; any other combination signals duress.\n\n* **Country Mapping**: Based on 195 countries (UN-like list) sorted alphabetically (1 = Afghanistan, ..., 195 = Zimbabwe).\n\n* **Duress Checks**: Boomlet generates 5 random lists of 1-195 numbers; ST (Secure Terminal) maps to countries and displays as columns. User selects one per column.\n\n* **Plausible Deniability**: Under torture, user can reveal any 5 countries as the \"consent set\"\u2014attacker can't verify without risking a real duress signal.\n\nProbability of random guess succeeding: \\~3.73e-12 (1 in 267 billion), making blind attacks infeasible.\n\n**Setup Process**\nDone via isolated devices (Iso, Boomlet, ST) with QR codes for secure, air-gapped comms:\n\n* Boomlet and ST exchange identity pubkeys via Iso/QR to establish shared ECDH key (AES encryption).\n\n* Boomlet generates random list \\[1-195\\], encrypts, sends via Iso/QR to ST.\n\n* ST decrypts, maps to countries (alphabetical), displays list.\n\n* User selects 5 countries via joystick (memorizes names); ST records indices, encrypts, sends back via QR/Iso.\n\n* Boomlet decrypts, extracts numbers as consent_set.\n\n* Confirmation: Boomlet sends 5 new random lists; user re-selects to match consent_set. Mismatch? Retry or restart.\n\nAfter setup, user only remembers 5 country names; system stores numbers securely.\n\n**Runtime Process (e.g., During Withdrawal)**\nChecks triggered by Boomlet (at commitment or PRNG-based random intervals):\n\n* Boomlet generates 5 random \\[1-195\\] lists, encrypts, sends via Niso/QR to ST.\n\n* ST decrypts, maps to country columns, displays on small monitor.\n\n* User selects one country per column via joystick (hidden from observer).\n\n* ST encrypts indices, sends back via QR/Niso to Boomlet.\n\n* Boomlet decrypts, extracts numbers, compares to consent_set:\n\n  * Match = No duress: Encrypts all-zeroes payload for SAR.\n\n  * Mismatch = Duress: Encrypts doxing_key for SAR.\n\n* Payload embedded in next withdrawal message to Watchtower (WT).\n\n* WT forwards payload to SAR.\n\n* SAR decrypts:\n\n  * All zeroes? Ignore (no duress).\n\n  * Else? Hash to doxing_identifier, search database, decrypt doxing data, start rescue.\n\n  * Malformed? Increment counter; if threshold hit, halt protocol.\n\n* SAR signs/acknowledges back to WT/Boomlet for verification.\n\nOnce duress is signaled, all future messages carry it. Persistent alert.\n\n**Security Features and Attacker Assumptions**\nCovers forced transactions or continued signing under compromise. Resistant to:\n\n* Replay attacks (fresh random lists each time).\n\n* Typos (set-based, order-insensitive).\n\n* Observation (ST's small screen + hidden input).\n\nAttacker can:\n\n* Capture/observe user, read plain messages, act as user, destroy hardware.\n\nBut cannot:\n\n* Break JavaCard security, crypto, or observe ST input without seeing screen + hands simultaneously.\n\n\nConsequences: No observable changes on duress (plausible deniability); withdrawal proceeds normally but SAR is alerted.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 1070,
  "hidden": false,
  "trust_level": 0,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Duress Mechanism in the Boomerang Protocol: Protecting Users Under Coercion \nHey everyone, diving deeper into the Boomerang protocol\u2019s security features, here\u2019s a detailed breakdown of the duress mechanism. This is a system designed to let users signal distress discreetly during withdrawals, without&hellip;",
  "truncated": true,
  "post_url": "/t/boomerang-bitcoin-cold-storage-with-built-in-coercion-resistance/2239/2",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}