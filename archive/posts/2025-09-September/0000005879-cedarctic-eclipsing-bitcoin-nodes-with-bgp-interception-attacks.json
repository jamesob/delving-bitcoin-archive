{
  "id": 5879,
  "name": "",
  "username": "cedarctic",
  "avatar_template": "/letter_avatar_proxy/v4/letter/c/3d9bf3/{size}.png",
  "created_at": "2025-09-15T18:35:17.103Z",
  "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"gmaxwell\" data-post=\"5\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/g/fbc32d/48.png\" class=\"avatar\"> gmaxwell:</div>\n<blockquote>\n<p>The key point of countersign, vs any authentication scheme proposed elsewhere [\u2026]</p>\n</blockquote>\n</aside>\n<p>I understand now your point on countersign making MITMing ineffective in this case and in the partitioning example.</p>\n<p>I was also thinking about scenarios where the attacker\u2019s goal is to censor TXs or blocks. For example, an attacker that intercepts the connections of a mining pool gateway could delay and drop traffic from the victim to its peers when a new block is found. This just requires the attacker to have a connection to the victim node to identify a new block, and be on path to drop / delay encrypted traffic that they intercept.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>IMO it should be noted for completeness that usage of BIP324 and StratumV2 is limiting the damage that an attacker can do if these attacks are explicitly named.</p>\n</blockquote>\n</aside>\n<p>Agreed - unfortunately I don\u2019t seem to have the option to edit my original post anymore.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Also I think the impact of alternative connection types like Tor or I2P would be interesting to evaluate. Having multiple tor peers may actually make the attack easier if the entry guard is being used consistently through out the attack. On the other hand, if there is one tor connection and multiple entry guards are used or rotated frequently then it makes it harder again.</p>\n</blockquote>\n</aside>\n<p>I agree, this would be interesting to look into. I\u2019m not very familiar with I2P, but as far as I understand, to evaluate this I would have to run an I2P router, build a copy of the NetDB and perform the above analysis again. I2P might be more resilient to this attack compared to Tor as it forms <a href=\"https://geti2p.net/en/docs/how/peer-selection\" rel=\"noopener nofollow ugc\">short lived tunnels using a larger set of peers</a>.</p>\n<p>Tor, on the other hand, by default uses a single entry guard node at any given time, which it <a href=\"https://torproject.gitlab.io/torspec/guard-spec.html\" rel=\"noopener nofollow ugc\">picks out of a set of 3 entry guards</a>. If I understand correctly, rotating guard nodes introduces a tradeoff: it makes this attack harder, but increases the chances of an attacker deanonymizing the circuit. Tor guard nodes seem to be more centralized than Bitcoin nodes, and <strong>~39% of them are potentially vulnerable to prefix hijack</strong> by virtue of them not being covered by RPKI or having overly permissive ROAs.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/f/fff045bce7a4500e6b24c51e06c983be3976ea1a.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/fff045bce7a4500e6b24c51e06c983be3976ea1a\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/2X/f/fff045bce7a4500e6b24c51e06c983be3976ea1a_2_690x411.png\" alt=\"image\" data-base62-sha1=\"Aw8xfieawfxEEtkZfWeh4XF9JoK\" width=\"690\" height=\"411\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/2X/f/fff045bce7a4500e6b24c51e06c983be3976ea1a_2_690x411.png, https://delvingbitcoin.org/uploads/default/optimized/2X/f/fff045bce7a4500e6b24c51e06c983be3976ea1a_2_1035x616.png 1.5x, https://delvingbitcoin.org/uploads/default/original/2X/f/fff045bce7a4500e6b24c51e06c983be3976ea1a.png 2x\" data-dominant-color=\"FBFBFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1187\u00d7708 39.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<aside class=\"quote no-group quote-modified\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>It\u2019s not clear to me from the write-up if this is the same AS that is mentioned in the requirements or if this is a second one. I guess 1. is just the classic way of trying to evict and starting from 2. this is what you suggest as a new style of attack. [\u2026]</p>\n</blockquote>\n</aside>\n<p>Clarifications: it is indeed the same AS, and that is right - step 1 is indeed the classic attack, and starting 2 is the new attack (eclipsing via interceptions). I\u2019ll make the suggested edits in any future revised writeups, since I can\u2019t edit the original post.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>I am not a network engineer and I don\u2019t know what detection mechanisms there might be triggered but I would expect that being much more aggressive should yield higher success probability.</p>\n</blockquote>\n</aside>\n<p>I am not aware of any widespread detection mechanism beyond ROA/RPKI and custom filters / monitoring that is employed in practice by network operators, but I will look into it a bit more. Being more aggressive is advantageous for the adversary, but features related to the volume of announcements have previously been proposed in the literature for anomaly detection (<a href=\"https://www.researchgate.net/profile/Bahaa-Al-Musawi/publication/309519246_BGP_Anomaly_Detection_Techniques_A_Survey/links/59de2577aca27247d7941ec2/BGP-Anomaly-Detection-Techniques-A-Survey.pdf\" rel=\"noopener nofollow ugc\">see Table III</a>).</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>A well organized attacker might do some probing</p>\n</blockquote>\n</aside>\n<p>This sounds interesting, what kind of probing do you have in mind?</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Side-note: I would be interested in that AS relationship dataset from CAIDA</p>\n</blockquote>\n</aside>\n<p><a href=\"https://www.caida.org/catalog/datasets/as-relationships/\" rel=\"noopener nofollow ugc\">The link</a> works now! <img src=\"https://delvingbitcoin.org/images/emoji/twitter/eyes.png?v=14\" title=\":eyes:\" class=\"emoji\" alt=\":eyes:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>I think Cons should mention that this also makes the classic eclipse attack easier in some ways because the attacker has more chances to become get into connection slots, right?</p>\n</blockquote>\n</aside>\n<p>This does make it easier for the attacker to get into outbound connection slots, but as far as I understand, this does not make it make it much easier for the attacker to poison addrman\u2019s tables since outbound and inbound connections seem to be treated equally with regards to received ADDR messages in <code>net_processing.cpp</code>.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>It might be interesting to check if quickest ping response correlates well enough with shortest path so that this could replace needing to do traceroutes.</p>\n</blockquote>\n</aside>\n<p>There seems to be a weak correlation between the two:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/2X/9/9508b187718f3b1df5dcb4bb6231eb0b6e663dad.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/9508b187718f3b1df5dcb4bb6231eb0b6e663dad\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/2X/9/9508b187718f3b1df5dcb4bb6231eb0b6e663dad_2_690x438.png\" alt=\"image\" data-base62-sha1=\"lgpLFb2woRkOUraB9o0xIfO8Dzn\" width=\"690\" height=\"438\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/2X/9/9508b187718f3b1df5dcb4bb6231eb0b6e663dad_2_690x438.png, https://delvingbitcoin.org/uploads/default/optimized/2X/9/9508b187718f3b1df5dcb4bb6231eb0b6e663dad_2_1035x657.png 1.5x, https://delvingbitcoin.org/uploads/default/original/2X/9/9508b187718f3b1df5dcb4bb6231eb0b6e663dad.png 2x\" data-dominant-color=\"F8F9FA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1057\u00d7671 48.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Hm, but this would require periodic traceroutes on the peers that we are connected to as well not just candidates, right?</p>\n</blockquote>\n</aside>\n<p>Rotating peers whose paths have changed might be a good heuristic, I\u2019ll also think on this some more.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>This also could make the classic eclipse attack easier if the attacker can create some nodes in \u201cexotic\u201d locations (of the internet).</p>\n</blockquote>\n</aside>\n<p>That\u2019s true, it\u2019s something that an attacker might seek to game. I\u2019ll have to think more on this.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Can detection be avoided with tunneling and if so what else do we have to do to detect that?</p>\n</blockquote>\n</aside>\n<p>An attacker can evade detection by tunneling if they peer with an AS on the \u201ccommon stem\u201d of ASes that all traffic traverses out of the victim AS. For instance assume that all traffic from the victim flows from AS A (source) to B1 and on the second hop to ASes C1, C2. The attacker AS X uses AS B1 as a provider, and tunnels traffic to C1 and C2. It also does not decrease the TTL field on packets used for traceroute. This makes X invisible in the trace. If however, the victim node had peers in B2, the attack would be obvious, as the observed trace would change from A \u2192 B2 to A \u2192 B1 \u2192 B2 since the attacker cannot prevent B1 from appearing in the trace via tunneling. Detecting tunneling attackers could perhaps be done by observing other signals, such as new router IPs appearing in the trace (e.g the border router in B1 that connects to X might differ from the one that connects to C1).</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>And assuming traceroute itself works reasonably well, what would we do with connections if an anomaly is detected?</p>\n</blockquote>\n</aside>\n<p>As a reactive measure (versus the proactive ones in the post), if we detect route consolidation through a common (potentially adversarial) AS, we perform more traceroutes to peers in our tables trying to find candidates whose routes do not cross the attacker AS.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>I think you could propose some basic decision tree [\u2026]</p>\n</blockquote>\n</aside>\n<p>I think that\u2019s a good idea. I\u2019ll think on this and try to put something together to share.</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Also, afaict you are only proposing to use traceroute to detect outbound connection hijacks. If inbound is targeted instead we would need to use some other vantage point or so?</p>\n</blockquote>\n</aside>\n<p>We can use traceroutes for detecting interception attacks of egress traffic for both inbound and outbound connections. If we want to detect the interception of ingress traffic we would need cooperation from external vantage points or the node to which we are connected.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>I think the first thing that could be done would be to raise further awareness [\u2026]</p>\n</blockquote>\n</aside>\n<p>Agreed, this is important and immediately actionable. Have there been any similar efforts in raising awareness in bitcoin optech that I can look into?</p>\n<aside class=\"quote no-group\" data-username=\"fjahr\" data-post=\"6\" data-topic=\"1965\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/letter_avatar_proxy/v4/letter/f/ea5d25/48.png\" class=\"avatar\"> fjahr:</div>\n<blockquote>\n<p>Quantifying that for the current adoption of ASPA and maybe a projected adoption a year from now would be very interesting. So this would also fit in with your prevention \u201cFavor peers in protected prefixes\u201d.</p>\n</blockquote>\n</aside>\n<p>Thank you for the references. I ran the prefix analysis again: Currently, no node prefixes are covered by an ASPA object. I\u2019ll look into how we can model ASPA adoption and reason about the level of security it will offer against this attack.</p>\n<details>\n<summary>\nCorrection on ASPA analysis</summary>\n<p>Previously this post mistakenly mentioned that 0.5% of node prefixes are covered by an ASPA object. This was for Tor node prefixes, not bitcoin. Even then, for all of the supporting ASNs there is at least 1 provider that does not issue an ASPA, meaning that the attacker can still perform a shorter path attack without incurring too big of an AS_PATH length penalty.</p>\n</details>",
  "post_number": 7,
  "post_type": 1,
  "posts_count": 9,
  "updated_at": "2025-09-16T13:04:35.127Z",
  "reply_count": 1,
  "reply_to_post_number": 5,
  "quote_count": 2,
  "incoming_link_count": 1,
  "reads": 36,
  "readers_count": 35,
  "score": 17.2,
  "yours": false,
  "topic_id": 1965,
  "topic_slug": "eclipsing-bitcoin-nodes-with-bgp-interception-attacks",
  "topic_title": "Eclipsing Bitcoin Nodes with BGP Interception Attacks",
  "topic_html_title": "Eclipsing Bitcoin Nodes with BGP Interception Attacks",
  "category_id": 7,
  "display_username": "",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 3,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"gmaxwell, post:5, topic:1965\"]\nThe key point of countersign, vs any authentication scheme proposed elsewhere \\[\u2026\\]\n\n[/quote]\n\nI understand now your point on countersign making MITMing ineffective in this case and in the partitioning example.\n\nI was also thinking about scenarios where the attacker\u2019s goal is to censor TXs or blocks. For example, an attacker that intercepts the connections of a mining pool gateway could delay and drop traffic from the victim to its peers when a new block is found. This just requires the attacker to have a connection to the victim node to identify a new block, and be on path to drop / delay encrypted traffic that they intercept.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nIMO it should be noted for completeness that usage of BIP324 and StratumV2 is limiting the damage that an attacker can do if these attacks are explicitly named.\n\n[/quote]\n\nAgreed - unfortunately I don\u2019t seem to have the option to edit my original post anymore.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nAlso I think the impact of alternative connection types like Tor or I2P would be interesting to evaluate. Having multiple tor peers may actually make the attack easier if the entry guard is being used consistently through out the attack. On the other hand, if there is one tor connection and multiple entry guards are used or rotated frequently then it makes it harder again.\n\n[/quote]\n\nI agree, this would be interesting to look into. I\u2019m not very familiar with I2P, but as far as I understand, to evaluate this I would have to run an I2P router, build a copy of the NetDB and perform the above analysis again. I2P might be more resilient to this attack compared to Tor as it forms [short lived tunnels using a larger set of peers](https://geti2p.net/en/docs/how/peer-selection).\n\nTor, on the other hand, by default uses a single entry guard node at any given time, which it [picks out of a set of 3 entry guards](https://torproject.gitlab.io/torspec/guard-spec.html). If I understand correctly, rotating guard nodes introduces a tradeoff: it makes this attack harder, but increases the chances of an attacker deanonymizing the circuit. Tor guard nodes seem to be more centralized than Bitcoin nodes, and **\\~39% of them are potentially vulnerable to prefix hijack** by virtue of them not being covered by RPKI or having overly permissive ROAs.\n\n![image|690x411](upload://Aw8xfieawfxEEtkZfWeh4XF9JoK.png)\n\n[quote=\"fjahr, post:6, topic:1965\"]\nIt\u2019s not clear to me from the write-up if this is the same AS that is mentioned in the requirements or if this is a second one. I guess 1. is just the classic way of trying to evict and starting from 2. this is what you suggest as a new style of attack. \\[\u2026\\]\n\n[/quote]\n\nClarifications: it is indeed the same AS, and that is right - step 1 is indeed the classic attack, and starting 2 is the new attack (eclipsing via interceptions). I\u2019ll make the suggested edits in any future revised writeups, since I can\u2019t edit the original post.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nI am not a network engineer and I don\u2019t know what detection mechanisms there might be triggered but I would expect that being much more aggressive should yield higher success probability.\n\n[/quote]\n\nI am not aware of any widespread detection mechanism beyond ROA/RPKI and custom filters / monitoring that is employed in practice by network operators, but I will look into it a bit more. Being more aggressive is advantageous for the adversary, but features related to the volume of announcements have previously been proposed in the literature for anomaly detection ([see Table III](https://www.researchgate.net/profile/Bahaa-Al-Musawi/publication/309519246_BGP_Anomaly_Detection_Techniques_A_Survey/links/59de2577aca27247d7941ec2/BGP-Anomaly-Detection-Techniques-A-Survey.pdf)).\n\n[quote=\"fjahr, post:6, topic:1965\"]\nA well organized attacker might do some probing\n\n[/quote]\n\nThis sounds interesting, what kind of probing do you have in mind?\n\n[quote=\"fjahr, post:6, topic:1965\"]\nSide-note: I would be interested in that AS relationship dataset from CAIDA\n\n[/quote]\n\n[The link](https://www.caida.org/catalog/datasets/as-relationships/) works now! \ud83d\udc40\n\n[quote=\"fjahr, post:6, topic:1965\"]\nI think Cons should mention that this also makes the classic eclipse attack easier in some ways because the attacker has more chances to become get into connection slots, right?\n\n[/quote]\n\nThis does make it easier for the attacker to get into outbound connection slots, but as far as I understand, this does not make it make it much easier for the attacker to poison addrman\u2019s tables since outbound and inbound connections seem to be treated equally with regards to received ADDR messages in `net_processing.cpp`.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nIt might be interesting to check if quickest ping response correlates well enough with shortest path so that this could replace needing to do traceroutes.\n\n[/quote]\n\nThere seems to be a weak correlation between the two:\n\n![image|690x438](upload://lgpLFb2woRkOUraB9o0xIfO8Dzn.png)\n\n[quote=\"fjahr, post:6, topic:1965\"]\nHm, but this would require periodic traceroutes on the peers that we are connected to as well not just candidates, right?\n\n[/quote]\n\nRotating peers whose paths have changed might be a good heuristic, I\u2019ll also think on this some more.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nThis also could make the classic eclipse attack easier if the attacker can create some nodes in \u201cexotic\u201d locations (of the internet).\n\n[/quote]\n\nThat\u2019s true, it\u2019s something that an attacker might seek to game. I\u2019ll have to think more on this.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nCan detection be avoided with tunneling and if so what else do we have to do to detect that?\n\n[/quote]\n\nAn attacker can evade detection by tunneling if they peer with an AS on the \u201ccommon stem\u201d of ASes that all traffic traverses out of the victim AS. For instance assume that all traffic from the victim flows from AS A (source) to B1 and on the second hop to ASes C1, C2. The attacker AS X uses AS B1 as a provider, and tunnels traffic to C1 and C2. It also does not decrease the TTL field on packets used for traceroute. This makes X invisible in the trace. If however, the victim node had peers in B2, the attack would be obvious, as the observed trace would change from A \u2192 B2 to A \u2192 B1 \u2192 B2 since the attacker cannot prevent B1 from appearing in the trace via tunneling. Detecting tunneling attackers could perhaps be done by observing other signals, such as new router IPs appearing in the trace (e.g the border router in B1 that connects to X might differ from the one that connects to C1).\n\n[quote=\"fjahr, post:6, topic:1965\"]\nAnd assuming traceroute itself works reasonably well, what would we do with connections if an anomaly is detected?\n\n[/quote]\n\nAs a reactive measure (versus the proactive ones in the post), if we detect route consolidation through a common (potentially adversarial) AS, we perform more traceroutes to peers in our tables trying to find candidates whose routes do not cross the attacker AS.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nI think you could propose some basic decision tree \\[\u2026\\]\n\n[/quote]\n\nI think that\u2019s a good idea. I\u2019ll think on this and try to put something together to share.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nAlso, afaict you are only proposing to use traceroute to detect outbound connection hijacks. If inbound is targeted instead we would need to use some other vantage point or so?\n\n[/quote]\n\nWe can use traceroutes for detecting interception attacks of egress traffic for both inbound and outbound connections. If we want to detect the interception of ingress traffic we would need cooperation from external vantage points or the node to which we are connected.\n\n[quote=\"fjahr, post:6, topic:1965\"]\nI think the first thing that could be done would be to raise further awareness \\[\u2026\\]\n\n[/quote]\n\nAgreed, this is important and immediately actionable. Have there been any similar efforts in raising awareness in bitcoin optech that I can look into?\n\n[quote=\"fjahr, post:6, topic:1965\"]\nQuantifying that for the current adoption of ASPA and maybe a projected adoption a year from now would be very interesting. So this would also fit in with your prevention \u201cFavor peers in protected prefixes\u201d.\n\n[/quote]\n\nThank you for the references. I ran the prefix analysis again: Currently, no node prefixes are covered by an ASPA object. I\u2019ll look into how we can model ASPA adoption and reason about the level of security it will offer against this attack.\n\n[details=\"Correction on ASPA analysis\"]\nPreviously this post mistakenly mentioned that 0.5% of node prefixes are covered by an ASPA object. This was for Tor node prefixes, not bitcoin. Even then, for all of the supporting ASNs there is at least 1 provider that does not issue an ASPA, meaning that the attacker can still perform a shorter path attack without incurring too big of an AS_PATH length penalty.\n\n[/details]",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 894,
  "hidden": false,
  "trust_level": 1,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I understand now your point on countersign making MITMing ineffective in this case and in the partitioning example. \nI was also thinking about scenarios where the attacker\u2019s goal is to censor TXs or blocks. For example, an attacker that intercepts the connections of a mining pool gateway could dela&hellip;",
  "truncated": true,
  "post_url": "/t/eclipsing-bitcoin-nodes-with-bgp-interception-attacks/1965/7",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}