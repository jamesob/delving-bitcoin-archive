{
  "id": 1315,
  "name": "Gregory Sanders",
  "username": "instagibbs",
  "avatar_template": "/user_avatar/delvingbitcoin.org/instagibbs/{size}/28_2.png",
  "created_at": "2024-01-23T17:15:37.327Z",
  "cooked": "<p>Thinking more about how precisely this would be implemented as I think this can be made simpler, but posting my draft to give the idea:</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"7\" data-topic=\"383\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/3_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>That diagram doesn\u2019t make sense to me: all the txs pay a non-zero fee, so presumably none of them have ephemeral anchor outputs?</p>\n</blockquote>\n</aside>\n<p>Ok everything I said was wrong in last post; I think it all works. Let me try again with diagrams which I should have been making earlier:</p>\n<p>When an ephemeral anchor spend is evaluated against <code>TxA</code>:</p>\n<pre data-code-height=\"237\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">flowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --&gt; B[TxB: fee 1100\\nsize 200]\n</code></pre>\n<p>We simulate/induce an RBF against a  65byte OP_RETURN tx:</p>\n<pre data-code-height=\"237\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">flowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --&gt; C[TxC: fee 1000\\nsize 65\\npure burn]\n</code></pre>\n<p>which results in a diagram check:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/722217ece5a8b0835b09d3c00cc6827711b339b7.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/722217ece5a8b0835b09d3c00cc6827711b339b7\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/722217ece5a8b0835b09d3c00cc6827711b339b7_2_567x500.png\" alt=\"image\" data-base62-sha1=\"ghFtxMfe4Hus4lrm7NdHrqUFtNJ\" width=\"567\" height=\"500\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/722217ece5a8b0835b09d3c00cc6827711b339b7_2_567x500.png, https://delvingbitcoin.org/uploads/default/original/1X/722217ece5a8b0835b09d3c00cc6827711b339b7.png 1.5x, https://delvingbitcoin.org/uploads/default/original/1X/722217ece5a8b0835b09d3c00cc6827711b339b7.png 2x\" data-dominant-color=\"E2E1E1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">660\u00d7581 27.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>As you can see, even though the total fees are higher, it doesn\u2019t dominate the pure burn, so it would be rejected. The \u201cpure burn\u201d case would of course be accepted, since we would not be doing an incremental relay check.</p>\n<p>If instead the proposed spend looked like:</p>\n<pre data-code-height=\"214\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">flowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --&gt; B[TxB: fee 1400\\nsize 200]\n</code></pre>\n<p>we get:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://delvingbitcoin.org/uploads/default/original/1X/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1.png\" data-download-href=\"https://delvingbitcoin.org/uploads/default/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1\" title=\"image\"><img src=\"https://delvingbitcoin.org/uploads/default/optimized/1X/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1_2_567x500.png\" alt=\"image\" data-base62-sha1=\"8eY0eejmLcGuLDAguZHj9DAQ1xv\" width=\"567\" height=\"500\" srcset=\"https://delvingbitcoin.org/uploads/default/optimized/1X/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1_2_567x500.png, https://delvingbitcoin.org/uploads/default/original/1X/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1.png 1.5x, https://delvingbitcoin.org/uploads/default/original/1X/39c288ca0e1c1da5eb1946bfedffb9dc0b6dbca1.png 2x\" data-dominant-color=\"E2E1E1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">660\u00d7581 27 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>and this would be accepted.</p>",
  "post_number": 8,
  "post_type": 1,
  "updated_at": "2024-01-23T17:15:37.327Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 15,
  "readers_count": 14,
  "score": 47.8,
  "yours": false,
  "topic_id": 383,
  "topic_slug": "ephemeral-anchors-and-mevil",
  "topic_title": "Ephemeral Anchors and MEVil",
  "topic_html_title": "Ephemeral Anchors and MEVil",
  "category_id": 7,
  "display_username": "Gregory Sanders",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Thinking more about how precisely this would be implemented as I think this can be made simpler, but posting my draft to give the idea:\n\n\n[quote=\"ajtowns, post:7, topic:383\"]\nThat diagram doesn\u2019t make sense to me: all the txs pay a non-zero fee, so presumably none of them have ephemeral anchor outputs?\n[/quote]\n\nOk everything I said was wrong in last post; I think it all works. Let me try again with diagrams which I should have been making earlier:\n\nWhen an ephemeral anchor spend is evaluated against `TxA`:\n```mermaid height=237,auto\nflowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --> B[TxB: fee 1100\\nsize 200]\n```\n\nWe simulate/induce an RBF against a  65byte OP_RETURN tx:\n```mermaid height=237,auto\nflowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --> C[TxC: fee 1000\\nsize 65\\npure burn]\n```\nwhich results in a diagram check:\n\n![image|567x500](upload://ghFtxMfe4Hus4lrm7NdHrqUFtNJ.png)\n\nAs you can see, even though the total fees are higher, it doesn't dominate the pure burn, so it would be rejected. The \"pure burn\" case would of course be accepted, since we would not be doing an incremental relay check.\n\nIf instead the proposed spend looked like:\n\n```mermaid height=214,auto\nflowchart TD\n    A[TxA: fee 0\\nsize 300\\n1000 sats in anchor] --> B[TxB: fee 1400\\nsize 200]\n```\n\nwe get:  \n![image|567x500](upload://8eY0eejmLcGuLDAguZHj9DAQ1xv.png)\n\nand this would be accepted.",
  "actions_summary": [
    {
      "id": 2,
      "count": 1
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 31,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 1
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 1,
  "current_user_used_main_reaction": false
}