{
  "id": 1374,
  "name": "",
  "username": "amiti",
  "avatar_template": "/letter_avatar_proxy/v4/letter/a/e5b9ba/{size}.png",
  "created_at": "2024-01-29T22:41:00.411Z",
  "cooked": "<p><span class=\"mention\">@maxedwards</span> here are my thoughts from trying to wrap my head around these questions. Thanks to AJ for helping steer me in the right direction. Let me know if this generally makes sense, or if you have any additional questions.</p>\n<p>The crux of our question is - \u201cwhat should the tx relay rate be\u201c. To answer this question we want to know- what is safe &amp; what is efficient.</p>\n<p>For each transaction that a user submits to the network, asymmetric bandwidth usage is required for the transaction to propagate to the entire network. Without mitigations, network bandwidth could be intentionally abused or accidentally overused. The minimum fee rate helps mitigate these problems by preventing \u201cfree relay\u201d attacks and ensuring that bandwidth usage has a minimum cost in satoshis. The tx relay rate is also important, because it essentially limits the multiplier of each node on incoming traffic to outgoing traffic. Currently, every transaction we see will INV every other node (which would change if we adopt erlay).</p>\n<p>One one side: if the tx relay rate didn\u2019t exist or was too high, an attacker can pay the minimum fee rate to use greater than [num nodes on network] x [size of txn] amount of bandwidth on the whole network.</p>\n<p>On the other side: if the tx relay is too low, transaction propagation is laggy, and there will be dramatic differences in the mempools of different nodes. The rate being \u201ctoo low\u201d is in relationship to the (tx creation - block creation) rate, aka how many txs are hanging out in the mempool over time.</p>\n<p>We care the most about the top 1MB of the mempool being synchronized, so miners can have the information to confirm transactions paying the highest fee rate. The relay rate is effective because it is implemented with topological fee rate sorting, prioritizing which transactions are worthy of using the network bandwidth based on what is most likely to make it into a block.</p>\n<p>When trying to test &amp; evaluate if we should increase the tx relay rate, it seems very challenging to observe what \u201ctoo high\u201d looks like. However, it seems more tangible to observe \u201ctoo low\u201d, by seeing the top-of-mempools be significantly out of sync. One way to do this would be to have each mempool calculate a block and compare the contents, but this would be resource intensive. So a simpler heuristic is looking at the compact block logging because this indicates how many transactions need to be requested to complete the block aka indicators of top of mempool synchronization.</p>\n<p>Since the PR is proposing increasing the relay rate, the strongest support this strategy can offer is evidence that the current tx relay rate is too low for certain network conditions - especially since we have seen more mempool activity in recent months. So, I believe this is what we should be aiming for.</p>\n<p>Two additional notes on warnet implementation strategy:</p>\n<ul>\n<li>if transactions are being created with a random fee rate distribution, that is probably a bit different than what we naturally see out in the wild. on mainnet we usually see tx fee rate rising as the mempool getting more full. this is relevant because we\u2019ve identified <em>synchronization of the top of mempool</em> as a key metric. txs with random fee rates will organically lead to a stronger synchronization of top-of-mempool in a short amount of time, while increasing fee rates will see stronger divergences in short time intervals.</li>\n<li>RE RBF: I believe this is a strategy to create many transactions with a limited set of UTXOs. I don\u2019t think we need RBF transactions if that\u2019s not an issue.</li>\n</ul>",
  "post_number": 11,
  "post_type": 1,
  "updated_at": "2024-01-29T22:41:00.411Z",
  "reply_count": 0,
  "reply_to_post_number": 10,
  "quote_count": 0,
  "incoming_link_count": 1,
  "reads": 5,
  "readers_count": 4,
  "score": 6.0,
  "yours": false,
  "topic_id": 294,
  "topic_slug": "warnet-increase-tx-relay-rate",
  "topic_title": "Warnet + Increase Tx Relay Rate",
  "topic_html_title": "Warnet + Increase Tx Relay Rate",
  "category_id": 8,
  "display_username": "",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "reply_to_user": {
    "username": "m3dwards",
    "name": "Max Edwards",
    "avatar_template": "/user_avatar/delvingbitcoin.org/m3dwards/{size}/148_2.png"
  },
  "bookmarked": false,
  "raw": "@maxedwards here are my thoughts from trying to wrap my head around these questions. Thanks to AJ for helping steer me in the right direction. Let me know if this generally makes sense, or if you have any additional questions. \n\nThe crux of our question is - \u201cwhat should the tx relay rate be\u201c. To answer this question we want to know- what is safe & what is efficient. \n\nFor each transaction that a user submits to the network, asymmetric bandwidth usage is required for the transaction to propagate to the entire network. Without mitigations, network bandwidth could be intentionally abused or accidentally overused. The minimum fee rate helps mitigate these problems by preventing \u201cfree relay\u201d attacks and ensuring that bandwidth usage has a minimum cost in satoshis. The tx relay rate is also important, because it essentially limits the multiplier of each node on incoming traffic to outgoing traffic. Currently, every transaction we see will INV every other node (which would change if we adopt erlay). \n\nOne one side: if the tx relay rate didn\u2019t exist or was too high, an attacker can pay the minimum fee rate to use greater than [num nodes on network] x [size of txn] amount of bandwidth on the whole network. \n\nOn the other side: if the tx relay is too low, transaction propagation is laggy, and there will be dramatic differences in the mempools of different nodes. The rate being \u201ctoo low\u201d is in relationship to the (tx creation - block creation) rate, aka how many txs are hanging out in the mempool over time. \n\nWe care the most about the top 1MB of the mempool being synchronized, so miners can have the information to confirm transactions paying the highest fee rate. The relay rate is effective because it is implemented with topological fee rate sorting, prioritizing which transactions are worthy of using the network bandwidth based on what is most likely to make it into a block. \n\nWhen trying to test & evaluate if we should increase the tx relay rate, it seems very challenging to observe what \u201ctoo high\u201d looks like. However, it seems more tangible to observe \u201ctoo low\u201d, by seeing the top-of-mempools be significantly out of sync. One way to do this would be to have each mempool calculate a block and compare the contents, but this would be resource intensive. So a simpler heuristic is looking at the compact block logging because this indicates how many transactions need to be requested to complete the block aka indicators of top of mempool synchronization. \n\nSince the PR is proposing increasing the relay rate, the strongest support this strategy can offer is evidence that the current tx relay rate is too low for certain network conditions - especially since we have seen more mempool activity in recent months. So, I believe this is what we should be aiming for.\n\nTwo additional notes on warnet implementation strategy: \n\n- if transactions are being created with a random fee rate distribution, that is probably a bit different than what we naturally see out in the wild. on mainnet we usually see tx fee rate rising as the mempool getting more full. this is relevant because we\u2019ve identified *synchronization of the top of mempool* as a key metric. txs with random fee rates will organically lead to a stronger synchronization of top-of-mempool in a short amount of time, while increasing fee rates will see stronger divergences in short time intervals.\n- RE RBF: I believe this is a strategy to create many transactions with a limited set of UTXOs. I don\u2019t think we need RBF transactions if that\u2019s not an issue.",
  "actions_summary": [],
  "moderator": true,
  "admin": false,
  "staff": true,
  "user_id": 4,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}