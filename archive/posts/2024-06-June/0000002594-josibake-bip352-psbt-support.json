{
  "id": 2594,
  "name": "josie",
  "username": "josibake",
  "avatar_template": "/user_avatar/delvingbitcoin.org/josibake/{size}/83_2.png",
  "created_at": "2024-06-01T18:04:52.150Z",
  "cooked": "<aside class=\"quote no-group\" data-username=\"andrewtoth\" data-post=\"8\" data-topic=\"877\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/andrewtoth/48/576_2.png\" class=\"avatar\"> andrewtoth:</div>\n<blockquote>\n<p>If we can\u2019t have a running proof sum, the PSBT will have worst case inputs * outputs number of proofs. This could be too much data for coinjoins, but should be fine for regular transactions.</p>\n</blockquote>\n</aside>\n<p>Thinking about this more, we only need a proof for each input, i.e. a proof that the secret key used to create the ECDH share <span class=\"math\">a\\cdot B_{scan}</span> is the same key for <span class=\"math\">a\\cdot G=A</span>.</p>\n<p>We don\u2019t need a proof for each output because the software wallet simply needs to check the proof for each input and then sum up the ECDH shares and verify the outputs, i.e.</p>\n<div class=\"math\">\nSS = a_1\\cdot B_{scan} + .. + a_n\\cdot B_scan \\\\\nP = B_{spend} + hash_{BIP0352/SharedSecret}(SS || k)\\cdot G \\\\\nP \\in \\texttt{txoutputs}\n</div>\n<p>If a single signer has access to all of the silent payment private keys and is able to generate the outputs and sign the transaction, the signer can omit the per input proofs and instead provide a transaction level proof that <span class=\"math\">a_{sum}\\cdot B_{scan}</span> is the same key as <span class=\"math\">a_{sum}\\cdot G = A_{sum}</span>, along with the shared secret <span class=\"math\">SS</span>, allowing the software wallet to verify the proof and calculate</p>\n<div class=\"math\">\nP = B_{spend} + hash_{BIP0352/SharedSecret}(SS || k)\\cdot G \\\\\nP \\in \\texttt{txoutputs}\n</div>\n<p>same as above.</p>",
  "post_number": 9,
  "post_type": 1,
  "updated_at": "2024-06-01T18:04:52.150Z",
  "reply_count": 0,
  "reply_to_post_number": 8,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 4,
  "readers_count": 3,
  "score": 0.6,
  "yours": false,
  "topic_id": 877,
  "topic_slug": "bip352-psbt-support",
  "topic_title": "BIP352: PSBT support",
  "topic_html_title": "BIP352: PSBT support",
  "category_id": 12,
  "display_username": "josie",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "[quote=\"andrewtoth, post:8, topic:877\"]\nIf we can\u2019t have a running proof sum, the PSBT will have worst case inputs * outputs number of proofs. This could be too much data for coinjoins, but should be fine for regular transactions.\n[/quote]\n\nThinking about this more, we only need a proof for each input, i.e. a proof that the secret key used to create the ECDH share $a\\cdot B_{scan}$ is the same key for $a\\cdot G=A$.\n\nWe don't need a proof for each output because the software wallet simply needs to check the proof for each input and then sum up the ECDH shares and verify the outputs, i.e. \n\n$$\nSS = a_1\\cdot B_{scan} + .. + a_n\\cdot B_scan \\\\\nP = B_{spend} + hash_{BIP0352/SharedSecret}(SS || k)\\cdot G \\\\\nP \\in \\texttt{txoutputs}\n$$\n\nIf a single signer has access to all of the silent payment private keys and is able to generate the outputs and sign the transaction, the signer can omit the per input proofs and instead provide a transaction level proof that $a_{sum}\\cdot B_{scan}$ is the same key as $a_{sum}\\cdot G = A_{sum}$, along with the shared secret $SS$, allowing the software wallet to verify the proof and calculate\n\n$$\nP = B_{spend} + hash_{BIP0352/SharedSecret}(SS || k)\\cdot G \\\\\nP \\in \\texttt{txoutputs}\n$$\n\nsame as above.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 92,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}