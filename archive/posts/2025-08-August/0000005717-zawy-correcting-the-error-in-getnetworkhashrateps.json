{
  "id": 5717,
  "name": "Zawy",
  "username": "zawy",
  "avatar_template": "/user_avatar/delvingbitcoin.org/zawy/{size}/750_2.png",
  "created_at": "2025-08-15T11:24:31.467Z",
  "cooked": "<p>I believe this is the best-possible estimate of <em>current</em> hashrate for an arbitrarily-small fixed time period t when given only the lowest hash seen in t.</p>\n<p><span class=\"math\">L = \\text{lowest hash seen in time t}</span></p>\n<p><span class=\"math\">W = \\text{work in t}</span></p>\n<p><span class=\"math\">\\lambda = \\frac{W}{2^{256}}</span></p>\n<p><span class=\"math\">\\text{exponential CDF}(L) = 1 - e^{-\\lambda L}</span></p>\n<p><span class=\"math\">E = \\text{error signal} = \\text{CDF}(L) - 0.5</span></p>\n<p>The error signal is the probability that the prior estimate of W was wrong. 0.5 is the median observation if the prior estimate was correct, so there would be no error. Use the error signal in the EMA equation.</p>\n<p><span class=\"math\">h = \\text{height of t time segments}</span></p>\n<p><span class=\"math\">W_{h} = W_{h-1} \\cdot e^{-\\frac{E}{N}}</span></p>\n<p><span class=\"math\">\\text{Stdev} \\approx \\frac{W}{\\sqrt{2N}}</span></p>\n<p>N = \u201cmean lifetime\u201d of the EMA estimate in units of t. You choose N to get your desired stability / slowness of the estimate.  Divide by t to get hashrate. Use <span class=\"math\">\\frac{2^{256}}{W_h}</span> to get the target for a difficulty algorithm that changes every 600 seconds (probably impractical to securely implement).</p>\n<p><code>hashrate = sum(work)/(time duration)</code> from <span class=\"math\">h - N</span> to <span class=\"math\">h</span> gives a better estimate of hashrate at <span class=\"math\">h -N/2</span>.  The EMA needs a starting W. If it starts at <span class=\"math\">h-N</span> The starting <span class=\"math\">W_{h-N}</span> could be obtained by <code>sum(work) </code> from <span class=\"math\">h-\\frac{3N}{2}</span> to <span class=\"math\">h-\\frac{N}{2}</span> and dividing by N.</p>\n<p>edit: i previously had the wrong sign on the error signal.</p>",
  "post_number": 32,
  "post_type": 1,
  "posts_count": 30,
  "updated_at": "2025-08-15T14:00:40.923Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 1.0,
  "yours": false,
  "topic_id": 1745,
  "topic_slug": "correcting-the-error-in-getnetworkhashrateps",
  "topic_title": "Correcting the error in getnetworkhashrateps",
  "topic_html_title": "Correcting the error in getnetworkhashrateps",
  "category_id": 7,
  "display_username": "Zawy",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 4,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "I believe this is the best-possible estimate of _current_ hashrate for an arbitrarily-small fixed time period t when given only the lowest hash seen in t. \n\n$L = \\text{lowest hash seen in time t}$\n\n$W = \\text{work in t}$\n\n$\\lambda = \\frac{W}{2^{256}}$\n\n$\\text{exponential CDF}(L) = 1 - e^{-\\lambda L}$\n\n$E = \\text{error signal} = \\text{CDF}(L) - 0.5$\n\nThe error signal is the probability that the prior estimate of W was wrong. 0.5 is the median observation if the prior estimate was correct, so there would be no error. Use the error signal in the EMA equation. \n\n$h = \\text{height of t time segments}$\n\n$W_{h} = W_{h-1} \\cdot e^{-\\frac{E}{N}}$\n\n$\\text{Stdev} \\approx \\frac{W}{\\sqrt{2N}}$\n\nN = \"mean lifetime\" of the EMA estimate in units of t. You choose N to get your desired stability / slowness of the estimate.  Divide by t to get hashrate. Use $\\frac{2^{256}}{W_h}$ to get the target for a difficulty algorithm that changes every 600 seconds (probably impractical to securely implement).\n\n```hashrate = sum(work)/(time duration)``` from $h - N$ to $h$ gives a better estimate of hashrate at $h -N/2$.  The EMA needs a starting W. If it starts at $h-N$ The starting $W_{h-N}$ could be obtained by ```sum(work) ``` from $h-\\frac{3N}{2}$ to $h-\\frac{N}{2}$ and dividing by N.\n\nedit: i previously had the wrong sign on the error signal.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 502,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I believe this is the best-possible estimate of current hashrate for an arbitrarily-small fixed time period t when given only the lowest hash seen in t. \nL = \\text{lowest hash seen in time t} \nW = \\text{work in t} \n\\lambda = \\frac{W}{2^{256}} \n\\text{exponential CDF}(L) = 1 - e^{-\\lambda L} \nE = \\tex&hellip;",
  "truncated": true,
  "post_url": "/t/correcting-the-error-in-getnetworkhashrateps/1745/32",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}