{
  "id": 5680,
  "name": "Zawy",
  "username": "zawy",
  "avatar_template": "/user_avatar/delvingbitcoin.org/zawy/{size}/750_2.png",
  "created_at": "2025-08-09T11:58:46.853Z",
  "cooked": "<p>TL;DR: I think <a class=\"mention\" href=\"/u/sipa\">@sipa</a> used Beta where he should have used <strike>Gamma</strike> Binomial.</p>\n<p>It\u2019s suspicious that the variance denominator jumps from k-2 to k when I \u201cincrease k by 1\u201d.</p>\n<p>That is, we have</p>\n<p><span class=\"math\">W = (\\text{#S}-1) \\times \\frac{2^{256}}{H}</span></p>\n<p>and I say \u201clet\u2019s increase <span class=\"hashtag-raw\">#S</span> by 1\u201d by pretending T was a hash. It\u2019s just a little higher than H by definition. I believe this is legitimate because I believe the mean interval from H to T is equal to the mean interval between the elements in <span class=\"hashtag-raw\">#S</span>. So I\u2019ll add T as an extra \u201chash\u201d to the set S to make S\u2019.</p>\n<p><span class=\"math\">W = (\\text{#S}'-1) \\times \\frac{2^{256}}{T} =  \\text{#S} \\times \\frac{2^{256}}{T} </span></p>\n<p>If difficulty is a constant at T, then b = <span class=\"hashtag-raw\">#S</span>\u2019-1 and the W equation for the Beta distribution is equal to the Poisson\u2019s. But the variance denominators are supposedly different, i.e. 1/b verses 1/(<span class=\"hashtag-raw\">#S</span>\u2019 - 2).</p>\n<p>So I wonder if we\u2019re back to the original point of this thread, i.e. an (N-1)/N correction is needed when we try to apply a distribution that counts events in a given amount of time in situations where we make the mistake of starting with a given number of events. Or there could be a vice versa mistake. In this case, the Poisson counts events in a fixed amount of time and the Beta distribution counts time for a fixed number of blocks, so there\u2019s a probable mismatch.</p>\n<p>In asking Grok about this, it appears the Erlang (or Gamma) should be used in place of the Poisson if we look back a fixed number of blocks, or the Binomial used in place of the Beta if we\u2019re looking back a fixed amount of time. (Poisson is for fixed time and Beta is for fixed blocks). I believe we\u2019re doing the latter, and if I knew how to apply the Binomial I would get \u201clowest hashes\u201d method to have n^2 / (<span class=\"hashtag-raw\">#S</span>\u2019-1) variance, same as Poisson\u2019s n^2 / b. In other words, the Nth lowest hash is precisely like a difficulty target for N-1 \u201cblocks found\u201d so that we can just use Poisson in both cases. This is a given if my supposition above about the mean interval is correct.</p>\n<p>If the difficulty isn\u2019t constant, it still looks correct. In that situation b &gt; <span class=\"hashtag-raw\">#S</span>\u2019 so that the W from b has a lower variance while still using the same Poisson equations for W and Var for both b and <span class=\"hashtag-raw\">#S</span>\u2019.</p>",
  "post_number": 23,
  "post_type": 1,
  "posts_count": 30,
  "updated_at": "2025-08-09T14:35:01.394Z",
  "reply_count": 1,
  "reply_to_post_number": 22,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 19,
  "readers_count": 18,
  "score": 8.8,
  "yours": false,
  "topic_id": 1745,
  "topic_slug": "correcting-the-error-in-getnetworkhashrateps",
  "topic_title": "Correcting the error in getnetworkhashrateps",
  "topic_html_title": "Correcting the error in getnetworkhashrateps",
  "category_id": 7,
  "display_username": "Zawy",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 6,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "reply_to_user": {
    "id": 502,
    "username": "zawy",
    "name": "Zawy",
    "avatar_template": "/user_avatar/delvingbitcoin.org/zawy/{size}/750_2.png"
  },
  "bookmarked": false,
  "raw": "TL;DR: I think @sipa used Beta where he should have used <strike>Gamma</strike> Binomial.\n \nIt's suspicious that the variance denominator jumps from k-2 to k when I \"increase k by 1\".   \n\nThat is, we have\n\n$W = (\\text{#S}-1) \\times \\frac{2^{256}}{H}$\n\nand I say \"let's increase #S by 1\" by pretending T was a hash. It's just a little higher than H by definition. I believe this is legitimate because I believe the mean interval from H to T is equal to the mean interval between the elements in #S. So I'll add T as an extra \"hash\" to the set S to make S'. \n\n$W = (\\text{#S}'-1) \\times \\frac{2^{256}}{T} =  \\text{#S} \\times \\frac{2^{256}}{T} $\n\nIf difficulty is a constant at T, then b = #S'-1 and the W equation for the Beta distribution is equal to the Poisson's. But the variance denominators are supposedly different, i.e. 1/b verses 1/(#S' - 2). \n\nSo I wonder if we're back to the original point of this thread, i.e. an (N-1)/N correction is needed when we try to apply a distribution that counts events in a given amount of time in situations where we make the mistake of starting with a given number of events. Or there could be a vice versa mistake. In this case, the Poisson counts events in a fixed amount of time and the Beta distribution counts time for a fixed number of blocks, so there's a probable mismatch. \n\nIn asking Grok about this, it appears the Erlang (or Gamma) should be used in place of the Poisson if we look back a fixed number of blocks, or the Binomial used in place of the Beta if we're looking back a fixed amount of time. (Poisson is for fixed time and Beta is for fixed blocks). I believe we're doing the latter, and if I knew how to apply the Binomial I would get \"lowest hashes\" method to have n^2 / (#S'-1) variance, same as Poisson's n^2 / b. In other words, the Nth lowest hash is precisely like a difficulty target for N-1 \"blocks found\" so that we can just use Poisson in both cases. This is a given if my supposition above about the mean interval is correct. \n\nIf the difficulty isn't constant, it still looks correct. In that situation b > #S' so that the W from b has a lower variance while still using the same Poisson equations for W and Var for both b and #S'.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 502,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "TL;DR: I think <a class=\"mention\" href=\"/u/sipa\">@sipa</a> used Beta where he should have used Gamma Binomial. \nIt\u2019s suspicious that the variance denominator jumps from k-2 to k when I \u201cincrease k by 1\u201d. \nThat is, we have \nW = (\\text{#S}-1) \\times \\frac{2^{256}}{H} \nand I say \u201clet\u2019s increase #S by 1\u201d by pretending T was a hash. It\u2019s jus&hellip;",
  "truncated": true,
  "post_url": "/t/correcting-the-error-in-getnetworkhashrateps/1745/23",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}