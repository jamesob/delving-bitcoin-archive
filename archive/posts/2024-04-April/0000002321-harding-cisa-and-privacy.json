{
  "id": 2321,
  "name": "David A. Harding",
  "username": "harding",
  "avatar_template": "/user_avatar/delvingbitcoin.org/harding/{size}/6_2.png",
  "created_at": "2024-04-24T19:27:03.356Z",
  "cooked": "<p>I think you\u2019re ignoring the existing effect of <a href=\"https://bitcoinops.org/en/topics/payment-batching/\">payment batching</a>.  Let\u2019s use and extend your examples, providing numbers.  All examples below assume P2TR keypath inputs and P2TR outputs with  sizes from <a href=\"https://bitcoinops.org/en/tools/calc-size/\">Optech\u2019s tx calc</a>.</p>\n<p><strong>No batching or CISA:</strong></p>\n<pre data-code-height=\"147\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">    graph TD;\n    A1--&gt;B[B,A&lt;sub&gt;change&lt;/sub&gt;];\n    A2--&gt;C[C,A&lt;sub&gt;change&lt;/sub&gt;];\n    A3--&gt;D[D,A&lt;sub&gt;change&lt;/sub&gt;];\n</code></pre>\n<p>Each tx has 1 input and 2 outputs (payment &amp; change), making it 154 vbytes.  Three transactions is thus 462 vbytes.</p>\n<p><strong>Batching without CISA:</strong></p>\n<p>In the worst case, this is:</p>\n<pre data-code-height=\"147\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">    flowchart\n         A1,A2,A3 --&gt; B[B,C,D,A&lt;sub&gt;change&lt;/sub&gt;]\n</code></pre>\n<p>The size is 355 vbytes, a 23% savings over the base case.</p>\n<p>In the best case, this is:</p>\n<pre data-code-height=\"147\" data-code-wrap=\"mermaid\"><code class=\"lang-mermaid\">    flowchart\n         A1 --&gt; B[B,C,D,A&lt;sub&gt;change&lt;/sub&gt;]\n</code></pre>\n<p>That best-case size is 240 vbytes, a 48% savings over the base case.</p>\n<p><strong>With batching and CISA:</strong></p>\n<p>The best-case from above remains exactly the same (assuming CISA doesn\u2019t add any overhead).  In the multi-input case:</p>\n<ul>\n<li>Half-agg reduces the size of the second and third inputs by 8 vbytes each, bringing the transaction size down from 355 vbytes to 339 vbytes.  This is an extra 3.6% savings.</li>\n<li>Full-agg reduces the size of the second and third inputs by 16 vbytes each, brining the transaction size down from 355 vbytes to 323.  This is an extra 7.1% savings.</li>\n</ul>\n<p>The existing Bitcoin protocol heavily incentivizes batching.  CISA makes batching only slightly more efficient, so I don\u2019t think there\u2019s any reason to consider it a privacy problem on that basis.</p>\n<p>I\u2019m not aware of CISA necessarily requiring a new address format, and even if it does, I assume that it can be an address format that encompasses most expected output uses (like taproot), so it will eventually become the default address format.  I don\u2019t think we should avoid adding useful new features to Bitcoin because there will be a transitional period where it\u2019s easier to distinguish between upgraded and non-upgraded wallets.</p>\n<p>Additionally, CISA reduces the cost of creating coinjoins and payjoins, two deployed protocols that improve privacy.  It may also reduce the cost of other protocols that enhance privacy, including both current protocols (like LN channels closes with multiple in-flight HTLCs) and proposed protocols.  The cost reduction is modest, but I think anything that gives privacy an advantage is worth considering.</p>",
  "post_number": 2,
  "post_type": 1,
  "updated_at": "2024-04-24T19:27:03.356Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 6,
  "readers_count": 5,
  "score": 1.2,
  "yours": false,
  "topic_id": 824,
  "topic_slug": "cisa-and-privacy",
  "topic_title": "CISA and Privacy",
  "topic_html_title": "CISA and Privacy",
  "category_id": 7,
  "display_username": "David A. Harding",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "I think you're ignoring the existing effect of [payment batching](https://bitcoinops.org/en/topics/payment-batching/).  Let's use and extend your examples, providing numbers.  All examples below assume P2TR keypath inputs and P2TR outputs with  sizes from [Optech's tx calc](https://bitcoinops.org/en/tools/calc-size/).\n\n**No batching or CISA:**\n\n```mermaid height=147,auto\n    graph TD;\n    A1-->B[B,A<sub>change</sub>];\n    A2-->C[C,A<sub>change</sub>];\n    A3-->D[D,A<sub>change</sub>];\n```\n\nEach tx has 1 input and 2 outputs (payment & change), making it 154 vbytes.  Three transactions is thus 462 vbytes.\n\n**Batching without CISA:**\n\nIn the worst case, this is:\n\n```mermaid height=147,auto\n    flowchart\n         A1,A2,A3 --> B[B,C,D,A<sub>change</sub>]\n```\n\nThe size is 355 vbytes, a 23% savings over the base case.\n\nIn the best case, this is:\n\n```mermaid height=147,auto\n    flowchart\n         A1 --> B[B,C,D,A<sub>change</sub>]\n```\n\nThat best-case size is 240 vbytes, a 48% savings over the base case.\n\n**With batching and CISA:**\n\nThe best-case from above remains exactly the same (assuming CISA doesn't add any overhead).  In the multi-input case:\n\n- Half-agg reduces the size of the second and third inputs by 8 vbytes each, bringing the transaction size down from 355 vbytes to 339 vbytes.  This is an extra 3.6% savings.\n- Full-agg reduces the size of the second and third inputs by 16 vbytes each, brining the transaction size down from 355 vbytes to 323.  This is an extra 7.1% savings.\n\nThe existing Bitcoin protocol heavily incentivizes batching.  CISA makes batching only slightly more efficient, so I don't think there's any reason to consider it a privacy problem on that basis.\n\nI'm not aware of CISA necessarily requiring a new address format, and even if it does, I assume that it can be an address format that encompasses most expected output uses (like taproot), so it will eventually become the default address format.  I don't think we should avoid adding useful new features to Bitcoin because there will be a transitional period where it's easier to distinguish between upgraded and non-upgraded wallets.\n\nAdditionally, CISA reduces the cost of creating coinjoins and payjoins, two deployed protocols that improve privacy.  It may also reduce the cost of other protocols that enhance privacy, including both current protocols (like LN channels closes with multiple in-flight HTLCs) and proposed protocols.  The cost reduction is modest, but I think anything that gives privacy an advantage is worth considering.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 6,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}