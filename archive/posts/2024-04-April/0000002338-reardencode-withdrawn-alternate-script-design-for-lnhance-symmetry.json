{
  "id": 2338,
  "name": "Brandon Black",
  "username": "reardencode",
  "avatar_template": "/user_avatar/delvingbitcoin.org/reardencode/{size}/27_2.png",
  "created_at": "2024-04-27T13:07:58.903Z",
  "cooked": "<p>Hey AJ, thanks for your response!</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"839\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<ul>\n<li>This is missing the <code>&lt;n&gt; CLTV</code> step that makes eltoo work</li>\n</ul>\n</blockquote>\n</aside>\n<p>Yep, left it out of both, so doesn\u2019t change the comparison really.</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"839\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<ul>\n<li><code>&lt;settlement-sig&gt; &lt;G&gt; CHECKSIG</code> is just a more expensive way of doing <code>&lt;h&gt; CTV</code>; it\u2019s not surprising that changing this to CTV makes it cheaper. I believe you can make it cheaper still by using <a href=\"https://github.com/instagibbs/bolts/issues/5\" rel=\"noopener nofollow ugc\">scriptless scripts to reveal a signature</a> instead of doing the CTV-ish approach.</li>\n</ul>\n</blockquote>\n</aside>\n<p>Yeah, CTV+APO is even more efficient, I\u2019m just comparing an APO-only or CTV+CSFS-only world.</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"839\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>I don\u2019t think this works at all? If you grind the IPK, the scripts you end up with are something like:</p>\n<ul>\n<li>&lt;n+1&gt; CLTV DROP musig(A,B) CHECKSIG</li>\n<li>INTERNALKEY CTV</li>\n</ul>\n<p>The scriptPubKey is then calculated as <code>IPK + Hash(IPK, Hash(Hash(S1), Hash(S2)))</code>.</p>\n<p>But to spend using the first path, you need the witness stack to contain <code>IPK, Hash(S2), S1, signature</code>. But to know what <code>IPK</code> is, you need to know what the settlement tx corresponding to this update tx is, and to redo the grinding. The ln-symmetry approach to solving that is just to stick it into the annex of the update tx that you\u2019re looking to spend.</p>\n</blockquote>\n</aside>\n<p><s>Ah, but because the full script content is deterministic, you can compute the settlement hash / IPK by calculating the the taptweak (<code>t</code>) and then <code>IPK=SPK-t*G</code>. By moving the pieces around we solve the data availability problem.</s></p>\n<p>Goddamnit, this doesn\u2019t work at all. My cleverness defeated. You need to know the IPK to calculate the tweak - otherwise the whole taproot construction would be insecure (any script tree could spend any outpoint).</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"839\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<p>I think lnhance would be more efficient with an IF than two leafs, namely:</p>\n</blockquote>\n</aside>\n<p><s>Yeah. That applies equally to both APO-Symmetry and LNHANCE-Symmetry, but in a real implementation it would indeed be advisable to use an <code>IF</code> instead of two tapleaves.</s></p>\n<p>Ohhh!!! It doesn\u2019t apply to both, because the APO settlement leaf is large enough that it makes updates worse. Nice. I\u2019ll update OP.</p>\n<aside class=\"quote no-group\" data-username=\"ajtowns\" data-post=\"2\" data-topic=\"839\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://delvingbitcoin.org/user_avatar/delvingbitcoin.org/ajtowns/48/417_2.png\" class=\"avatar\"> ajtowns:</div>\n<blockquote>\n<ul>\n<li>\n<ul>\n<li>lnhance: 33B annex, 33B control block, 48B script, 64B signature, 32B ctv hash (210B)</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n</aside>\n<p>A stray annex in this line</p>",
  "post_number": 3,
  "post_type": 1,
  "updated_at": "2024-04-27T14:09:39.930Z",
  "reply_count": 0,
  "reply_to_post_number": 2,
  "quote_count": 1,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 1.0,
  "yours": false,
  "topic_id": 839,
  "topic_slug": "withdrawn-alternate-script-design-for-lnhance-symmetry",
  "topic_title": "[WITHDRAWN] Alternate script design for LNHANCE-Symmetry",
  "topic_html_title": "[WITHDRAWN] Alternate script design for LNHANCE-Symmetry",
  "category_id": 7,
  "display_username": "Brandon Black",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "version": 4,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Hey AJ, thanks for your response!\n\n[quote=\"ajtowns, post:2, topic:839\"]\n* This is missing the `<n> CLTV` step that makes eltoo work\n[/quote]\nYep, left it out of both, so doesn't change the comparison really.\n\n[quote=\"ajtowns, post:2, topic:839\"]\n* `<settlement-sig> <G> CHECKSIG` is just a more expensive way of doing `<h> CTV`; it\u2019s not surprising that changing this to CTV makes it cheaper. I believe you can make it cheaper still by using [scriptless scripts to reveal a signature](https://github.com/instagibbs/bolts/issues/5) instead of doing the CTV-ish approach.\n[/quote]\nYeah, CTV+APO is even more efficient, I'm just comparing an APO-only or CTV+CSFS-only world.\n\n[quote=\"ajtowns, post:2, topic:839\"]\nI don\u2019t think this works at all? If you grind the IPK, the scripts you end up with are something like:\n\n* <n+1> CLTV DROP musig(A,B) CHECKSIG\n* INTERNALKEY CTV\n\nThe scriptPubKey is then calculated as `IPK + Hash(IPK, Hash(Hash(S1), Hash(S2)))`.\n\nBut to spend using the first path, you need the witness stack to contain `IPK, Hash(S2), S1, signature`. But to know what `IPK` is, you need to know what the settlement tx corresponding to this update tx is, and to redo the grinding. The ln-symmetry approach to solving that is just to stick it into the annex of the update tx that you\u2019re looking to spend.\n[/quote]\n\n~~Ah, but because the full script content is deterministic, you can compute the settlement hash / IPK by calculating the the taptweak (`t`) and then `IPK=SPK-t*G`. By moving the pieces around we solve the data availability problem.~~\n\nGoddamnit, this doesn't work at all. My cleverness defeated. You need to know the IPK to calculate the tweak - otherwise the whole taproot construction would be insecure (any script tree could spend any outpoint).\n\n[quote=\"ajtowns, post:2, topic:839\"]\nI think lnhance would be more efficient with an IF than two leafs, namely:\n[/quote]\n\n~~Yeah. That applies equally to both APO-Symmetry and LNHANCE-Symmetry, but in a real implementation it would indeed be advisable to use an `IF` instead of two tapleaves.~~\n\nOhhh!!! It doesn't apply to both, because the APO settlement leaf is large enough that it makes updates worse. Nice. I'll update OP.\n\n[quote=\"ajtowns, post:2, topic:839\"]\n* * lnhance: 33B annex, 33B control block, 48B script, 64B signature, 32B ctv hash (210B)\n[/quote]\n\nA stray annex in this line",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 30,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false
}