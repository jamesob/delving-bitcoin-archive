{
  "id": 6700,
  "name": "Toby Sharp",
  "username": "tobysharp",
  "avatar_template": "/letter_avatar_proxy/v4/letter/t/dbc845/{size}.png",
  "created_at": "2026-01-28T18:08:36.279Z",
  "cooked": "<p>Hi stickies-v. Thanks for reading the post so carefully and for your questions <img src=\"https://delvingbitcoin.org/images/emoji/twitter/slight_smile.png?v=15\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<blockquote>\n<p>Is my understanding correct that you have on-disk TXO database (since it\u2019s append-only, I suspect it contains both spent and unspent TXOs?) and an in-memory UTXO index (which as per your latest comment could also be migrated to being on-disk)?</p>\n</blockquote>\n<p>Yes, that\u2019s exactly correct.</p>\n<blockquote>\n<p>Roughly how big are the database and the index, at the current chaintip (or whichever height you\u2019re using)?</p>\n</blockquote>\n<p>That\u2019s a great question, I should have included this info.</p>\n<p>The index is 48 bytes per UTXO, and this number looks unlikely to change. Even if I trimmed the structure to 44 bytes of data, I think 48 bytes would likely still be needed for nice alignment. At 175M UTXOs (an approximate count) that\u2019s 7.8 GiB which is fine atm for my hardware.</p>\n<p>If the UTXO count were to substantially increase, then I would be looking to store the index on disk, and pay one I/O page read per query, and hide all the additional latency in IBD with parallelism. I think this would put me in a good spot where decent RAM is not critical for the performance.</p>\n<p>The on-disk TXO database currently appears to be 134 GiB. However, I haven\u2019t yet written the code to withhold unspendable outputs like OP_RETURN: currently these are included in that total. I also haven\u2019t made much effort to compress this storage yet, although it\u2019s also not clear that such efforts would be necessary or fruitful.</p>\n<p>As you correctly point out, this ends up largely being spent transaction data that no longer needs to be fetched for validating future blocks.</p>\n<blockquote>\n<p>I suppose pruning spent TXOs from the disk database is not something you plan on supporting, given the focus on server-class hardware and related architecture choices?</p>\n</blockquote>\n<p>It\u2019s something I\u2019ve considered. I think the sensible plan there would be to blast through the whole IBD to tip, and then create a new table on disk that only includes the unspent outputs to that point: essentially a compaction step. This could be optional, or it could be also be a process that\u2019s user-invoked when the user wants to defrag storage.</p>\n<p>So the options exist to improve the storage efficiency for hardware with smaller resources. However, my assumption was that it\u2019s the workstation- / server-class hardware that particularly benefits from this parallel approach. Do you agree?</p>\n<p>Thanks again,\nT#</p>",
  "post_number": 9,
  "post_type": 1,
  "posts_count": 9,
  "updated_at": "2026-01-28T18:08:36.279Z",
  "reply_count": 0,
  "reply_to_post_number": 8,
  "quote_count": 0,
  "incoming_link_count": 0,
  "reads": 5,
  "readers_count": 4,
  "score": 0.8,
  "yours": false,
  "topic_id": 2201,
  "topic_slug": "hornet-utxo-1-a-custom-constant-time-highly-parallel-utxo-database",
  "topic_title": "Hornet UTXO(1): A custom, constant-time, highly parallel UTXO database",
  "topic_html_title": "Hornet UTXO(1): A custom, constant-time, highly parallel UTXO database",
  "category_id": 8,
  "display_username": "Toby Sharp",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "reply_to_user": {
    "id": 174,
    "username": "stickies-v",
    "name": "",
    "avatar_template": "/letter_avatar_proxy/v4/letter/s/a9adbd/{size}.png"
  },
  "bookmarked": false,
  "raw": "Hi stickies-v. Thanks for reading the post so carefully and for your questions :) \n\n> Is my understanding correct that you have on-disk TXO database (since it\u2019s append-only, I suspect it contains both spent and unspent TXOs?) and an in-memory UTXO index (which as per your latest comment could also be migrated to being on-disk)?\n\nYes, that's exactly correct.\n\n> Roughly how big are the database and the index, at the current chaintip (or whichever height you\u2019re using)?\n\nThat's a great question, I should have included this info. \n\nThe index is 48 bytes per UTXO, and this number looks unlikely to change. Even if I trimmed the structure to 44 bytes of data, I think 48 bytes would likely still be needed for nice alignment. At 175M UTXOs (an approximate count) that's 7.8 GiB which is fine atm for my hardware. \n\nIf the UTXO count were to substantially increase, then I would be looking to store the index on disk, and pay one I/O page read per query, and hide all the additional latency in IBD with parallelism. I think this would put me in a good spot where decent RAM is not critical for the performance. \n\nThe on-disk TXO database currently appears to be 134 GiB. However, I haven't yet written the code to withhold unspendable outputs like OP_RETURN: currently these are included in that total. I also haven't made much effort to compress this storage yet, although it's also not clear that such efforts would be necessary or fruitful.\n\nAs you correctly point out, this ends up largely being spent transaction data that no longer needs to be fetched for validating future blocks. \n\n> I suppose pruning spent TXOs from the disk database is not something you plan on supporting, given the focus on server-class hardware and related architecture choices?\n\nIt's something I've considered. I think the sensible plan there would be to blast through the whole IBD to tip, and then create a new table on disk that only includes the unspent outputs to that point: essentially a compaction step. This could be optional, or it could be also be a process that's user-invoked when the user wants to defrag storage.\n\nSo the options exist to improve the storage efficiency for hardware with smaller resources. However, my assumption was that it's the workstation- / server-class hardware that particularly benefits from this parallel approach. Do you agree?\n\nThanks again,\nT#",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 1037,
  "hidden": false,
  "trust_level": 0,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Hi stickies-v. Thanks for reading the post so carefully and for your questions :slight_smile: \n\nIs my understanding correct that you have on-disk TXO database (since it\u2019s append-only, I suspect it contains both spent and unspent TXOs?) and an in-memory UTXO index (which as per your latest comment co&hellip;",
  "truncated": true,
  "post_url": "/t/hornet-utxo-1-a-custom-constant-time-highly-parallel-utxo-database/2201/9",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}