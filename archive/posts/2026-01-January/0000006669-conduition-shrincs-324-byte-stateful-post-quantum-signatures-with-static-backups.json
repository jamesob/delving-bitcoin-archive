{
  "id": 6669,
  "name": "",
  "username": "conduition",
  "avatar_template": "/user_avatar/delvingbitcoin.org/conduition/{size}/384_2.png",
  "created_at": "2026-01-22T14:59:35.877Z",
  "cooked": "<blockquote>\n<p>assume key generation happens on a signing device that is able to keep state securely</p>\n</blockquote>\n<p>Ahhhhh I didn\u2019t realize that assumption included keeping state secure <em>from the user</em> too.</p>\n<p>Clever idea with the TPM, though I would simplify it a little. Store only a decryption key in the TPM, and store the state on-disk, but encrypted under that key. If the encrypted state is backed up, it will be missing the TPM\u2019s key, making state decryption impossible. Read/write locking on the encrypted state files can then be managed by the application layer.</p>\n<p>Alternatively, store the XMSS key\u2019s seed itself in the TPM. This makes backed-up state files non-toxic, because after restoring the files, it\u2019s impossible to accidentally sign anything. The user would need to input their seed phrase to fully restore the wallet. Wallet devs would have some choice as to how to proceed from there.</p>\n<p>Feels weird to engineer a system that makes it <em>harder</em> to recover files.</p>",
  "post_number": 12,
  "post_type": 1,
  "posts_count": 13,
  "updated_at": "2026-01-22T15:01:18.193Z",
  "reply_count": 0,
  "reply_to_post_number": 11,
  "quote_count": 0,
  "incoming_link_count": 1,
  "reads": 13,
  "readers_count": 12,
  "score": 7.4,
  "yours": false,
  "topic_id": 2158,
  "topic_slug": "shrincs-324-byte-stateful-post-quantum-signatures-with-static-backups",
  "topic_title": "SHRINCS: 324-byte stateful post-quantum signatures with static backups",
  "topic_html_title": "SHRINCS: 324-byte stateful post-quantum signatures with static backups",
  "category_id": 7,
  "display_username": "",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": "",
  "reply_to_user": {
    "id": 632,
    "username": "jonasnick",
    "name": "",
    "avatar_template": "/user_avatar/delvingbitcoin.org/jonasnick/{size}/1518_2.png"
  },
  "bookmarked": false,
  "raw": "> assume key generation happens on a signing device that is able to keep state securely\n\nAhhhhh I didn't realize that assumption included keeping state secure _from the user_ too. \n\nClever idea with the TPM, though I would simplify it a little. Store only a decryption key in the TPM, and store the state on-disk, but encrypted under that key. If the encrypted state is backed up, it will be missing the TPM's key, making state decryption impossible. Read/write locking on the encrypted state files can then be managed by the application layer.\n\nAlternatively, store the XMSS key's seed itself in the TPM. This makes backed-up state files non-toxic, because after restoring the files, it's impossible to accidentally sign anything. The user would need to input their seed phrase to fully restore the wallet. Wallet devs would have some choice as to how to proceed from there. \n\nFeels weird to engineer a system that makes it *harder* to recover files.",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 129,
  "hidden": false,
  "trust_level": 2,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "assume key generation happens on a signing device that is able to keep state securely \n\nAhhhhh I didn\u2019t realize that assumption included keeping state secure from the user too. \nClever idea with the TPM, though I would simplify it a little. Store only a decryption key in the TPM, and store the stat&hellip;",
  "truncated": true,
  "post_url": "/t/shrincs-324-byte-stateful-post-quantum-signatures-with-static-backups/2158/12",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}