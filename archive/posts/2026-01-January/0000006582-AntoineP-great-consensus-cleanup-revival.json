{
  "id": 6582,
  "name": "Antoine Poinsot",
  "username": "AntoineP",
  "avatar_template": "/user_avatar/delvingbitcoin.org/antoinep/{size}/483_2.png",
  "created_at": "2026-01-07T22:04:28.332Z",
  "cooked": "<p>I got forwarded the following feedback. In a <code>CHECKMULTISIG(VERIFY)</code>, put a ceiling on the number of BIP54-sigops accounted for at 6.</p>\n<p>My understanding is this is because the scriptCode is constant throughout the signature checks within a single <code>CHECKMULTISIG(VERIFY)</code> operation, and the 6 possible signature hashes could be cached. This cache is actually implemented in Bitcoin Core since version 30.0 (see <a href=\"https://github.com/bitcoin/bitcoin/pull/32473\">#32473</a>).</p>\n<p>This is clever, and worth considering. But i wonder how much it matters in practice, as it\u2019s only relevant to users of large transactions involving large legacy multisigs, which aren\u2019t used anymore. Another downside is that it would complicate the implementation, since we wouldn\u2019t be able to just reuse BIP16\u2019s <a href=\"https://github.com/bitcoin/bitcoin/blob/cd6e4c9235f763b8077cece69c2e3b2025cc8d0f/src/script/script.cpp#L183-L205\"><code>GetSigOpCount</code></a> as-is anymore. Of course the upside is that it would more accurately budget the use of <code>CHECKMULTISIG(VERIFY)</code> in legacy Script to match validation cost, instead of overshooting.</p>\n<p>I\u2019ll put together a list of historical transactions that would have been valid according to this adapted rule but not according to today\u2019s BIP54. Any opinions on the desirability of this change?</p>",
  "post_number": 90,
  "post_type": 1,
  "posts_count": 89,
  "updated_at": "2026-01-07T22:04:28.332Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 3,
  "reads": 12,
  "readers_count": 11,
  "score": 17.4,
  "yours": false,
  "topic_id": 710,
  "topic_slug": "great-consensus-cleanup-revival",
  "topic_title": "Great Consensus Cleanup Revival",
  "topic_html_title": "Great Consensus Cleanup Revival",
  "category_id": 7,
  "display_username": "Antoine Poinsot",
  "primary_group_name": null,
  "flair_name": "wg-consensus-cleanup",
  "flair_url": "/uploads/default/original/1X/856d779f9ec58484f3a96285a21a813538b689f6.png",
  "flair_bg_color": "",
  "flair_color": "",
  "flair_group_id": 43,
  "badges_granted": [],
  "version": 1,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": "Regular",
  "title_is_group": false,
  "bookmarked": false,
  "raw": "I got forwarded the following feedback. In a `CHECKMULTISIG(VERIFY)`, put a ceiling on the number of BIP54-sigops accounted for at 6.\n\nMy understanding is this is because the scriptCode is constant throughout the signature checks within a single `CHECKMULTISIG(VERIFY)` operation, and the 6 possible signature hashes could be cached. This cache is actually implemented in Bitcoin Core since version 30.0 (see [#32473](https://github.com/bitcoin/bitcoin/pull/32473)).\n\nThis is clever, and worth considering. But i wonder how much it matters in practice, as it's only relevant to users of large transactions involving large legacy multisigs, which aren't used anymore. Another downside is that it would complicate the implementation, since we wouldn't be able to just reuse BIP16's [`GetSigOpCount`](https://github.com/bitcoin/bitcoin/blob/cd6e4c9235f763b8077cece69c2e3b2025cc8d0f/src/script/script.cpp#L183-L205) as-is anymore. Of course the upside is that it would more accurately budget the use of `CHECKMULTISIG(VERIFY)` in legacy Script to match validation cost, instead of overshooting.\n\nI'll put together a list of historical transactions that would have been valid according to this adapted rule but not according to today's BIP54. Any opinions on the desirability of this change?",
  "actions_summary": [],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 12,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "I got forwarded the following feedback. In a CHECKMULTISIG(VERIFY), put a ceiling on the number of BIP54-sigops accounted for at 6. \nMy understanding is this is because the scriptCode is constant throughout the signature checks within a single CHECKMULTISIG(VERIFY) operation, and the 6 possible sign&hellip;",
  "truncated": true,
  "post_url": "/t/great-consensus-cleanup-revival/710/90",
  "reactions": [],
  "current_user_reaction": null,
  "reaction_users_count": 0,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null
}