{
  "id": 6622,
  "name": "Toby Sharp",
  "username": "tobysharp",
  "avatar_template": "/letter_avatar_proxy/v4/letter/t/dbc845/{size}.png",
  "created_at": "2026-01-11T21:22:23.499Z",
  "cooked": "<p>Hi all,</p>\n<p>I have developed a new UTXO database, custom designed for maximizing throughput on Bitcoin consensus validation. I call it Hornet UTXO(1) because the queries are constant-time.</p>\n<p>This is a new component of Hornet Node, my experimental Bitcoin client focused on declarative consensus specification and high performance. I intend to do a full write-up but I\u2019m posting preliminary results here to get feedback from the community first.</p>\n<p>The database has been developed from scratch in modern C++. It has been designed for maximum parallelism so it\u2019s highly concurrent and <strong>lock-free</strong>.</p>\n<p>On my 32-core dev workstation, these are like-for-like results for re-validating the whole mainnet chain without script or signature validation:</p>\n<ul>\n<li>Bitcoin Core: <strong>167 minutes</strong> <br>\n<code>bitcoind -datadir=\"/nvme1/bitcoin/\" -reindex-chainstate -dbcache=24000 -connect=0 -assumevalid=0000000000000000000019426fb9e93a5cfa7695f271d928beeddf39a1ef3f3f</code></li>\n<li>Hornet UTXO(1): <strong>15 minutes</strong></li>\n</ul>\n<p>In this benchmark, both processes perform all structural and contextual validation, build the UTXO database, and validate all tx inputs correspond to unspent outputs.</p>\n<p>The core operations of Append, Query, and Fetch can all be executed concurrently and lock-free. Blocks can be submitted for validation out of order as they arrive, and will be processed concurrently, with data dependencies automatically resolved.</p>\n<p>Entries in the database index are height-tagged so that state can be rewound to a fork point for reorgs without storing additional undo state. This also allows queries to be issued against a specific past chain state.</p>\n<p>The serial dependency on a previous block\u2019s transactions is minimized by:</p>\n<ul>\n<li>Allowing non-dependent work to progress concurrently;</li>\n<li>Performing pre-emptive Append operations (that can be unwound in a failure case);</li>\n<li>Allowing partial queries and fetches against the existing data.</li>\n</ul>\n<p>Disk access is optimized via asynchronous, high queue-depth requests. Memory is optimized via compact, cache-friendly data structures and fixed-size allocations.</p>\n<p>The implementation is succinct at only 3,000 lines of C++23 with no external dependencies. There are no hash maps involved as sorted arrays and LSM trees are preferred.</p>\n<p>For those who missed it, you can read about the broader Hornet Node project here:</p>\n<p>T. Sharp (2025). <em>Hornet Node: A Declarative, Executable Specification of Bitcoin Consensus.</em> <a href=\"https://hornetnode.org/paper.html\" rel=\"noopener nofollow ugc\">HTML</a> // <a href=\"https://arxiv.org/pdf/2509.15754\" rel=\"noopener nofollow ugc\">PDF</a></p>\n<p>(Thanks to the people who got in touch to encourage me with this project. I really appreciate it.)</p>\n<p>I would be interested to hear feedback, questions, or about related work that I\u2019m probably unaware of. I can then make sure it all gets addressed in the formal write-up.</p>\n<p>This is currently an unfunded personal project developed in spare time. If you would like to support continued development, you can donate here: <code>33Y6TCLKvgjgk69CEAmDPijgXeTaXp8hYd</code>.</p>\n<p>If you\u2019re in industry and you\u2019re interested in faster IBD validation times to bring nodes online, please reach out.</p>\n<p>Best wishes,\nT\u266f</p>",
  "post_number": 1,
  "post_type": 1,
  "posts_count": 1,
  "updated_at": "2026-01-11T21:25:57.349Z",
  "reply_count": 0,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 1,
  "reads": 10,
  "readers_count": 9,
  "score": 36.8,
  "yours": false,
  "topic_id": 2201,
  "topic_slug": "hornet-utxo-1-a-custom-constant-time-highly-parallel-utxo-database",
  "topic_title": "Hornet UTXO(1): A custom, constant-time, highly parallel UTXO database",
  "topic_html_title": "Hornet UTXO(1): A custom, constant-time, highly parallel UTXO database",
  "category_id": 8,
  "display_username": "Toby Sharp",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 2,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Hi all,\n\nI have developed a new UTXO database, custom designed for maximizing throughput on Bitcoin consensus validation. I call it Hornet UTXO(1) because the queries are constant-time. \n\nThis is a new component of Hornet Node, my experimental Bitcoin client focused on declarative consensus specification and high performance. I intend to do a full write-up but I'm posting preliminary results here to get feedback from the community first. \n\nThe database has been developed from scratch in modern C++. It has been designed for maximum parallelism so it's highly concurrent and **lock-free**. \n\nOn my 32-core dev workstation, these are like-for-like results for re-validating the whole mainnet chain without script or signature validation: \n\n* Bitcoin Core: **167 minutes** \\\n`bitcoind -datadir=\"/nvme1/bitcoin/\" -reindex-chainstate -dbcache=24000 -connect=0 -assumevalid=0000000000000000000019426fb9e93a5cfa7695f271d928beeddf39a1ef3f3f`\n* Hornet UTXO(1): **15 minutes** \n\nIn this benchmark, both processes perform all structural and contextual validation, build the UTXO database, and validate all tx inputs correspond to unspent outputs. \n\nThe core operations of Append, Query, and Fetch can all be executed concurrently and lock-free. Blocks can be submitted for validation out of order as they arrive, and will be processed concurrently, with data dependencies automatically resolved. \n\nEntries in the database index are height-tagged so that state can be rewound to a fork point for reorgs without storing additional undo state. This also allows queries to be issued against a specific past chain state. \n\nThe serial dependency on a previous block's transactions is minimized by:\n\n* Allowing non-dependent work to progress concurrently;\n* Performing pre-emptive Append operations (that can be unwound in a failure case);\n* Allowing partial queries and fetches against the existing data. \n\nDisk access is optimized via asynchronous, high queue-depth requests. Memory is optimized via compact, cache-friendly data structures and fixed-size allocations. \n\nThe implementation is succinct at only 3,000 lines of C++23 with no external dependencies. There are no hash maps involved as sorted arrays and LSM trees are preferred. \n\nFor those who missed it, you can read about the broader Hornet Node project here: \n\nT. Sharp (2025). *Hornet Node: A Declarative, Executable Specification of Bitcoin Consensus.* [HTML](https://hornetnode.org/paper.html) // [PDF](https://arxiv.org/pdf/2509.15754) \n\n(Thanks to the people who got in touch to encourage me with this project. I really appreciate it.)\n\nI would be interested to hear feedback, questions, or about related work that I\u2019m probably unaware of. I can then make sure it all gets addressed in the formal write-up.\n\nThis is currently an unfunded personal project developed in spare time. If you would like to support continued development, you can donate here: `33Y6TCLKvgjgk69CEAmDPijgXeTaXp8hYd`. \n\nIf you're in industry and you're interested in faster IBD validation times to bring nodes online, please reach out. \n\nBest wishes, \nT\u266f",
  "actions_summary": [
    {
      "id": 2,
      "count": 2
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 1037,
  "hidden": false,
  "trust_level": 0,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Hi all, \nI have developed a new UTXO database, custom designed for maximizing throughput on Bitcoin consensus validation. I call it Hornet UTXO(1) because the queries are constant-time. \nThis is a new component of Hornet Node, my experimental Bitcoin client focused on declarative consensus specifica&hellip;",
  "truncated": true,
  "post_url": "/t/hornet-utxo-1-a-custom-constant-time-highly-parallel-utxo-database/2201/1",
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 2
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 2,
  "current_user_used_main_reaction": false,
  "can_accept_answer": false,
  "can_unaccept_answer": false,
  "accepted_answer": false,
  "topic_accepted_answer": null,
  "can_vote": false
}