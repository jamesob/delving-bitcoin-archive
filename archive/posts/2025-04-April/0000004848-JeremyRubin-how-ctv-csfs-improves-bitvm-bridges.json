{
  "id": 4848,
  "name": "Jeremy Rubin",
  "username": "JeremyRubin",
  "avatar_template": "/user_avatar/delvingbitcoin.org/jeremyrubin/{size}/264_2.png",
  "created_at": "2025-04-21T15:19:21.374Z",
  "cooked": "<p>Addenda:</p>\n<p>to limit malleability, 197 OP_NOPs may be on the scriptSig following the signature.</p>\n<p>The OP_DEPTH check prevents any other pushdatas. The NOPs also prevent any other codeseparator being placed.</p>\n<pre><code class=\"lang-auto\">POST_SEP =  [\n    OP_DEPTH,\n    OP_1,\n    OP_EQUALVERIFY,\n    OP_DUP,\n    pubkey,\n    OP_CHECKSIGVERIFY] + [OP_NOP]*197\n</code></pre>\n<p>B\u2019d signature\u2019s scriptcode is comitted to. It also seems not possible to sneakily inject another copy of the signature itself somewhere, relying on FindAndDelete, since there is no way to drop it before the second stack size check (in the <strong>scriptPubKey</strong>) executes.</p>\n<p><em>edit: we also put the OP_NOP\u2019s at the end, so that the signature cannot be placed arbitrarily in the OP_NOP segment.</em></p>\n<p><s>I believe this prevents the issue that B could be caused to be spent spuriously as long as someone is willing to e.g. front the money to pay for whatever other outputs. It seems with this change, B can be sure that their scriptSig cannot be modified by a third party.</s></p>\n<p>Edit: This prevents that <em>if</em> there is a checksig in the scriptSig, it must match this template. But it does not seem to require that the scriptSig must be a match to this template. E.g., you could drop all the other scriptSig logic entirely to just have the sig on the stack. This seems inherent.</p>",
  "post_number": 17,
  "post_type": 1,
  "posts_count": 16,
  "updated_at": "2025-04-21T16:18:03.268Z",
  "reply_count": 1,
  "reply_to_post_number": null,
  "quote_count": 0,
  "incoming_link_count": 52,
  "reads": 18,
  "readers_count": 17,
  "score": 328.6,
  "yours": false,
  "topic_id": 1591,
  "topic_slug": "how-ctv-csfs-improves-bitvm-bridges",
  "topic_title": "How CTV+CSFS improves BitVM bridges",
  "topic_html_title": "How CTV+CSFS improves BitVM bridges",
  "category_id": 7,
  "display_username": "Jeremy Rubin",
  "primary_group_name": null,
  "flair_name": null,
  "flair_url": null,
  "flair_bg_color": null,
  "flair_color": null,
  "flair_group_id": null,
  "badges_granted": [],
  "version": 3,
  "can_edit": false,
  "can_delete": false,
  "can_recover": false,
  "can_see_hidden_post": false,
  "can_wiki": false,
  "user_title": null,
  "bookmarked": false,
  "raw": "Addenda:\n\nto limit malleability, 197 OP_NOPs may be on the scriptSig following the signature.\n\nThe OP_DEPTH check prevents any other pushdatas. The NOPs also prevent any other codeseparator being placed.\n\n\n\n```\nPOST_SEP =  [\n    OP_DEPTH,\n    OP_1,\n    OP_EQUALVERIFY,\n    OP_DUP,\n    pubkey,\n    OP_CHECKSIGVERIFY] + [OP_NOP]*197\n```\n\nB'd signature's scriptcode is comitted to. It also seems not possible to sneakily inject another copy of the signature itself somewhere, relying on FindAndDelete, since there is no way to drop it before the second stack size check (in the **scriptPubKey**) executes.\n\n*edit: we also put the OP_NOP's at the end, so that the signature cannot be placed arbitrarily in the OP_NOP segment.*\n\n~~I believe this prevents the issue that B could be caused to be spent spuriously as long as someone is willing to e.g. front the money to pay for whatever other outputs. It seems with this change, B can be sure that their scriptSig cannot be modified by a third party.~~\n\nEdit: This prevents that *if* there is a checksig in the scriptSig, it must match this template. But it does not seem to require that the scriptSig must be a match to this template. E.g., you could drop all the other scriptSig logic entirely to just have the sig on the stack. This seems inherent.",
  "actions_summary": [
    {
      "id": 2,
      "count": 4
    }
  ],
  "moderator": false,
  "admin": false,
  "staff": false,
  "user_id": 224,
  "hidden": false,
  "trust_level": 3,
  "deleted_at": null,
  "user_deleted": false,
  "edit_reason": null,
  "can_view_edit_history": true,
  "wiki": false,
  "excerpt": "Addenda: \nto limit malleability, 197 OP_NOPs may be on the scriptSig following the signature. \nThe OP_DEPTH check prevents any other pushdatas. The NOPs also prevent any other codeseparator being placed. \nPOST_SEP =  [\n    OP_DEPTH,\n    OP_1,\n    OP_EQUALVERIFY,\n    OP_DUP,\n    pubkey,\n    OP_CHECKS&hellip;",
  "truncated": true,
  "post_url": "/t/how-ctv-csfs-improves-bitvm-bridges/1591/17",
  "reactions": [
    {
      "id": "+1",
      "type": "emoji",
      "count": 2
    },
    {
      "id": "heart",
      "type": "emoji",
      "count": 2
    }
  ],
  "current_user_reaction": null,
  "reaction_users_count": 4,
  "current_user_used_main_reaction": false
}